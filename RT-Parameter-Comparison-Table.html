<!DOCTYPE html>
<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RT åƒæ•¸å°ç…§è¡¨ (å®Œç¾åŒæ­¥ç‰ˆ)</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --sidebar-width: 280px; --edit-bg: #fff4e5; }
        * { box-sizing: border-box; } 
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: #f4f7f9; margin: 0; display: flex; overflow: hidden; }
        
        /* å´æ¬„å°è¦½ */
        .sidebar { width: var(--sidebar-width); background: var(--primary); color: white; height: 100vh; display: flex; flex-direction: column; flex-shrink: 0; transition: 0.3s; z-index: 2000; }
        .sidebar.collapsed { margin-left: -280px; }
        .sidebar-header { padding: 25px 20px; font-size: 1.4rem; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; gap: 5px; }
        .version-tag { font-size: 12px; font-weight: normal; color: rgba(255,255,255,0.6); letter-spacing: 0.5px; }
        .sidebar-menu { flex: 1; overflow-y: auto; padding: 10px 0; }
        .menu-item { padding: 15px 20px; cursor: pointer; color: rgba(255,255,255,0.7); border-left: 5px solid transparent; font-size: 15px; transition: 0.2s; }
        .menu-item:hover { background: rgba(255,255,255,0.1); color: white; }
        .menu-item.active { background: rgba(255,255,255,0.15); color: white; border-left-color: var(--accent); }
        .admin-section { padding: 15px; border-top: 1px solid rgba(255,255,255,0.1); }

        /* ä¸»å…§å®¹å€ */
        .main-wrapper { flex: 1; height: 100vh; overflow-y: auto; display: flex; flex-direction: column; z-index: 100; }
        .top-bar { background: white; padding: 12px 20px; display: flex; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .content-section { padding: 20px; display: none; }
        .content-section.active { display: block; animation: fadeIn 0.3s; }
        
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px; position: relative; }
        .query-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 10px; }
        label { display: block; font-size: 13px; font-weight: bold; margin-bottom: 8px; color: #555; }
        
        select, input { width: 100% !important; height: 48px; display: block !important; padding: 0 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; background: white; cursor: pointer; }
        
        .table-wrap { overflow-x: auto; border-radius: 8px; border: 1px solid #eee; margin-top: 15px; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; text-align: center; }
        th { background: #f8fafc; padding: 15px 10px; color: #64748b; font-size: 13px; border-bottom: 2px solid #edf2f7; white-space: nowrap; }
        td { padding: 22px 10px; border-bottom: 1px solid #f1f5f9; font-size: 24px; font-weight: 800; color: #1a202c; white-space: nowrap; }
        
        .val-mid { font-size: 26px; font-weight: 800; display: block; line-height: 1.1; }
        .val-range { font-size: 12px; color: #7f8c8d; background: #f1f5f9; padding: 2px 6px; border-radius: 4px; display: inline-block; margin-top: 4px; font-weight: normal; }

        .fine-box { display: flex; align-items: center; gap: 15px; }
        .fine-select-wrapper { flex: 1; min-width: 200px; }
        .color-badge { display: inline-flex; align-items: center; justify-content: center; padding: 10px 25px; border-radius: 8px; font-size: 20px; font-weight: 900; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); box-shadow: 0 4px 6px rgba(0,0,0,0.1); min-width: 120px; }

        .note-list { list-style: none; padding: 0; }
        .note-list li { padding: 12px; border-bottom: 1px solid #edf2f7; line-height: 1.6; color: #4a5568; }
        .note-list b { color: #2c3e50; margin-right: 5px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Mobile Adjustments */
        @media (max-width: 900px) {
          :root { --sidebar-width: 280px; }
          body { overflow: auto; }
          .sidebar { position: fixed; left: 0; top: 0; height: 100vh; box-shadow: 0 10px 30px rgba(0,0,0,0.25); }
          .sidebar.collapsed { margin-left: calc(-1 * var(--sidebar-width)); }
          .main-wrapper { width: 100vw; }
          .top-bar { position: sticky; top: 0; z-index: 1500; }
          .content-section { padding: 14px; }
          .card { padding: 14px; border-radius: 14px; }
          .query-row { grid-template-columns: 1fr; gap: 12px; }
          select, input { height: 52px; font-size: 17px; border-radius: 10px; }
          table { min-width: 520px; }
          th { padding: 12px 8px; font-size: 12px; }
          td { padding: 16px 8px; font-size: 20px; }
          .val-mid { font-size: 22px; }
          .val-range { font-size: 12px; }
          .fine-box { flex-direction: column; align-items: stretch; gap: 10px; }
          .fine-select-wrapper { width: 100%; }
          .color-badge { width: 100%; min-width: unset; font-size: 18px; padding: 10px 14px; }
          .input-box select, .fine-select-wrapper select { display: none !important; }
          /* FIX: allow native selects in ç–Šæ¿ç‰‡æ•¸å°ç…§è¡¨ on mobile */
          #tab-stack .input-box select { display: block !important; }

          .input-box .mobile-only, .fine-select-wrapper .mobile-only { display: block !important; }
        }

        /* Mobile Picker */
        .mobile-only { display: none; }
        .picker-btn { width: 100%; height: 52px; border-radius: 10px; border: 1px solid #ddd; background: #fff; font-size: 17px; text-align: left; padding: 0 12px; cursor: pointer; box-sizing: border-box; position: relative; }
        .picker-btn::after { content: "â–¾"; position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #64748b; font-size: 16px; }
        .picker-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.45); display: flex; align-items: flex-end; justify-content: center; z-index: 5000; }
        .picker-modal.hidden { display: none; }
        .picker-sheet { width: 100%; max-width: 640px; background: #fff; border-radius: 16px 16px 0 0; max-height: 78vh; overflow: hidden; box-shadow: 0 -10px 30px rgba(0,0,0,0.25); }
        .picker-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 14px; border-bottom: 1px solid #edf2f7; }
        .picker-title { font-weight: 800; color: #1a202c; }
        .picker-close { border: none; background: #f1f5f9; color: #334155; padding: 10px 12px; border-radius: 10px; font-weight: 700; cursor: pointer; }
        .picker-list { overflow-y: auto; -webkit-overflow-scrolling: touch; max-height: calc(78vh - 58px); }
        .picker-item { padding: 16px 14px; border-bottom: 1px solid #f1f5f9; font-size: 16px; color: #1f2937; cursor: pointer; }
        .picker-item.active { background: #ebf8ff; color: #1d4ed8; font-weight: 800; }

        /* Admin UI */
        .admin-bar { display:none; gap:10px; align-items:center; padding:10px 12px; margin-left:auto; }
        .admin-badge { font-size:12px; font-weight:800; color:#0f172a; background:#fde68a; padding:6px 10px; border-radius:999px; border:1px solid #f59e0b; }
        .admin-date { display:flex; align-items:center; gap:8px; }
        .admin-date label { margin:0; font-size:12px; color:#334155; }
        .admin-date input[type="date"]{ height:38px; font-size:14px; padding:0 10px; border-radius:10px; }
        .btn { border:none; border-radius:10px; padding:8px 12px; font-weight:800; cursor:pointer; font-size: 14px; transition: 0.2s; white-space: nowrap; }
        .btn-primary{ background:#2563eb; color:#fff; }
        .btn-success{ background:#10b981; color:#fff; }
        .btn-warning{ background:#f59e0b; color:#fff; }
        .btn-ghost{ background:#f1f5f9; color:#0f172a; }
        .btn-danger{ background:#fee2e2; color:#ef4444; }
        .btn-danger:hover { background: #ef4444; color: white; }
        .btn:active{ transform: translateY(1px); }

        .admin-panel { display: none; background: #fafafa; border-top: 2px dashed #e2e8f0; padding: 15px; margin-top: 20px; border-radius: 0 0 12px 12px; }
        .admin-panel.active { display: block; animation: fadeIn 0.3s; }
        .admin-hint { font-size: 12px; color: #64748b; margin-bottom: 10px; line-height: 1.5; }
        
        .admin-table-wrap { overflow-x: auto; border: 1px solid #e2e8f0; border-radius: 8px; background: white; max-height: 400px; }
        .admin-table { width: 100%; border-collapse: collapse; min-width: 500px; }
        .admin-table th { background: #f1f5f9; color: #475569; font-size: 12px; padding: 8px; font-weight: bold; border-bottom: 1px solid #cbd5e1; white-space: nowrap; position: sticky; top: 0; z-index: 10;}
        .admin-table td { padding: 6px; border-bottom: 1px solid #f1f5f9; font-size: 13px; color: #334155; vertical-align: middle; white-space: nowrap; }
        
        .admin-input { width: 100%; height: 32px; border: 1px solid #cbd5e1; border-radius: 6px; padding: 0 8px; font-size: 13px; background: #fff; box-sizing: border-box; }
        .admin-input:focus { border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59,130,246,0.1); }
        .admin-actions-row { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; margin-bottom: 10px; }

        .drag-handle { cursor: move; color: #94a3b8; font-size: 18px; width: 30px; text-align: center; user-select: none; }
        .drag-handle:hover { color: #475569; }
        .admin-table tr.dragging { opacity: 0.5; background: #e2e8f0; }

        @media (max-width: 900px){
          .admin-bar{ flex-wrap:wrap; justify-content:flex-end; }
          .admin-date{ width:100%; justify-content:flex-end; }
        }

        /* Modals */
        .admin-modal-backdrop{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.45); z-index:5000; align-items:center; justify-content:center; padding:16px; }
        .admin-modal{ width:min(860px, 100%); max-height: 88vh; overflow:auto; background:#fff; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,.25); display: flex; flex-direction: column;}
        .admin-modal header { padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; background: #fff; position: sticky; top: 0; z-index: 10; border-radius: 16px 16px 0 0; }
        .admin-modal .body{ padding:16px; flex: 1; overflow-y: auto; }
        .admin-field textarea{ width:100%; min-height: 220px; border:1px solid #cbd5e1; border-radius:12px; padding:10px; font-family: monospace; }
        .admin-actions { padding: 15px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px; background: #fff; position: sticky; bottom: 0; z-index: 10; border-radius: 0 0 16px 16px; }
    </style>
</head>
<body class="">

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            RT åƒæ•¸å°ç…§æŸ¥è©¢
            <div class="version-tag">ç‰ˆæœ¬æ—¥æœŸ: 20260121</div>
        </div>
        <div class="sidebar-menu">
            <div class="menu-item active" onclick="switchTab('tab-query')">ğŸ” åƒæ•¸ä¸­å€¼æŸ¥è©¢</div>
            <div class="menu-item" onclick="switchTab('tab-stack')">ğŸ“Š ç–Šæ¿ç‰‡æ•¸å°ç…§è¡¨</div>
            <div class="menu-item" onclick="switchTab('tab-fine')">ğŸ”§ ç²—æ²–å¾Œç´°åˆ‡-æ¿å…§æ§½</div>
            <div class="menu-item" onclick="switchTab('tab-feed')">ğŸš€ é‘½å­”é€²åˆ€é€Ÿå°ç…§è¡¨</div>
            <div class="menu-item" onclick="switchTab('tab-life')">â³ åˆ‡åˆ€å£½å‘½è¦å®š</div>
            <div class="menu-item" onclick="switchTab('tab-note')">ğŸ“ å‚™è¨»äº‹é …</div>
        </div>
        <div class="admin-section">
            <button style="background: rgb(52, 73, 94); color: white; width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; display: block;" id="btnAdmin" onclick="toggleAdmin()">âš™ï¸ ç®¡ç†æ¨¡å¼</button>
            <button style="background: rgb(231, 76, 60); color: white; width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; display: none;" id="btnExit" onclick="toggleAdmin()">ğŸšª é€€å‡ºç®¡ç†</button>
        </div>
    </div>

    <div class="main-wrapper">
        <div class="top-bar">
            <span class="hamburger-btn" style="cursor:pointer; font-size:24px; margin-right:15px; color:#2c3e50;" onclick="document.getElementById('sidebar').classList.toggle('collapsed')">â˜°</span>
            <h3 id="currentTitle" style="margin:0; color:#2c3e50;">åƒæ•¸ä¸­å€¼æŸ¥è©¢</h3>
            <div class="admin-bar" id="adminBar">
                <span class="admin-badge">ç®¡ç†æ¨¡å¼</span>
                <div class="admin-date">
                    <label for="verDate">æ›´æ–°ç‰ˆæœ¬æ—¥æœŸ</label>
                    <input id="verDate" type="date">
                </div>
                <button class="btn btn-ghost" onclick="openAdvancedEditor()">JSON ç·¨è¼¯</button>
                <button class="btn btn-primary" onclick="saveAllChanges()">æš«å­˜(æœ¬æ©Ÿ)</button>
                <button class="btn btn-success" onclick="downloadUpdatedHtml()">ğŸ“¥ åŒ¯å‡º HTML (æ°¸ä¹…ä¿å­˜)</button>
            </div>
        </div>

        <section id="tab-query" class="content-section active">
            <div class="card">
                <div class="query-row">
                    <div class="input-box">
                        <label>é¡å‹</label>
                        <select id="typeSelect" onchange="updateSizeList();"><optgroup label="ä¸»è¦å·¥åº"><option value="FF">ç²—åˆ‡ (FF)</option><option value="AA">ç²—åˆ‡ (AA) æ¸…ç²‰</option><option value="RD">å…§æ§½ (RD)ã€é˜»æŠ—æ¢ (CP)</option><option value="G42">å°é–‰æ§½ã€äºŒæ¬¡å­”ã€è€³æœµæ§½ã€è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ (G42)</option><option value="OR">å¤–å‹ (OR)ã€è£é–‹ (HA)</option></optgroup><optgroup label="ç‰¹æ®Šå·¥åº"><option value="RDL">å…§æ§½ (RDL) é€†è½‰åˆ€</option><option value="DA">å°å¼•å­” (DA)</option><option value="DAFF">ç²—åˆ‡å°å¼•å­” (DA FF)</option></optgroup></select>
                        <button type="button" class="picker-btn mobile-only" id="typeSelectBtn" onclick="openPicker('typeSelect','é¸æ“‡é¡å‹')">ç²—åˆ‡ (FF)</button>
                    </div>
                    <div class="input-box">
                        <label>å°ºå¯¸</label>
                        <select id="sizeSelect" onchange="runQuery()"><option value="0.0197">0.0197</option><option value="0.0197 CB">0.0197 CB</option><option value="0.0236">0.0236</option><option value="0.0236 CB">0.0236 CB</option><option value="0.031">0.031</option><option value="0.035">0.035</option><option value="0.039">0.039</option><option value="0.039 CB">0.039 CB</option><option value="0.039 LCB">0.039 LCB</option><option value="0.047">0.047</option><option value="0.047 LCB">0.047 LCB</option><option value="0.055">0.055</option><option value="0.059">0.059</option><option value="0.062">0.062</option><option value="0.079">0.079</option><option value="0.093">0.093</option></select>
                        <button type="button" class="picker-btn mobile-only" id="sizeSelectBtn" onclick="openPicker('sizeSelect','é¸æ“‡å°ºå¯¸')">0.0197</button>
                    </div>
                </div>
                <div class="table-wrap">
                    <table id="mainTable">
                        <thead><tr><th>è½‰é€Ÿ (S)</th><th>é€²åˆ€ (F)</th><th>å£½å‘½ (N)</th><th>è£œå„Ÿ (D)</th><th>æª¯é¢é€Ÿåº¦ (F0X)</th></tr></thead>
                        <tbody id="tableBody"><tr><td>40</td><td>10</td><td>50</td><td>0.0098</td><td>10</td></tr></tbody>
                    </table>
                </div>

                <div id="adminPanel-query" class="admin-panel">
                    <div class="admin-hint">
                        - æ‹–æ›³ã€Œâ˜°ã€å¯èª¿æ•´å°ºå¯¸é †åºã€‚<br>
                        - ç®¡ç†é¡å‹ï¼šå¯æ–°å¢å…¨æ–°é¡å‹ã€ä¿®æ”¹ç›®å‰é¡å‹åç¨±æˆ–åˆªé™¤ã€‚
                    </div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminParamAddSize()">ï¼‹ æ–°å¢å°ºå¯¸</button>
                        <div style="border-left: 1px solid #cbd5e1; padding-left: 10px; margin-left: 5px; display: flex; gap: 8px;">
                            <button class="btn btn-ghost" onclick="adminParamAddType()">ï¼‹ æ–°å¢é¡å‹</button>
                            <button class="btn btn-ghost" onclick="adminParamRenameType()">âœ ä¿®æ”¹åç¨±</button>
                            <button class="btn btn-danger" onclick="adminParamDeleteType()">ğŸ—‘ï¸ åˆªé™¤é¡å‹</button>
                        </div>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th>å°ºå¯¸ Key (å¯æ”¹å)</th><th>è½‰é€Ÿ (S)</th><th>é€²åˆ€ (F)</th><th>å£½å‘½ (N)</th><th>è£œå„Ÿ (D)</th><th>F0X</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-query" data-sortable-init="1"><tr draggable="true" data-key="0.0197">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.0197" oninput="adminParamRename(this, '0.0197')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40" oninput="adminParamSet('0.0197','FF',0,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0197','FF',1,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.0197','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0098" oninput="adminParamSet('0.0197','FF',3,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0197','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.0197','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.0197 CB">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.0197 CB" oninput="adminParamRename(this, '0.0197 CB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40" oninput="adminParamSet('0.0197 CB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0197 CB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="150" oninput="adminParamSet('0.0197 CB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0098" oninput="adminParamSet('0.0197 CB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0197 CB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.0197 CB','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.0236">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.0236" oninput="adminParamRename(this, '0.0236')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40" oninput="adminParamSet('0.0236','FF',0,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0236','FF',1,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.0236','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0118" oninput="adminParamSet('0.0236','FF',3,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0236','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.0236','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.0236 CB">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.0236 CB" oninput="adminParamRename(this, '0.0236 CB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40" oninput="adminParamSet('0.0236 CB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0236 CB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="150" oninput="adminParamSet('0.0236 CB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0118" oninput="adminParamSet('0.0236 CB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0236 CB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.0236 CB','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.031">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.031" oninput="adminParamRename(this, '0.031')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.031','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.031','FF',1,this.value)"></td>
                <td><input class="admin-input" value="100" oninput="adminParamSet('0.031','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0155" oninput="adminParamSet('0.031','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.031','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.031','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.035">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.035" oninput="adminParamRename(this, '0.035')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.035','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.035','FF',1,this.value)"></td>
                <td><input class="admin-input" value="100" oninput="adminParamSet('0.035','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0175" oninput="adminParamSet('0.035','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.035','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.035','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.039">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.039" oninput="adminParamRename(this, '0.039')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.039','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039','FF',1,this.value)"></td>
                <td><input class="admin-input" value="200" oninput="adminParamSet('0.039','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0195" oninput="adminParamSet('0.039','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.039','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.039 CB">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.039 CB" oninput="adminParamRename(this, '0.039 CB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.039 CB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039 CB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="700" oninput="adminParamSet('0.039 CB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0195" oninput="adminParamSet('0.039 CB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039 CB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.039 CB','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.039 LCB">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.039 LCB" oninput="adminParamRename(this, '0.039 LCB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.039 LCB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039 LCB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="300" oninput="adminParamSet('0.039 LCB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0195" oninput="adminParamSet('0.039 LCB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039 LCB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.039 LCB','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.047">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.047" oninput="adminParamRename(this, '0.047')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.047','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.047','FF',1,this.value)"></td>
                <td><input class="admin-input" value="200" oninput="adminParamSet('0.047','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0235" oninput="adminParamSet('0.047','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.047','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.047','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.047 LCB">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.047 LCB" oninput="adminParamRename(this, '0.047 LCB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.047 LCB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.047 LCB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="300" oninput="adminParamSet('0.047 LCB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0235" oninput="adminParamSet('0.047 LCB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.047 LCB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.047 LCB','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.055">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.055" oninput="adminParamRename(this, '0.055')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.055','FF',0,this.value)"></td>
                <td><input class="admin-input" value="15" oninput="adminParamSet('0.055','FF',1,this.value)"></td>
                <td><input class="admin-input" value="420" oninput="adminParamSet('0.055','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0275" oninput="adminParamSet('0.055','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.055','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.055','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.059">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.059" oninput="adminParamRename(this, '0.059')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.059','FF',0,this.value)"></td>
                <td><input class="admin-input" value="20" oninput="adminParamSet('0.059','FF',1,this.value)"></td>
                <td><input class="admin-input" value="420" oninput="adminParamSet('0.059','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0295" oninput="adminParamSet('0.059','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.059','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.059','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.062">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.062" oninput="adminParamRename(this, '0.062')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.062','FF',0,this.value)"></td>
                <td><input class="admin-input" value="30" oninput="adminParamSet('0.062','FF',1,this.value)"></td>
                <td><input class="admin-input" value="520" oninput="adminParamSet('0.062','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0315" oninput="adminParamSet('0.062','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.062','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.062','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.079">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.079" oninput="adminParamRename(this, '0.079')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.079','FF',0,this.value)"></td>
                <td><input class="admin-input" value="30" oninput="adminParamSet('0.079','FF',1,this.value)"></td>
                <td><input class="admin-input" value="700" oninput="adminParamSet('0.079','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0395" oninput="adminParamSet('0.079','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.079','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.079','FF')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="0.093">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="0.093" oninput="adminParamRename(this, '0.093')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.093','FF',0,this.value)"></td>
                <td><input class="admin-input" value="30" oninput="adminParamSet('0.093','FF',1,this.value)"></td>
                <td><input class="admin-input" value="1020" oninput="adminParamSet('0.093','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0465" oninput="adminParamSet('0.093','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.093','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.093','FF')">åˆªé™¤</button></td>
            </tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-stack" class="content-section">
            <div class="card">
                <div class="query-row">
                    <div class="input-box"><label>æœ€å°åˆ‡åˆ€ç›´å¾‘ mil (mm)</label><select id="stkSizeSel" onchange="updateStackThickList(); runStackQuery()"><option value="15.7 (0.40)">15.7 (0.40)</option><option value="19.7 (0.50)">19.7 (0.50)</option><option value="19.7 LCBRD (0.50)">19.7 LCBRD (0.50)</option><option value="23.6 (0.60)">23.6 (0.60)</option><option value="23.6 LCBRD (0.60)">23.6 LCBRD (0.60)</option><option value="31~35 (0.80-0.90)">31~35 (0.80-0.90)</option><option value="35 LRD (0.90)">35 LRD (0.90)</option><option value="39~55 (0.10-1.40)">39~55 (0.10-1.40)</option><option value="59~98 (1.50-2.50)">59~98 (1.50-2.50)</option><option value="39~47 LCBRD (1.00-1.20)">39~47 LCBRD (1.00-1.20)</option></select></div>
                    <div class="input-box"><label>æˆå“æ¿åš</label><select id="stkThickSel" onchange="runStackQuery()"><option value="9~10">9~10</option><option value="11~13">11~13</option><option value="14~20">14~20</option><option value="21~40">21~40</option></select></div>
                </div>
                <div id="adminPanel-stack" class="admin-panel">
                    <div class="admin-hint">
                        ä¿®æ”¹ã€Œè¦å‰‡å­—ä¸²ã€æœƒå³æ™‚æ›´æ–°ä¸‹æ‹‰é¸å–®é †åº (ä¾ç…§è¼¸å…¥çš„å…ˆå¾Œé †åºæ’åˆ—)ã€‚<br>
                        æ ¼å¼ç¯„ä¾‹ï¼š<code>13:9, 9~12:10</code> (å‰é¢æœƒåœ¨é¸å–®ä¸Šæ–¹)
                    </div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminStackAdd()">ï¼‹ æ–°å¢å°ºå¯¸è¦å‰‡</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th>å°ºå¯¸ Key (å¯æ”¹å)</th><th>æœ€å¤§åšåº¦æ–‡å­—</th><th>è¦å‰‡å­—ä¸² (ç¯„åœ:ç‰‡æ•¸)</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-stack" data-sortable-init="1"><tr draggable="true" data-key="15.7 (0.40)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="15.7 (0.40)" oninput="adminStackRename(this, '15.7 (0.40)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40 (1.02)" oninput="adminStackSetMax('15.7 (0.40)',this.value)"></td>
                <td><input class="admin-input" value="9~10:4, 11~13:3, 14~20:2, 21~40:1" oninput="adminStackSetOpt('15.7 (0.40)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('15.7 (0.40)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="19.7 (0.50)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="19.7 (0.50)" oninput="adminStackRename(this, '19.7 (0.50)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="66 (1.68)" oninput="adminStackSetMax('19.7 (0.50)',this.value)"></td>
                <td><input class="admin-input" value="10~16:4, 17~22:3, 23~33:2, 34~66:1" oninput="adminStackSetOpt('19.7 (0.50)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('19.7 (0.50)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="19.7 LCBRD (0.50)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="19.7 LCBRD (0.50)" oninput="adminStackRename(this, '19.7 LCBRD (0.50)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="86 (2.18)" oninput="adminStackSetMax('19.7 LCBRD (0.50)',this.value)"></td>
                <td><input class="admin-input" value="10~17:5, 18~21:4, 22~28:3, 29~43:2, 44~86:1" oninput="adminStackSetOpt('19.7 LCBRD (0.50)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('19.7 LCBRD (0.50)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="23.6 (0.60)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="23.6 (0.60)" oninput="adminStackRename(this, '23.6 (0.60)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="88 (2.24)" oninput="adminStackSetMax('23.6 (0.60)',this.value)"></td>
                <td><input class="admin-input" value="15~22:4, 23~29:3, 30~44:2, 45~88:1" oninput="adminStackSetOpt('23.6 (0.60)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('23.6 (0.60)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="23.6 LCBRD (0.60)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="23.6 LCBRD (0.60)" oninput="adminStackRename(this, '23.6 LCBRD (0.60)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="108 (2.74)" oninput="adminStackSetMax('23.6 LCBRD (0.60)',this.value)"></td>
                <td><input class="admin-input" value="15~21:5, 22~27:4, 28~36:3, 37~54:2, 55~108:1" oninput="adminStackSetOpt('23.6 LCBRD (0.60)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('23.6 LCBRD (0.60)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="31~35 (0.80-0.90)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="31~35 (0.80-0.90)" oninput="adminStackRename(this, '31~35 (0.80-0.90)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="122 (2.74)" oninput="adminStackSetMax('31~35 (0.80-0.90)',this.value)"></td>
                <td><input class="admin-input" value="9~12:10, 13:9, 14~15:8, 16~17:7, 18~20:6, 21~24:5, 25~30:4, 31~40:3, 41~61:2, 62~122:1" oninput="adminStackSetOpt('31~35 (0.80-0.90)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('31~35 (0.80-0.90)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="35 LRD (0.90)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="35 LRD (0.90)" oninput="adminStackRename(this, '35 LRD (0.90)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="170 (4.32)" oninput="adminStackSetMax('35 LRD (0.90)',this.value)"></td>
                <td><input class="admin-input" value="15~21:8, 22~24:7, 25~28:6, 29~34:5, 35~42:4, 43~56:3, 57~85:2" oninput="adminStackSetOpt('35 LRD (0.90)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('35 LRD (0.90)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="39~55 (0.10-1.40)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="39~55 (0.10-1.40)" oninput="adminStackRename(this, '39~55 (0.10-1.40)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="205 (5.21)" oninput="adminStackSetMax('39~55 (0.10-1.40)',this.value)"></td>
                <td><input class="admin-input" value="15~22:8, 23~25:7, 26~30:6, 31~37:5, 38~47:4, 48~64:3, 65~99:2" oninput="adminStackSetOpt('39~55 (0.10-1.40)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('39~55 (0.10-1.40)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="59~98 (1.50-2.50)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="59~98 (1.50-2.50)" oninput="adminStackRename(this, '59~98 (1.50-2.50)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="259 (6.6)" oninput="adminStackSetMax('59~98 (1.50-2.50)',this.value)"></td>
                <td><input class="admin-input" value="15~18:12, 19~22:10, 23~28:8, 29~33:7, 34~39:6, 40~47:5, 48~60:4, 61~81:3" oninput="adminStackSetOpt('59~98 (1.50-2.50)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('59~98 (1.50-2.50)')">åˆªé™¤</button></td>
            </tr><tr draggable="true" data-key="39~47 LCBRD (1.00-1.20)">
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="39~47 LCBRD (1.00-1.20)" oninput="adminStackRename(this, '39~47 LCBRD (1.00-1.20)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="263 (6.7)" oninput="adminStackSetMax('39~47 LCBRD (1.00-1.20)',this.value)"></td>
                <td><input class="admin-input" value="15~18:12, 19~22:10, 23~28:8, 29~33:7, 34~39:6, 40~47:5, 48~60:4, 61~68:3" oninput="adminStackSetOpt('39~47 LCBRD (1.00-1.20)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('39~47 LCBRD (1.00-1.20)')">åˆªé™¤</button></td>
            </tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                <div style="background:#f8fafc; padding:25px; border-radius:12px; text-align:center; border:1px solid #edf2f7;"><span style="font-size:13px; color:#64748b; display:block; margin-bottom:10px; font-weight:bold;">å»ºè­°ç–Šæ¿ç‰‡æ•¸</span><span id="stkResCount" style="font-size:36px; font-weight:800; color:#2b6cb0;">4 ç‰‡</span></div>
                <div style="background:#f8fafc; padding:25px; border-radius:12px; text-align:center; border:1px solid #edf2f7;"><span style="font-size:13px; color:#64748b; display:block; margin-bottom:10px; font-weight:bold;">æœ€å¤§ç–Šæ¿åšåº¦ mil (mm)</span><span id="stkResMax" style="font-size:22px; font-weight:800; color:#1a202c;">40 (1.02)</span></div>
            </div>
        </section>

        <section id="tab-fine" class="content-section">
            <div class="card">
                <div class="input-box" style="margin-bottom:20px;">
                    <label>å°ºå¯¸ (mil/mm)</label>
                    <div class="fine-box">
                        <div class="fine-select-wrapper">
                            <select id="fineSizeSel" onchange="runFineQuery()"><option value="0">0.0197"(0.500) (åœŸé»ƒè‰²)</option><option value="1">0.0197" LCBRD(0.500) (è˜‹æœç¶ )</option><option value="2">0.0236"(0.600) (é†¬ç´…è‰²)</option><option value="3">0.0236" LCBRD(0.600) (é»‘è‰²)</option><option value="4">0.031"(0.800) (æ·±è—è‰²)</option><option value="5">0.031" CBRD(0.800) (å’–å•¡è‰²)</option><option value="6">0.031" (é€†)æ¼¢å°(0.800) (é’è‰²)</option><option value="7">0.035"(0.900) (æŸ‘ç´…è‰²)</option><option value="8">0.035" LRD(0.900) (æ·¡ç´«è‰²)</option><option value="9">0.039"(1.000) (å¢¨ç¶ è‰²)</option><option value="10">0.039" CBRD(1.000) (ç²‰ç´…è‰²)</option><option value="11">0.039" (é€†)å°–é»(1.000) (ç™½è‰²)</option><option value="12">0.039" (é€†)æ—­è²¿(1.000) (ç™½è‰²)</option><option value="13">0.0039" LCBRD(1.000) (æ£•ç´…è‰²)</option><option value="14">0.043"(1.100) (æ·¡æ¢¨è‰²)</option><option value="15">0.047"(1.200) (æ·±ç´«è‰²)</option><option value="16">0.047"(1.200) (æ©„æ¬–ç¶ )</option><option value="17">0.047" LCBRD(1.200)(æ·¡æ©˜è‰²)</option><option value="18">0.051"(1.300)(å¡å…¶è‰²)</option><option value="19">0.055"(1.400)(æ·¡è—è‰²)</option><option value="20">0.059"(1.500)(ç°è‰²)</option><option value="21">0.062"(1.600) (å‡é»ƒè‰²)</option><option value="22">0.067"(1.700)(èƒ­è„‚ç´…)</option><option value="23">0.069"(1.750)(è˜‹æœç¶ )</option><option value="24">0.071"(1.800)(å¤©è—è‰²)</option><option value="25">0.075"(1.900)(æ¡ƒç´…è‰²)</option><option value="26">0.079"(2.000)(å¤§ç´…è‰²)</option><option value="27">0.093"(2.380)(ç™½è‰²)</option><option value="28">0.098"(2.500) (æ¾æ¨¹ç¶ )</option></select>
                            <button type="button" class="picker-btn mobile-only" id="fineSizeSelBtn" onclick="openPicker('fineSizeSel','é¸æ“‡å°ºå¯¸')">0.0197"(0.500) (åœŸé»ƒè‰²)</button>
                        </div>
                        <div id="fineBadge" class="color-badge" style="background-color: rgb(212, 160, 23);">åœŸé»ƒè‰²</div>
                    </div>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead><tr><th>è½‰é€Ÿ (S)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>é€²åˆ€é€Ÿ (F)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>æª¯é¢é€Ÿåº¦ (F)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>è£œå„Ÿå€¼ (D)<br><small>å¯èª¿æ•´ç¯„åœ</small></th></tr></thead>
                        <tbody id="fineTableBody"><tr><td><span class="val-mid">40</span><span class="val-range">30~45</span></td><td><span class="val-mid">8</span><span class="val-range">5~10</span></td><td><span class="val-mid">8</span><span class="val-range">5~10</span></td><td><span class="val-mid">0.0098</span><span class="val-range">+/-0.003"</span></td></tr></tbody>
                    </table>
                </div>

                <div id="adminPanel-fine" class="admin-panel">
                    <div class="admin-hint">ä¿®æ”¹ã€Œå°ºå¯¸æ¨™ç±¤ã€æœƒå³æ™‚åŒæ­¥ä¸Šæ–¹é¸å–®ã€‚</div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminFineAdd()">ï¼‹ æ–°å¢ç´°åˆ‡è¦å‰‡</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th>å°ºå¯¸æ¨™ç±¤ (mil/mm)</th><th>é¡è‰²</th><th>è½‰é€Ÿ(ä¸­/ç¯„)</th><th>é€²åˆ€(ä¸­/ç¯„)</th><th>æª¯é¢(ä¸­/ç¯„)</th><th>è£œå„Ÿ(ä¸­/ç¯„)</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-fine" data-sortable-init="1"><tr draggable="true" data-idx="0">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0197&quot;(0.500) (åœŸé»ƒè‰²)" oninput="adminFineSetLabel(0,this.value)" onchange="adminFineSetLabel(0,this.value)" onblur="adminFineSetLabel(0,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-0" class="admin-input" value="åœŸé»ƒè‰²" oninput="adminFineSetColor(0,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-0" type="color" value="#D4A017" onchange="adminFineSetColorHex(0,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(0,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="30~45" oninput="adminFineSet(0,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(0,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(0,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(0,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(0,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0098" oninput="adminFineSet(0,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(0,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(0)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="1">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0197&quot; LCBRD(0.500) (è˜‹æœç¶ )" oninput="adminFineSetLabel(1,this.value)" onchange="adminFineSetLabel(1,this.value)" onblur="adminFineSetLabel(1,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-1" class="admin-input" value="è˜‹æœç¶ " oninput="adminFineSetColor(1,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-1" type="color" value="#8DB600" onchange="adminFineSetColorHex(1,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="45" oninput="adminFineSet(1,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="40~55" oninput="adminFineSet(1,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(1,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(1,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(1,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(1,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0098" oninput="adminFineSet(1,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(1,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(1)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="2">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0236&quot;(0.600) (é†¬ç´…è‰²)" oninput="adminFineSetLabel(2,this.value)" onchange="adminFineSetLabel(2,this.value)" onblur="adminFineSetLabel(2,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-2" class="admin-input" value="é†¬ç´…è‰²" oninput="adminFineSetColor(2,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-2" type="color" value="#800000" onchange="adminFineSetColorHex(2,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(2,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="30~45" oninput="adminFineSet(2,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(2,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(2,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(2,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(2,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0118" oninput="adminFineSet(2,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(2,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(2)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="3">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0236&quot; LCBRD(0.600) (é»‘è‰²)" oninput="adminFineSetLabel(3,this.value)" onchange="adminFineSetLabel(3,this.value)" onblur="adminFineSetLabel(3,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-3" class="admin-input" value="é»‘è‰²" oninput="adminFineSetColor(3,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-3" type="color" value="#000000" onchange="adminFineSetColorHex(3,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(3,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="30~50" oninput="adminFineSet(3,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(3,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(3,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(3,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(3,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0118" oninput="adminFineSet(3,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(3,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(3)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="4">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.031&quot;(0.800) (æ·±è—è‰²)" oninput="adminFineSetLabel(4,this.value)" onchange="adminFineSetLabel(4,this.value)" onblur="adminFineSetLabel(4,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-4" class="admin-input" value="æ·±è—è‰²" oninput="adminFineSetColor(4,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-4" type="color" value="#00008B" onchange="adminFineSetColorHex(4,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(4,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~40" oninput="adminFineSet(4,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(4,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(4,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(4,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(4,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0155" oninput="adminFineSet(4,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(4,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(4)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="5">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.031&quot; CBRD(0.800) (å’–å•¡è‰²)" oninput="adminFineSetLabel(5,this.value)" onchange="adminFineSetLabel(5,this.value)" onblur="adminFineSetLabel(5,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-5" class="admin-input" value="å’–å•¡è‰²" oninput="adminFineSetColor(5,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-5" type="color" value="#6F4E37" onchange="adminFineSetColorHex(5,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="55" oninput="adminFineSet(5,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="40~55" oninput="adminFineSet(5,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(5,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(5,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(5,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(5,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0155" oninput="adminFineSet(5,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(5,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(5)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="6">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.031&quot; (é€†)æ¼¢å°(0.800) (é’è‰²)" oninput="adminFineSetLabel(6,this.value)" onchange="adminFineSetLabel(6,this.value)" onblur="adminFineSetLabel(6,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-6" class="admin-input" value="é’è‰²" oninput="adminFineSetColor(6,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-6" type="color" value="#00CED1" onchange="adminFineSetColorHex(6,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="-30" oninput="adminFineSet(6,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="-30" oninput="adminFineSet(6,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(6,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(6,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(6,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~10" oninput="adminFineSet(6,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0155" oninput="adminFineSet(6,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(6,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(6)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="7">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.035&quot;(0.900) (æŸ‘ç´…è‰²)" oninput="adminFineSetLabel(7,this.value)" onchange="adminFineSetLabel(7,this.value)" onblur="adminFineSetLabel(7,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-7" class="admin-input" value="æŸ‘ç´…è‰²" oninput="adminFineSetColor(7,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-7" type="color" value="#FF4500" onchange="adminFineSetColorHex(7,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(7,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~40" oninput="adminFineSet(7,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(7,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(7,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(7,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(7,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0175" oninput="adminFineSet(7,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(7,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(7)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="8">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.035&quot; LRD(0.900) (æ·¡ç´«è‰²)" oninput="adminFineSetLabel(8,this.value)" onchange="adminFineSetLabel(8,this.value)" onblur="adminFineSetLabel(8,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-8" class="admin-input" value="æ·¡ç´«è‰²" oninput="adminFineSetColor(8,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-8" type="color" value="#E6E6FA" onchange="adminFineSetColorHex(8,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(8,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~40" oninput="adminFineSet(8,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(8,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(8,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(8,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(8,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0175" oninput="adminFineSet(8,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(8,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(8)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="9">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.039&quot;(1.000) (å¢¨ç¶ è‰²)" oninput="adminFineSetLabel(9,this.value)" onchange="adminFineSetLabel(9,this.value)" onblur="adminFineSetLabel(9,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-9" class="admin-input" value="å¢¨ç¶ è‰²" oninput="adminFineSetColor(9,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-9" type="color" value="#006400" onchange="adminFineSetColorHex(9,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(9,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~40" oninput="adminFineSet(9,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(9,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(9,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(9,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(9,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(9,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(9,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(9)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="10">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.039&quot; CBRD(1.000) (ç²‰ç´…è‰²)" oninput="adminFineSetLabel(10,this.value)" onchange="adminFineSetLabel(10,this.value)" onblur="adminFineSetLabel(10,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-10" class="admin-input" value="ç²‰ç´…è‰²" oninput="adminFineSetColor(10,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-10" type="color" value="#FF69B4" onchange="adminFineSetColorHex(10,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(10,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~50" oninput="adminFineSet(10,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(10,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(10,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(10,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(10,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(10,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(10,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(10)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="11">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.039&quot; (é€†)å°–é»(1.000) (ç™½è‰²)" oninput="adminFineSetLabel(11,this.value)" onchange="adminFineSetLabel(11,this.value)" onblur="adminFineSetLabel(11,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-11" class="admin-input" value="ç™½è‰²" oninput="adminFineSetColor(11,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-11" type="color" value="#FFFFFF" onchange="adminFineSetColorHex(11,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="-30" oninput="adminFineSet(11,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="-25~-40" oninput="adminFineSet(11,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(11,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(11,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(11,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(11,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(11,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(11,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(11)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="12">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.039&quot; (é€†)æ—­è²¿(1.000) (ç™½è‰²)" oninput="adminFineSetLabel(12,this.value)" onchange="adminFineSetLabel(12,this.value)" onblur="adminFineSetLabel(12,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-12" class="admin-input" value="ç™½è‰²" oninput="adminFineSetColor(12,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-12" type="color" value="#FFFFFF" onchange="adminFineSetColorHex(12,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="-30" oninput="adminFineSet(12,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="-25~-40" oninput="adminFineSet(12,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(12,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(12,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(12,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(12,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(12,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(12,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(12)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="13">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0039&quot; LCBRD(1.000) (æ£•ç´…è‰²)" oninput="adminFineSetLabel(13,this.value)" onchange="adminFineSetLabel(13,this.value)" onblur="adminFineSetLabel(13,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-13" class="admin-input" value="æ£•ç´…è‰²" oninput="adminFineSetColor(13,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-13" type="color" value="#A52A2A" onchange="adminFineSetColorHex(13,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(13,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~50" oninput="adminFineSet(13,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(13,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(13,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(13,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(13,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(13,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(13,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(13)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="14">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.043&quot;(1.100) (æ·¡æ¢¨è‰²)" oninput="adminFineSetLabel(14,this.value)" onchange="adminFineSetLabel(14,this.value)" onblur="adminFineSetLabel(14,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-14" class="admin-input" value="æ·¡æ¢¨è‰²" oninput="adminFineSetColor(14,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-14" type="color" value="#F0EAD6" onchange="adminFineSetColorHex(14,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(14,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~40" oninput="adminFineSet(14,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(14,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(14,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(14,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(14,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0215" oninput="adminFineSet(14,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(14,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(14)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="15">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.047&quot;(1.200) (æ·±ç´«è‰²)" oninput="adminFineSetLabel(15,this.value)" onchange="adminFineSetLabel(15,this.value)" onblur="adminFineSetLabel(15,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-15" class="admin-input" value="æ·±ç´«è‰²" oninput="adminFineSetColor(15,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-15" type="color" value="#800080" onchange="adminFineSetColorHex(15,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(15,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~40" oninput="adminFineSet(15,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(15,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(15,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(15,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~25" oninput="adminFineSet(15,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0235" oninput="adminFineSet(15,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(15,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(15)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="16">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.047&quot;(1.200) (æ©„æ¬–ç¶ )" oninput="adminFineSetLabel(16,this.value)" onchange="adminFineSetLabel(16,this.value)" onblur="adminFineSetLabel(16,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-16" class="admin-input" value="æ©„æ¬–ç¶ " oninput="adminFineSetColor(16,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-16" type="color" value="#6B8E23" onchange="adminFineSetColorHex(16,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(16,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~40" oninput="adminFineSet(16,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(16,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(16,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(16,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~25" oninput="adminFineSet(16,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0235" oninput="adminFineSet(16,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(16,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(16)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="17">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.047&quot; LCBRD(1.200)(æ·¡æ©˜è‰²)" oninput="adminFineSetLabel(17,this.value)" onchange="adminFineSetLabel(17,this.value)" onblur="adminFineSetLabel(17,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-17" class="admin-input" value="æ·¡æ©˜è‰²" oninput="adminFineSetColor(17,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-17" type="color" value="#FFB84D" onchange="adminFineSetColorHex(17,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(17,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~50" oninput="adminFineSet(17,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(17,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(17,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(17,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(17,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0235&quot;" oninput="adminFineSet(17,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(17,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(17)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="18">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.051&quot;(1.300)(å¡å…¶è‰²)" oninput="adminFineSetLabel(18,this.value)" onchange="adminFineSetLabel(18,this.value)" onblur="adminFineSetLabel(18,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-18" class="admin-input" value="å¡å…¶è‰²" oninput="adminFineSetColor(18,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-18" type="color" value="#F0E68C" onchange="adminFineSetColorHex(18,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(18,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~35" oninput="adminFineSet(18,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(18,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(18,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(18,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~25" oninput="adminFineSet(18,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0255&quot;" oninput="adminFineSet(18,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(18,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(18)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="19">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.055&quot;(1.400)(æ·¡è—è‰²)" oninput="adminFineSetLabel(19,this.value)" onchange="adminFineSetLabel(19,this.value)" onblur="adminFineSetLabel(19,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-19" class="admin-input" value="æ·¡è—è‰²" oninput="adminFineSetColor(19,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-19" type="color" value="#ADD8E6" onchange="adminFineSetColorHex(19,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(19,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~35" oninput="adminFineSet(19,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(19,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~35" oninput="adminFineSet(19,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(19,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~27" oninput="adminFineSet(19,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0275&quot;" oninput="adminFineSet(19,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(19,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(19)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="20">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.059&quot;(1.500)(ç°è‰²)" oninput="adminFineSetLabel(20,this.value)" onchange="adminFineSetLabel(20,this.value)" onblur="adminFineSetLabel(20,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-20" class="admin-input" value="ç°è‰²" oninput="adminFineSetColor(20,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-20" type="color" value="#808080" onchange="adminFineSetColorHex(20,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(20,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~35" oninput="adminFineSet(20,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(20,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~35" oninput="adminFineSet(20,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(20,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~27" oninput="adminFineSet(20,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0295&quot;" oninput="adminFineSet(20,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(20,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(20)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="21">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.062&quot;(1.600) (å‡é»ƒè‰²)" oninput="adminFineSetLabel(21,this.value)" onchange="adminFineSetLabel(21,this.value)" onblur="adminFineSetLabel(21,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-21" class="admin-input" value="å‡é»ƒè‰²" oninput="adminFineSetColor(21,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-21" type="color" value="#F0E68C" onchange="adminFineSetColorHex(21,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(21,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="18~35" oninput="adminFineSet(21,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(21,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(21,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="25" oninput="adminFineSet(21,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(21,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0315" oninput="adminFineSet(21,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(21,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(21)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="22">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.067&quot;(1.700)(èƒ­è„‚ç´…)" oninput="adminFineSetLabel(22,this.value)" onchange="adminFineSetLabel(22,this.value)" onblur="adminFineSetLabel(22,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-22" class="admin-input" value="èƒ­è„‚ç´…" oninput="adminFineSetColor(22,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-22" type="color" value="#C71585" onchange="adminFineSetColorHex(22,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(22,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~35" oninput="adminFineSet(22,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(22,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(22,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="25" oninput="adminFineSet(22,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(22,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0335&quot;" oninput="adminFineSet(22,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(22,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(22)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="23">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.069&quot;(1.750)(è˜‹æœç¶ )" oninput="adminFineSetLabel(23,this.value)" onchange="adminFineSetLabel(23,this.value)" onblur="adminFineSetLabel(23,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-23" class="admin-input" value="è˜‹æœç¶ " oninput="adminFineSetColor(23,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-23" type="color" value="#8DB600" onchange="adminFineSetColorHex(23,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(23,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~35" oninput="adminFineSet(23,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(23,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(23,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="25" oninput="adminFineSet(23,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(23,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0345&quot;" oninput="adminFineSet(23,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(23,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(23)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="24">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.071&quot;(1.800)(å¤©è—è‰²)" oninput="adminFineSetLabel(24,this.value)" onchange="adminFineSetLabel(24,this.value)" onblur="adminFineSetLabel(24,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-24" class="admin-input" value="å¤©è—è‰²" oninput="adminFineSetColor(24,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-24" type="color" value="#87CEEB" onchange="adminFineSetColorHex(24,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(24,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~35" oninput="adminFineSet(24,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(24,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(24,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="25" oninput="adminFineSet(24,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(24,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0355&quot;" oninput="adminFineSet(24,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(24,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(24)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="25">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.075&quot;(1.900)(æ¡ƒç´…è‰²)" oninput="adminFineSetLabel(25,this.value)" onchange="adminFineSetLabel(25,this.value)" onblur="adminFineSetLabel(25,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-25" class="admin-input" value="æ¡ƒç´…è‰²" oninput="adminFineSetColor(25,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-25" type="color" value="#FF69B4" onchange="adminFineSetColorHex(25,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(25,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~35" oninput="adminFineSet(25,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(25,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(25,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(25,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~35" oninput="adminFineSet(25,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0375&quot;" oninput="adminFineSet(25,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(25,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(25)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="26">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.079&quot;(2.000)(å¤§ç´…è‰²)" oninput="adminFineSetLabel(26,this.value)" onchange="adminFineSetLabel(26,this.value)" onblur="adminFineSetLabel(26,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-26" class="admin-input" value="å¤§ç´…è‰²" oninput="adminFineSetColor(26,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-26" type="color" value="#FF0000" onchange="adminFineSetColorHex(26,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(26,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~35" oninput="adminFineSet(26,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(26,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(26,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(26,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~35" oninput="adminFineSet(26,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0395&quot;" oninput="adminFineSet(26,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(26,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(26)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="27">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.093&quot;(2.380)(ç™½è‰²)" oninput="adminFineSetLabel(27,this.value)" onchange="adminFineSetLabel(27,this.value)" onblur="adminFineSetLabel(27,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-27" class="admin-input" value="ç™½è‰²" oninput="adminFineSetColor(27,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-27" type="color" value="#FFFFFF" onchange="adminFineSetColorHex(27,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(27,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="18~30" oninput="adminFineSet(27,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(27,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(27,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(27,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~45" oninput="adminFineSet(27,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0490&quot;" oninput="adminFineSet(27,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(27,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(27)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="28">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.098&quot;(2.500) (æ¾æ¨¹ç¶ )" oninput="adminFineSetLabel(28,this.value)" onchange="adminFineSetLabel(28,this.value)" onblur="adminFineSetLabel(28,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-28" class="admin-input" value="æ¾æ¨¹ç¶ " oninput="adminFineSetColor(28,this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-28" type="color" value="#01796F" onchange="adminFineSetColorHex(28,this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(28,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="18~30" oninput="adminFineSet(28,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(28,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(28,'f',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(28,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~45" oninput="adminFineSet(28,'t',1,this.value)"></td>
                <td><input class="admin-input" style="width:60px" value="0.0490" oninput="adminFineSet(28,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(28,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(28)">åˆª</button></td>
            </tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-feed" class="content-section">
            <div class="card">
                <div class="input-box" style="margin-bottom:20px;">
                    <label>é‘½é ­ç›´å¾‘ (inch/mm)</label>
                    <select id="feedSizeSel" style="width:300px;" onchange="runFeedQuery()"><option value="0">0.0279" ä»¥ä¸‹</option><option value="1">0.0280"~0.0429"</option><option value="2">0.0430"~0.0865"</option><option value="3">0.0866"~0.1014"</option><option value="4">0.1015"~0.1259"</option><option value="5">0.1260"~0.1456"</option><option value="6">0.1457" ä»¥ä¸Š</option></select>
                    <button type="button" class="picker-btn mobile-only" id="feedSizeSelBtn" onclick="openPicker('feedSizeSel','é¸æ“‡ç›´å¾‘')">0.0279" ä»¥ä¸‹</button>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr><th>è½‰é€Ÿ (S)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th><th style="background:#ebf8ff; color:#2b6cb0;">å°å¼•å­” (F)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th><th style="background:#f0fff4; color:#2f855a;">äºŒæ¬¡å­” (F)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th><th>å£½å‘½ (N)</th></tr>
                        </thead>
                        <tbody id="feedTableBody"><tr><td><span class="val-mid">30</span><span class="val-range">20~40</span></td><td style="background:#ebf8ff;"><span class="val-mid" style="color:#2b6cb0;">20</span><span class="val-range">10~20</span></td><td style="background:#f0fff4;"><span class="val-mid" style="color:#2f855a;">10</span><span class="val-range">10~20</span></td><td><span class="val-mid">1500</span></td></tr></tbody>
                    </table>
                </div>

                 <div id="adminPanel-feed" class="admin-panel">
                    <div class="admin-hint">ä¿®æ”¹ã€Œç›´å¾‘æ¨™ç±¤ã€æœƒå³æ™‚åŒæ­¥ä¸Šæ–¹é¸å–®ã€‚</div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminFeedAdd()">ï¼‹ æ–°å¢é€²åˆ€è¦å‰‡</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th>ç›´å¾‘æ¨™ç±¤ (inch/mm)</th><th>è½‰é€Ÿ(åƒ/ç¯„)</th><th>å°å¼•å­”(åƒ/ç¯„)</th><th>äºŒæ¬¡å­”(åƒ/ç¯„)</th><th>å£½å‘½</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-feed" data-sortable-init="1"><tr draggable="true" data-idx="0">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0279&quot; ä»¥ä¸‹" oninput="adminFeedSetLabel(0,this.value)" onchange="adminFeedSetLabel(0,this.value)" onblur="adminFeedSetLabel(0,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="30" oninput="adminFeedSet(0,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~40" oninput="adminFeedSet(0,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="20" oninput="adminFeedSet(0,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(0,'pF',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(0,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(0,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(0,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(0)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="1">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0280&quot;~0.0429&quot;" oninput="adminFeedSetLabel(1,this.value)" onchange="adminFeedSetLabel(1,this.value)" onblur="adminFeedSetLabel(1,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="30" oninput="adminFeedSet(1,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~40" oninput="adminFeedSet(1,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="30" oninput="adminFeedSet(1,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~30" oninput="adminFeedSet(1,'pF',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(1,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(1,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(1,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(1)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="2">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0430&quot;~0.0865&quot;" oninput="adminFeedSetLabel(2,this.value)" onchange="adminFeedSetLabel(2,this.value)" onblur="adminFeedSetLabel(2,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="30" oninput="adminFeedSet(2,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~40" oninput="adminFeedSet(2,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="40" oninput="adminFeedSet(2,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~40" oninput="adminFeedSet(2,'pF',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(2,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(2,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(2,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(2)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="3">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.0866&quot;~0.1014&quot;" oninput="adminFeedSetLabel(3,this.value)" onchange="adminFeedSetLabel(3,this.value)" onblur="adminFeedSetLabel(3,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="25" oninput="adminFeedSet(3,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~35" oninput="adminFeedSet(3,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="50" oninput="adminFeedSet(3,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~50" oninput="adminFeedSet(3,'pF',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(3,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(3,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(3,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(3)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="4">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.1015&quot;~0.1259&quot;" oninput="adminFeedSetLabel(4,this.value)" onchange="adminFeedSetLabel(4,this.value)" onblur="adminFeedSetLabel(4,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="25" oninput="adminFeedSet(4,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~35" oninput="adminFeedSet(4,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="40" oninput="adminFeedSet(4,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~40" oninput="adminFeedSet(4,'pF',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(4,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(4,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(4,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(4)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="5">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.1260&quot;~0.1456&quot;" oninput="adminFeedSetLabel(5,this.value)" onchange="adminFeedSetLabel(5,this.value)" onblur="adminFeedSetLabel(5,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="20" oninput="adminFeedSet(5,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="15~25" oninput="adminFeedSet(5,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="20" oninput="adminFeedSet(5,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(5,'pF',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(5,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(5,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(5,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(5)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="6">
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="0.1457&quot; ä»¥ä¸Š" oninput="adminFeedSetLabel(6,this.value)" onchange="adminFeedSetLabel(6,this.value)" onblur="adminFeedSetLabel(6,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="20" oninput="adminFeedSet(6,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="15~25" oninput="adminFeedSet(6,'s',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(6,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~15" oninput="adminFeedSet(6,'pF',1,this.value)"></td>
                <td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(6,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(6,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(6,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(6)">åˆª</button></td>
            </tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-life" class="content-section">
            <div class="card">
                <div class="query-row">
                    <div class="input-box">
                        <label>1. é¸æ“‡ç›´å¾‘ inch (mm)</label>
                        <select id="lifeSizeSel" onchange="updateLifeTypeList()"><option value="0.0197&quot; (0.500mm)">0.0197" (0.500mm)</option><option value="0.0236&quot; (0.600mm)">0.0236" (0.600mm)</option><option value="0.031&quot; (0.800mm)">0.031" (0.800mm)</option><option value="0.031&quot; é€†è½‰åˆ€ (0.800mm)">0.031" é€†è½‰åˆ€ (0.800mm)</option><option value="0.035&quot; (0.900mm)">0.035" (0.900mm)</option><option value="0.039&quot; (1.000mm)">0.039" (1.000mm)</option><option value="0.039&quot; é€†è½‰åˆ€ (1.000mm)">0.039" é€†è½‰åˆ€ (1.000mm)</option><option value="0.043&quot; (1.100mm)">0.043" (1.100mm)</option><option value="0.047&quot; (1.200mm)">0.047" (1.200mm)</option><option value="0.051&quot;(1.300)">0.051"(1.300)</option><option value="0.055&quot;(1.400)">0.055"(1.400)</option><option value="0.059&quot;(1.500)">0.059"(1.500)</option><option value="0.062&quot;(1.600)">0.062"(1.600)</option><option value="0.067&quot;(1.700)">0.067"(1.700)</option><option value="0.069&quot;(1.750)">0.069"(1.750)</option><option value="0.071&quot;(1.800)">0.071"(1.800)</option><option value="0.075&quot;(1.900)">0.075"(1.900)</option><option value="0.079&quot;(2.000) (å…§æ§½)">0.079"(2.000) (å…§æ§½)</option><option value="0.079&quot;(2.000) (å¤–å‹)">0.079"(2.000) (å¤–å‹)</option><option value="0.093&quot;(2.380) (å…§æ§½)">0.093"(2.380) (å…§æ§½)</option><option value="0.093&quot;(2.380) (å¤–å‹)">0.093"(2.380) (å¤–å‹)</option><option value="0.098&quot;(2.500) (å…§æ§½)">0.098"(2.500) (å…§æ§½)</option></select>
                        <button type="button" class="picker-btn mobile-only" id="lifeSizeBtn" onclick="openPicker('lifeSizeSel','é¸æ“‡ç›´å¾‘')">0.0197" (0.500mm)</button>
                    </div>
                    <div class="input-box">
                        <label>2. é¸æ“‡å‹æ…‹</label>
                        <select id="lifeTypeSel" onchange="runLifeQuery()"><option value="éè†œåˆ€">éè†œåˆ€</option><option value="ä¸€èˆ¬åˆ€">ä¸€èˆ¬åˆ€</option></select>
                        <button type="button" class="picker-btn mobile-only" id="lifeTypeBtn" onclick="openPicker('lifeTypeSel','é¸æ“‡å‹æ…‹')">éè†œåˆ€</button>
                    </div>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr><th style="width:50%;">æ™®é€šæè³ª</th><th style="background:#fff7ed; color:#c2410c; border-bottom: 2px solid #fdba74;">å…¶ä»–æè³ª</th></tr>
                        </thead>
                        <tbody id="lifeTableBody"><tr>
            <td><span class="val-mid">150</span><span class="val-range">100~150</span></td>
            <td style="background:#fff7ed;"><span class="val-mid" style="color:#c2410c;">150</span><span class="val-range">100~150</span></td>
        </tr></tbody>
                    </table>
                </div>

                <div id="adminPanel-life" class="admin-panel">
                    <div class="admin-hint">é»æ“Šã€Œâ‡… èª¿æ•´ç›´å¾‘é †åºã€å¯ç›´è§€èª¿æ•´ä¸‹æ‹‰é¸å–®çš„é †åºã€‚</div>
                    <div class="admin-actions-row">
                        <button type="button" class="btn btn-primary" onclick="adminLifeAddSize()">ï¼‹ æ–°å¢ç›´å¾‘</button>
                        <button type="button" class="btn btn-danger" onclick="adminLifeDeleteSize()">åˆªé™¤ç›®å‰ç›´å¾‘</button>
                        <button type="button" class="btn btn-warning" onclick="adminLifeRenameSize()">âœ ä¿®æ”¹ç›´å¾‘åç¨±</button>
                        <button type="button" class="btn btn-ghost" onclick="adminLifeOpenReorder()">â‡… èª¿æ•´ç›´å¾‘é †åº</button>
                        <button type="button" class="btn btn-ghost" onclick="adminLifeAddType()">ï¼‹ æ–°å¢å‹æ…‹</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:20px;"></th><th>å‹æ…‹</th><th>æ™®é€š-ä¸­å€¼</th><th>æ™®é€š-ç¯„åœ</th><th>å…¶ä»–æè³ª-ä¸­å€¼</th><th>å…¶ä»–æè³ª-ç¯„åœ</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-life" data-sortable-init="1"><tr draggable="true" data-key="éè†œåˆ€"><td class="drag-handle">â˜°</td><td style="font-weight: bold;">éè†œåˆ€</td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><button class="btn btn-danger">åˆªé™¤</button></td></tr><tr draggable="true" data-key="ä¸€èˆ¬åˆ€"><td class="drag-handle">â˜°</td><td style="font-weight: bold;">ä¸€èˆ¬åˆ€</td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><button class="btn btn-danger">åˆªé™¤</button></td></tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-note" class="content-section">
            <div class="card">
                <ul class="note-list"><li><b>1.</b> HITGã€LKã€RFã€HFã€EM390åŠEM526æè³ªçš„å„åˆ‡åˆ€åŠå°å¼•å­”ä¸‹é‘½é€Ÿåº¦ 5~10 (ç²—åˆ‡ã€ç²—åˆ‡å°å¼•å­”åŠå¤–å‹é™¤å¤–)ã€‚</li><li><b>2.</b> åˆ‡å…§æ§½ç‚ºéŠ…é¢ï¼šåˆ‡åˆ€ 31~59 mil å£½å‘½ç”¨ 50 INCHï¼›62~93 mil å£½å‘½ç”¨ 100 INCHã€‚</li><li><b>3.</b> è—åœ–æ¨™ç¤º â—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰èµ° G42ï¼Œåˆ‡åˆ€è¦æ ¼å£½å‘½è¦å®šè«‹ä¾åˆ—è¡¨å°ç…§ã€‚</li><li><b>4.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€ 31~51 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ ~50 INCHï¼Œå°é¢é€Ÿåº¦ 10~30ã€‚</li><li><b>5.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€ 55~93 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ ~180 INCHï¼Œå°é¢é€Ÿåº¦ 10~50 (M57è–„æ¿ç‚º20)ã€‚</li><li><b>6.</b> æ¸…ç²‰åˆ‡åˆ€ 31~51 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ï¼Œå°é¢é€Ÿåº¦ 30ã€‚</li><li><b>7.</b> æ¸…ç²‰åˆ‡åˆ€ 55~93 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ï¼Œå°é¢é€Ÿåº¦ 50 (M57è–„æ¿ç‚º20)ã€‚</li><li><b>8.</b> H30æ–™è™Ÿã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€ï¼š62 mil å£½å‘½è¨­ 200 INCHï¼›79 mil å£½å‘½è¨­ 200 INCHã€‚</li><li><b>9.</b> C66æ–™è™Ÿå¤–å‹ 62 mil åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š 300 INCHã€‚</li><li><b>10.</b> 39~47 mil è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„ 35 mil åˆ‡åˆ€ (éœ€æ”¹ç‚º 35 mil åƒæ•¸)ã€‚</li><li><b>11.</b> C81ã€C91æ–™è™Ÿ 39 milã€47 mil é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š 300 INCHã€‚</li></ul> <div id="adminPanel-note" class="admin-panel">
                    <div class="admin-hint">å‚™è¨»äº‹é …ç®¡ç†ï¼Œå¯æ‹–æ›³æ’åºã€‚</div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminNoteAdd()">ï¼‹ æ–°å¢ä¸€è¡Œ</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th style="width:50px;">åºè™Ÿ</th><th>å…§å®¹</th><th style="width:60px;">æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-note" data-sortable-init="1"><tr draggable="true" data-idx="0">
                <td class="drag-handle">â˜°</td>
                <td>1</td>
                <td><input class="admin-input" value="HITGã€LKã€RFã€HFã€EM390åŠEM526æè³ªçš„å„åˆ‡åˆ€åŠå°å¼•å­”ä¸‹é‘½é€Ÿåº¦ 5~10 (ç²—åˆ‡ã€ç²—åˆ‡å°å¼•å­”åŠå¤–å‹é™¤å¤–)ã€‚" oninput="adminNoteSet(0,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(0)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="1">
                <td class="drag-handle">â˜°</td>
                <td>2</td>
                <td><input class="admin-input" value="åˆ‡å…§æ§½ç‚ºéŠ…é¢ï¼šåˆ‡åˆ€ 31~59 mil å£½å‘½ç”¨ 50 INCHï¼›62~93 mil å£½å‘½ç”¨ 100 INCHã€‚" oninput="adminNoteSet(1,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(1)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="2">
                <td class="drag-handle">â˜°</td>
                <td>3</td>
                <td><input class="admin-input" value="è—åœ–æ¨™ç¤º â—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰èµ° G42ï¼Œåˆ‡åˆ€è¦æ ¼å£½å‘½è¦å®šè«‹ä¾åˆ—è¡¨å°ç…§ã€‚" oninput="adminNoteSet(2,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(2)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="3">
                <td class="drag-handle">â˜°</td>
                <td>4</td>
                <td><input class="admin-input" value="ç²—ã€è£åˆ‡åˆ‡åˆ€ 31~51 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ ~50 INCHï¼Œå°é¢é€Ÿåº¦ 10~30ã€‚" oninput="adminNoteSet(3,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(3)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="4">
                <td class="drag-handle">â˜°</td>
                <td>5</td>
                <td><input class="admin-input" value="ç²—ã€è£åˆ‡åˆ‡åˆ€ 55~93 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ ~180 INCHï¼Œå°é¢é€Ÿåº¦ 10~50 (M57è–„æ¿ç‚º20)ã€‚" oninput="adminNoteSet(4,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(4)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="5">
                <td class="drag-handle">â˜°</td>
                <td>6</td>
                <td><input class="admin-input" value="æ¸…ç²‰åˆ‡åˆ€ 31~51 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ï¼Œå°é¢é€Ÿåº¦ 30ã€‚" oninput="adminNoteSet(5,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(5)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="6">
                <td class="drag-handle">â˜°</td>
                <td>7</td>
                <td><input class="admin-input" value="æ¸…ç²‰åˆ‡åˆ€ 55~93 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ï¼Œå°é¢é€Ÿåº¦ 50 (M57è–„æ¿ç‚º20)ã€‚" oninput="adminNoteSet(6,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(6)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="7">
                <td class="drag-handle">â˜°</td>
                <td>8</td>
                <td><input class="admin-input" value="H30æ–™è™Ÿã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€ï¼š62 mil å£½å‘½è¨­ 200 INCHï¼›79 mil å£½å‘½è¨­ 200 INCHã€‚" oninput="adminNoteSet(7,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(7)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="8">
                <td class="drag-handle">â˜°</td>
                <td>9</td>
                <td><input class="admin-input" value="C66æ–™è™Ÿå¤–å‹ 62 mil åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š 300 INCHã€‚" oninput="adminNoteSet(8,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(8)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="9">
                <td class="drag-handle">â˜°</td>
                <td>10</td>
                <td><input class="admin-input" value="39~47 mil è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„ 35 mil åˆ‡åˆ€ (éœ€æ”¹ç‚º 35 mil åƒæ•¸)ã€‚" oninput="adminNoteSet(9,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(9)">åˆª</button></td>
            </tr><tr draggable="true" data-idx="10">
                <td class="drag-handle">â˜°</td>
                <td>11</td>
                <td><input class="admin-input" value="C81ã€C91æ–™è™Ÿ 39 milã€47 mil é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š 300 INCHã€‚" oninput="adminNoteSet(10,this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(10)">åˆª</button></td>
            </tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>


    <div id="pickerModal" class="picker-modal hidden" role="dialog"><div class="picker-sheet"><div class="picker-header"><div id="pickerTitle" class="picker-title">é¸æ“‡</div><button type="button" class="picker-close" onclick="closePicker()">é—œé–‰</button></div><div id="pickerList" class="picker-list"></div></div></div>
    
    <div class="admin-modal-backdrop" id="adminModalBackdrop" role="dialog" style="display: none;"><div class="admin-modal"><header><h4 style="margin:0;font-size:16px;">é€²éšç·¨è¼¯ï¼ˆJSONï¼‰</h4><button class="btn btn-ghost" onclick="closeAdminModal()">é—œé–‰</button></header><div class="body"><div class="admin-hint">å¯åœ¨æ­¤å‚™ä»½æˆ–é‚„åŸæ‰€æœ‰è¨­å®šã€‚</div><div class="admin-field"><textarea id="adminJson" spellcheck="false"></textarea></div></div><div class="admin-actions"><button class="btn btn-primary" onclick="applyJsonChanges()">å¥—ç”¨</button></div></div></div>

    <div class="admin-modal-backdrop" id="reorderModal" role="dialog" style="z-index: 5001;">
        <div class="admin-modal" style="width: 450px; max-width: 90%; max-height: 80vh;">
            <header>
                <h4 style="margin:0;font-size:16px;">èª¿æ•´ç›´å¾‘é †åº</h4>
                <button class="btn btn-ghost" onclick="document.getElementById('reorderModal').style.display='none'">å–æ¶ˆ</button>
            </header>
            <div class="body">
                <div class="admin-hint">æ‹–æ›³ã€Œâ˜°ã€å³å¯èª¿æ•´é †åºï¼Œå®Œæˆå¾Œè«‹æŒ‰ã€Œä¿å­˜é †åºã€ã€‚</div>
                <div class="admin-table-wrap" style="max-height: 50vh; overflow-y: auto;">
                    <table class="admin-table">
                        <tbody id="reorderTbody"></tbody>
                    </table>
                </div>
            </div>
            <div class="admin-actions">
                <button class="btn btn-primary" onclick="adminLifeSaveOrder()">ä¿å­˜é †åº</button>
            </div>
        </div>
    </div>

<script>

// --- HTML escape for attribute values (prevent " in labels breaking input value) ---
function escAttr(v){
    return String(v ?? "").replace(/&/g,"&amp;")
        .replace(/</g,"&lt;")
        .replace(/>/g,"&gt;")
        .replace(/\"/g,"&quot;")
        .replace(/'/g,"&#39;");
}

    const colorMap = { "åœŸé»ƒè‰²":"#D4A017", "è˜‹æœç¶ ":"#8DB600", "é†¬ç´…è‰²":"#800000", "é»‘è‰²":"#000000", "æ·±è—è‰²":"#00008B", "å’–å•¡è‰²":"#6F4E37", "é’è‰²":"#00CED1", "æŸ‘ç´…è‰²":"#FF4500", "æ·¡ç´«è‰²":"#E6E6FA", "å¢¨ç¶ è‰²":"#006400", "ç²‰ç´…è‰²":"#FF69B4", "ç™½è‰²":"#C0C0C0", "æ£•ç´…è‰²":"#A52A2A", "æ·¡æ¢¨è‰²":"#F0EAD6", "æ·±ç´«è‰²":"#800080", "æ·¡æ©˜è‰²":"#FFB84D", "å¡å…¶è‰²":"#F0E68C", "æ·¡è—è‰²":"#ADD8E6", "ç°è‰²":"#808080", "å‡é»ƒè‰²":"#F0E68C", "èƒ­è„‚ç´…":"#C71585", "å¤©è—è‰²":"#87CEEB", "æ¡ƒç´…è‰²":"#FF69B4", "å¤§ç´…è‰²":"#FF0000", "æ¾æ¨¹ç¶ ":"#01796F" , "æ©„æ¬–ç¶ ":"#6B8E23", "æ©„æ¬–è‰²":"#6B8E23"};

    // --- Auto color (Scheme C) + overrides ---
    // ä»¥ã€Œåç¨±ã€ç‚ºä¸»ï¼šè‹¥ colorMap / colorOverrides ç„¡å°æ‡‰ï¼Œå°‡ä»¥åç¨±è‡ªå‹•ç”Ÿæˆç©©å®šè‰²ç¢¼ã€‚
    // å…è¨±å¾ŒçºŒæ‰‹å‹•èª¿æ•´è‰²ç¢¼(override)ï¼Œè§£æ±ºã€æ©„æ¬–ç¶ é¡¯ç¤ºä¸ç¬¦åˆèªçŸ¥ã€ç­‰å•é¡Œã€‚
    let colorOverrides = {"ç™½è‰²":"#FFFFFF"};

    function _hslToHex(h, s, l){
        s/=100; l/=100;
        const k = n => (n + h/30) % 12;
        const a = s * Math.min(l, 1-l);
        const f = n => l - a * Math.max(-1, Math.min(k(n)-3, Math.min(9-k(n), 1)));
        const toHex = x => Math.round(255*x).toString(16).padStart(2,'0');
        return '#' + toHex(f(0)) + toHex(f(8)) + toHex(f(4));
    }

    function _autoColorHexFromName(name){
        const str = String(name || '').trim();
        if(!str) return '#eeeeee';
        let hash = 5381;
        for (let i=0;i<str.length;i++){
            hash = ((hash << 5) + hash) + str.charCodeAt(i);
            hash = hash >>> 0;
        }
        const hue = hash % 360;
        // å›ºå®šé£½å’Œ/æ˜åº¦ï¼Œé¿å…å¤ªç°æˆ–å¤ªäº®
        return _hslToHex(hue, 55, 45);
    }

    function getColorHex(colorName){
        const n = String(colorName || '').trim();
        if(!n) return '#eeeeee';
        // override å„ªå…ˆ
        if(colorOverrides && colorOverrides[n]) return colorOverrides[n];
        if(colorMap && colorMap[n]) return colorMap[n];
        return _autoColorHexFromName(n);
    }

    function setColorOverride(colorName, hex){
        const n = String(colorName || '').trim();
        if(!n) return;
        const h = String(hex || '').trim();
        if(!/^#[0-9a-fA-F]{6}$/.test(h)) { alert('è‰²ç¢¼æ ¼å¼éŒ¯èª¤ï¼Œè«‹ä½¿ç”¨ #RRGGBB'); return; }
        if(!colorOverrides) colorOverrides = {};
        colorOverrides[n] = h.toUpperCase();
        // ç«‹å³åˆ·æ–°é¡è‰²é¡¯ç¤º
        try{ runFineQuery(); }catch(e){}
        try{ adminFineRefresh(); }catch(e){}
    }

    let typeDefs = [{"group":"ä¸»è¦å·¥åº","options":[{"v":"FF","t":"ç²—åˆ‡ (FF)"},{"v":"AA","t":"ç²—åˆ‡ (AA) æ¸…ç²‰"},{"v":"RD","t":"å…§æ§½ (RD)ã€é˜»æŠ—æ¢ (CP)"},{"v":"G42","t":"å°é–‰æ§½ã€äºŒæ¬¡å­”ã€è€³æœµæ§½ã€è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ (G42)"},{"v":"OR","t":"å¤–å‹ (OR)ã€è£é–‹ (HA)"}]},{"group":"ç‰¹æ®Šå·¥åº","options":[{"v":"RDL","t":"å…§æ§½ (RDL) é€†è½‰åˆ€"},{"v":"DA","t":"å°å¼•å­” (DA)"},{"v":"DAFF","t":"ç²—åˆ‡å°å¼•å­” (DA FF)"}]}];

    let toolData = {"å°æ–¼0.0280(ä¸å«)":{"DAFF":["30","20","1500","--","--"]},"å°æ–¼0.1260(ä¸å«)":{"DA":["30","10","1500","--","--"],"DAFF":["30","30","1500","--","--"]},"å¤§æ–¼0.1260(å«)":{"DA":["20","10","1500","--","--"],"DAFF":["20","10","1500","--","--"]},"0.0197":{"FF":["40","10","50","0.0098","10"],"AA":["40","10","50","0.0098","10"],"RD":["40","10","50","0.0098","8"],"G42":["40","7","30","0.0098","8"],"OR":["40","10","50","0.0103","10"]},"0.0197 CB":{"FF":["40","10","150","0.0098","10"],"AA":["40","10","150","0.0098","10"],"RD":["40","10","150","0.0098","8"],"G42":["40","7","75","0.0098","8"],"OR":["40","10","150","0.0103","10"]},"0.0236":{"FF":["40","10","50","0.0118","10"],"AA":["40","10","50","0.0118","10"],"RD":["40","10","50","0.0118","8"],"G42":["40","7","30","0.0118","8"],"OR":["40","10","50","0.0123","10"]},"0.0236 CB":{"FF":["40","10","150","0.0118","10"],"AA":["40","10","150","0.0118","10"],"RD":["40","10","150","0.0118","8"],"G42":["40","7","75","0.0118","8"],"OR":["40","10","150","0.0123","10"]},"0.031":{"FF":["33","12","100","0.0155","12"],"AA":["30","20","300","0.0155","30"],"RD":["30","10","90","0.0155","10"],"G42":["33","10","50","0.0155","10"],"OR":["30","12","90","0.0160","10"],"RDL":["-30","10","90","0.0155","10"]},"0.035":{"FF":["33","12","100","0.0175","12"],"AA":["30","20","300","0.0175","30"],"RD":["30","10","90","0.0175","10"],"G42":["33","10","50","0.0175","10"],"OR":["30","12","90","0.0180","10"]},"0.039":{"FF":["33","12","200","0.0195","12"],"AA":["30","20","300","0.0195","30"],"RD":["30","10","200","0.0195","10"],"G42":["32","10","50","0.0195","10"],"OR":["30","12","200","0.0200","10"],"RDL":["-30","10","160","0.0195","10"]},"0.039 CB":{"FF":["33","12","700","0.0195","12"],"AA":["30","20","700","0.0195","30"],"RD":["30","10","700","0.0195","10"],"G42":["32","10","150","0.0195","10"],"OR":["30","12","700","0.0200","10"]},"0.039 LCB":{"FF":["33","12","300","0.0195","12"],"AA":["30","20","300","0.0195","30"],"RD":["30","10","300","0.0195","10"],"G42":["32","10","300","0.0195","10"],"OR":["30","12","300","0.0200","10"]},"0.047":{"FF":["32","12","200","0.0235","12"],"AA":["30","30","370","0.0235","30"],"RD":["30","10","200","0.0235","10"],"G42":["32","10","80","0.0235","10"],"OR":["30","15","200","0.0240","10"]},"0.047 LCB":{"FF":["32","12","300","0.0235","12"],"AA":["30","30","300","0.0235","30"],"RD":["30","10","300","0.0235","10"],"G42":["32","10","300","0.0235","10"],"OR":["30","15","300","0.0240","10"]},"0.055":{"FF":["32","15","420","0.0275","50"],"AA":["30","35","420","0.0275","50"],"RD":["30","10","200","0.0275","10"],"G42":["30","10","80","0.0275","10"],"OR":["30","15","200","0.0280","10"]},"0.059":{"FF":["32","20","420","0.0295","50"],"AA":["30","35","420","0.0295","50"],"RD":["28","10","250","0.0295","10"],"G42":["30","10","80","0.0295","10"],"OR":["30","20","250","0.0302","10"]},"0.062":{"FF":["32","30","520","0.0315","50"],"AA":["28","40","520","0.0315","50"],"RD":["23","5","350","0.0315","10"],"G42":["28","5","100","0.0315","10"],"OR":["28","30","350","0.0322","10"]},"0.079":{"FF":["32","30","700","0.0395","50"],"AA":["28","40","700","0.0395","50"],"RD":["22","5","400","0.0395","10"],"G42":["28","5","100","0.0395","10"],"OR":["28","30","400","0.0405","10"]},"0.093":{"FF":["32","30","1020","0.0465","50"],"AA":["28","40","1020","0.0465","50"],"RD":["22","5","400","0.0465","10"],"G42":["25","5","100","0.0465","10"],"OR":["28","30","800","0.0485","10"]}};

    // Modified structure: options is now an Array of objects to preserve order
    let stackingRules = {"15.7 (0.40)":{"max":"40 (1.02)","options":[{"r":"9~10","v":4},{"r":"11~13","v":3},{"r":"14~20","v":2},{"r":"21~40","v":1}]},"19.7 (0.50)":{"max":"66 (1.68)","options":[{"r":"10~16","v":4},{"r":"17~22","v":3},{"r":"23~33","v":2},{"r":"34~66","v":1}]},"19.7 LCBRD (0.50)":{"max":"86 (2.18)","options":[{"r":"10~17","v":5},{"r":"18~21","v":4},{"r":"22~28","v":3},{"r":"29~43","v":2},{"r":"44~86","v":1}]},"23.6 (0.60)":{"max":"88 (2.24)","options":[{"r":"15~22","v":4},{"r":"23~29","v":3},{"r":"30~44","v":2},{"r":"45~88","v":1}]},"23.6 LCBRD (0.60)":{"max":"108 (2.74)","options":[{"r":"15~21","v":5},{"r":"22~27","v":4},{"r":"28~36","v":3},{"r":"37~54","v":2},{"r":"55~108","v":1}]},"31~35 (0.80-0.90)":{"max":"122 (2.74)","options":[{"r":"9~12","v":10},{"r":"13","v":9},{"r":"14~15","v":8},{"r":"16~17","v":7},{"r":"18~20","v":6},{"r":"21~24","v":5},{"r":"25~30","v":4},{"r":"31~40","v":3},{"r":"41~61","v":2},{"r":"62~122","v":1}]},"35 LRD (0.90)":{"max":"170 (4.32)","options":[{"r":"15~21","v":8},{"r":"22~24","v":7},{"r":"25~28","v":6},{"r":"29~34","v":5},{"r":"35~42","v":4},{"r":"43~56","v":3},{"r":"57~85","v":2}]},"39~55 (0.10-1.40)":{"max":"205 (5.21)","options":[{"r":"15~22","v":8},{"r":"23~25","v":7},{"r":"26~30","v":6},{"r":"31~37","v":5},{"r":"38~47","v":4},{"r":"48~64","v":3},{"r":"65~99","v":2}]},"59~98 (1.50-2.50)":{"max":"259 (6.6)","options":[{"r":"15~18","v":12},{"r":"19~22","v":10},{"r":"23~28","v":8},{"r":"29~33","v":7},{"r":"34~39","v":6},{"r":"40~47","v":5},{"r":"48~60","v":4},{"r":"61~81","v":3}]},"39~47 LCBRD (1.00-1.20)":{"max":"263 (6.7)","options":[{"r":"15~18","v":12},{"r":"19~22","v":10},{"r":"23~28","v":8},{"r":"29~33","v":7},{"r":"34~39","v":6},{"r":"40~47","v":5},{"r":"48~60","v":4},{"r":"61~68","v":3}]}};

    let fineCutData = [{"label":"0.0197\"(0.500) (åœŸé»ƒè‰²)","s":["40","30~45"],"f":["8","5~10"],"t":["8","5~10"],"d":["0.0098","+/-0.003\""],"color":"åœŸé»ƒè‰²"},{"label":"0.0197\" LCBRD(0.500) (è˜‹æœç¶ )","s":["45","40~55"],"f":["8","5~10"],"t":["8","5~10"],"d":["0.0098","+/-0.003\""],"color":"è˜‹æœç¶ "},{"label":"0.0236\"(0.600) (é†¬ç´…è‰²)","s":["40","30~45"],"f":["8","5~10"],"t":["8","5~10"],"d":["0.0118","+/-0.003\""],"color":"é†¬ç´…è‰²"},{"label":"0.0236\" LCBRD(0.600) (é»‘è‰²)","s":["40","30~50"],"f":["8","5~10"],"t":["8","5~10"],"d":["0.0118","+/-0.003\""],"color":"é»‘è‰²"},{"label":"0.031\"(0.800) (æ·±è—è‰²)","s":["30","25~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0155","+/-0.003\""],"color":"æ·±è—è‰²"},{"label":"0.031\" CBRD(0.800) (å’–å•¡è‰²)","s":["55","40~55"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0155","+/-0.003\""],"color":"å’–å•¡è‰²"},{"label":"0.031\" (é€†)æ¼¢å°(0.800) (é’è‰²)","s":["-30","-30"],"f":["10","5~10"],"t":["10","10~10"],"d":["0.0155","+/-0.003\""],"color":"é’è‰²"},{"label":"0.035\"(0.900) (æŸ‘ç´…è‰²)","s":["30","20~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0175","+/-0.003\""],"color":"æŸ‘ç´…è‰²"},{"label":"0.035\" LRD(0.900) (æ·¡ç´«è‰²)","s":["30","20~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0175","+/-0.003\""],"color":"æ·¡ç´«è‰²"},{"label":"0.039\"(1.000) (å¢¨ç¶ è‰²)","s":["30","25~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"å¢¨ç¶ è‰²"},{"label":"0.039\" CBRD(1.000) (ç²‰ç´…è‰²)","s":["35","25~50"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"ç²‰ç´…è‰²"},{"label":"0.039\" (é€†)å°–é»(1.000) (ç™½è‰²)","s":["-30","-25~-40"],"f":["10","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"ç™½è‰²"},{"label":"0.039\" (é€†)æ—­è²¿(1.000) (ç™½è‰²)","s":["-30","-25~-40"],"f":["10","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"ç™½è‰²"},{"label":"0.0039\" LCBRD(1.000) (æ£•ç´…è‰²)","s":["35","25~50"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"æ£•ç´…è‰²"},{"label":"0.043\"(1.100) (æ·¡æ¢¨è‰²)","s":["30","25~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0215","+/-0.003\""],"color":"æ·¡æ¢¨è‰²"},{"label":"0.047\"(1.200) (æ·±ç´«è‰²)","s":["30","20~40"],"f":["28","10~30"],"t":["20","10~25"],"d":["0.0235","+/-0.003\""],"color":"æ·±ç´«è‰²"},{"label":"0.047\"(1.200) (æ©„æ¬–ç¶ )","s":["30","20~40"],"f":["28","10~30"],"t":["20","10~25"],"d":["0.0235","+/-0.003\""],"color":"æ©„æ¬–ç¶ "},{"label":"0.047\" LCBRD(1.200)(æ·¡æ©˜è‰²)","s":["35","25~50"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0235\"","+/-0.003\""],"color":"æ·¡æ©˜è‰²"},{"label":"0.051\"(1.300)(å¡å…¶è‰²)","s":["30","20~35"],"f":["28","10~30"],"t":["20","10~25"],"d":["0.0255\"","+/-0.003\""],"color":"å¡å…¶è‰²"},{"label":"0.055\"(1.400)(æ·¡è—è‰²)","s":["30","20~35"],"f":["30","10~35"],"t":["20","10~27"],"d":["0.0275\"","+/-0.003\""],"color":"æ·¡è—è‰²"},{"label":"0.059\"(1.500)(ç°è‰²)","s":["30","20~35"],"f":["30","10~35"],"t":["20","10~27"],"d":["0.0295\"","+/-0.003\""],"color":"ç°è‰²"},{"label":"0.062\"(1.600) (å‡é»ƒè‰²)","s":["30","18~35"],"f":["35","10~40"],"t":["25","10~30"],"d":["0.0315","+/-0.003\""],"color":"å‡é»ƒè‰²"},{"label":"0.067\"(1.700)(èƒ­è„‚ç´…)","s":["30","25~35"],"f":["35","10~40"],"t":["25","10~30"],"d":["0.0335\"","+/-0.003\""],"color":"èƒ­è„‚ç´…"},{"label":"0.069\"(1.750)(è˜‹æœç¶ )","s":["30","25~35"],"f":["35","10~40"],"t":["25","10~30"],"d":["0.0345\"","+/-0.003\""],"color":"è˜‹æœç¶ "},{"label":"0.071\"(1.800)(å¤©è—è‰²)","s":["30","25~35"],"f":["35","10~40"],"t":["25","10~30"],"d":["0.0355\"","+/-0.003\""],"color":"å¤©è—è‰²"},{"label":"0.075\"(1.900)(æ¡ƒç´…è‰²)","s":["30","25~35"],"f":["35","10~40"],"t":["30","10~35"],"d":["0.0375\"","+/-0.003\""],"color":"æ¡ƒç´…è‰²"},{"label":"0.079\"(2.000)(å¤§ç´…è‰²)","s":["30","20~35"],"f":["35","10~40"],"t":["30","10~35"],"d":["0.0395\"","+/-0.003\""],"color":"å¤§ç´…è‰²"},{"label":"0.093\"(2.380)(ç™½è‰²)","s":["28","18~30"],"f":["35","10~40"],"t":["40","10~45"],"d":["0.0490\"","+/-0.003\""],"color":"ç™½è‰²"},{"label":"0.098\"(2.500) (æ¾æ¨¹ç¶ )","s":["28","18~30"],"f":["35","10~40"],"t":["40","10~45"],"d":["0.0490","+/-0.003\""],"color":"æ¾æ¨¹ç¶ "}];

    let feedData = [{"label":"0.0279\" ä»¥ä¸‹","s":["30","20~40"],"pF":["20","10~20"],"sF":["10","10~20"],"life":"1500"},{"label":"0.0280\"~0.0429\"","s":["30","20~40"],"pF":["30","10~30"],"sF":["10","10~20"],"life":"1500"},{"label":"0.0430\"~0.0865\"","s":["30","20~40"],"pF":["40","10~40"],"sF":["10","10~20"],"life":"1500"},{"label":"0.0866\"~0.1014\"","s":["25","20~35"],"pF":["50","10~50"],"sF":["10","10~20"],"life":"1500"},{"label":"0.1015\"~0.1259\"","s":["25","20~35"],"pF":["40","10~40"],"sF":["10","10~20"],"life":"1500"},{"label":"0.1260\"~0.1456\"","s":["20","15~25"],"pF":["20","10~20"],"sF":["10","10~20"],"life":"1500"},{"label":"0.1457\" ä»¥ä¸Š","s":["20","15~25"],"pF":["10","10~15"],"sF":["10","10~20"],"life":"1500"}];

    let toolLifeRules = (function(){ 
        // preserve possible Map-like keys
        return {"0.0197\" (0.500mm)":{"éè†œåˆ€":[["150","100~150"],["150","100~150"]],"ä¸€èˆ¬åˆ€":[["50","10~50"],["30","10~50"]]},"0.0236\" (0.600mm)":{"éè†œåˆ€":[["150","100~150"],["150","100~150"]],"ä¸€èˆ¬åˆ€":[["50","10~50"],["30","10~50"]]},"0.031\" (0.800mm)":{"éè†œåˆ€":[["450","300~450"],["300","250~300"]],"ä¸€èˆ¬åˆ€":[["300","260~300"],["100","60~100"]]},"0.031\" é€†è½‰åˆ€ (0.800mm)":{"ä¸€èˆ¬åˆ€":[["90","90"],["90","90"]]},"0.035\" (0.900mm)":{"ä¸€èˆ¬åˆ€":[["300","260~300"],["100","60~100"]],"é•·åˆƒåˆ€":[["300","260~300"],["100","60~100"]]},"0.039\" (1.000mm)":{"éè†œåˆ€":[["1000","700~1000"],["700","600~700"]],"ä¸€èˆ¬åˆ€":[["300","260~300"],["200","120~200"]]},"0.039\" é€†è½‰åˆ€ (1.000mm)":{"ä¸€èˆ¬åˆ€":[["160","160"],["160","160"]]},"0.043\" (1.100mm)":{"ä¸€èˆ¬åˆ€":[["300","260~300"],["100","60~100"]]},"0.047\" (1.200mm)":{"éè†œåˆ€":[["1000","700~1000"],["700","600~700"]],"ä¸€èˆ¬åˆ€":[["370","330~370"],["200","120~200"]]},"0.051\"(1.300)":{"ä¸€èˆ¬åˆ€":[["370","330~370"],["140","100~140"]]},"0.055\"(1.400)":{"ä¸€èˆ¬åˆ€":[["420","380~420"],["220","180~220"]]},"0.059\"(1.500)":{"ä¸€èˆ¬åˆ€":[["420","380~420"],["250","180~250"]]},"0.062\"(1.600)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["400","300~400"]]},"0.067\"(1.700)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]},"0.069\"(1.750)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]},"0.071\"(1.800)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]},"0.075\"(1.900)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]},"0.079\"(2.000) (å…§æ§½)":{"ä¸€èˆ¬åˆ€":[["700","580~700"],["620","400~620"]]},"0.079\"(2.000) (å¤–å‹)":{"ä¸€èˆ¬åˆ€":[["620","580~620"],["420","380~420"]]},"0.093\"(2.380) (å…§æ§½)":{"ä¸€èˆ¬åˆ€":[["620","580~620"],["420","380~420"]]},"0.093\"(2.380) (å¤–å‹)":{"ä¸€èˆ¬åˆ€":[["1020","980~1020"],["820","780~820"]]},"0.098\"(2.500) (å…§æ§½)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]}}; 
    })();

    let notesData = ["HITGã€LKã€RFã€HFã€EM390åŠEM526æè³ªçš„å„åˆ‡åˆ€åŠå°å¼•å­”ä¸‹é‘½é€Ÿåº¦ 5~10 (ç²—åˆ‡ã€ç²—åˆ‡å°å¼•å­”åŠå¤–å‹é™¤å¤–)ã€‚","åˆ‡å…§æ§½ç‚ºéŠ…é¢ï¼šåˆ‡åˆ€ 31~59 mil å£½å‘½ç”¨ 50 INCHï¼›62~93 mil å£½å‘½ç”¨ 100 INCHã€‚","è—åœ–æ¨™ç¤º â—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰èµ° G42ï¼Œåˆ‡åˆ€è¦æ ¼å£½å‘½è¦å®šè«‹ä¾åˆ—è¡¨å°ç…§ã€‚","ç²—ã€è£åˆ‡åˆ‡åˆ€ 31~51 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ ~50 INCHï¼Œå°é¢é€Ÿåº¦ 10~30ã€‚","ç²—ã€è£åˆ‡åˆ‡åˆ€ 55~93 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ ~180 INCHï¼Œå°é¢é€Ÿåº¦ 10~50 (M57è–„æ¿ç‚º20)ã€‚","æ¸…ç²‰åˆ‡åˆ€ 31~51 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ï¼Œå°é¢é€Ÿåº¦ 30ã€‚","æ¸…ç²‰åˆ‡åˆ€ 55~93 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ï¼Œå°é¢é€Ÿåº¦ 50 (M57è–„æ¿ç‚º20)ã€‚","H30æ–™è™Ÿã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€ï¼š62 mil å£½å‘½è¨­ 200 INCHï¼›79 mil å£½å‘½è¨­ 200 INCHã€‚","C66æ–™è™Ÿå¤–å‹ 62 mil åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š 300 INCHã€‚","39~47 mil è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„ 35 mil åˆ‡åˆ€ (éœ€æ”¹ç‚º 35 mil åƒæ•¸)ã€‚","C81ã€C91æ–™è™Ÿ 39 milã€47 mil é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š 300 INCHã€‚"];

    let isEditing = false;

    // --- Core Logic ---
    function setSelectOptions(selectEl, values, getLabel) {
        selectEl.innerHTML = "";
        values.forEach(v => {
            const opt = document.createElement('option');
            opt.value = String(v);
            opt.textContent = getLabel ? getLabel(v) : String(v);
            selectEl.appendChild(opt);
        });
    }

    function switchTab(id) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
        if (event && event.currentTarget) {
            event.currentTarget.classList.add('active');
            document.getElementById('currentTitle').innerText = event.currentTarget.innerText;
        }
        if (window.matchMedia('(max-width: 900px)').matches) {
            document.getElementById('sidebar').classList.add('collapsed');
        }
        document.querySelector('.main-wrapper')?.scrollTo({ top: 0, behavior: 'smooth' });

        // âœ… åˆ‡æ›é é¢æ™‚ã€Œä¸éºå¤±ä¿®æ”¹å…§å®¹ã€ï¼š
        // - ä»¥ç›®å‰è¨˜æ†¶é«”ä¸­çš„è³‡æ–™é‡æ–°åŒæ­¥å„é ä¸‹æ‹‰é¸å–®/ç•«é¢
        // - ä¸åšä»»ä½•é‡ç½®ï¼Œä¹Ÿä¸æ”¹è®Šå…¶ä»–é‚è¼¯
        try {
            if (id === 'tab-fine') {
                updateFineSel();
                runFineQuery();
            } else if (id === 'tab-feed') {
                updateFeedSel();
                runFeedQuery();
            } else if (id === 'tab-stack') {
                // åªåŒæ­¥ä¸‹æ‹‰ï¼Œä¸æ”¹å‹•è¦å‰‡å…§å®¹
                const sSel = document.getElementById('stkSizeSel');
                if (sSel) {
                    const cur = sSel.value;
                    sSel.innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
                    if (cur && stackingRules[cur]) sSel.value = cur;
                }
                updateStackThickList();
                runStackQuery();
            } else if (id === 'tab-life') {
                const sSel = document.getElementById('lifeSizeSel');
                if (sSel) {
                    const cur = sSel.value;
                    setSelectOptions(sSel, Object.keys(toolLifeRules));
                    if (cur && toolLifeRules[cur]) sSel.value = cur;
                }
                updateLifeTypeList();
                runLifeQuery();
            } else if (id === 'tab-note') {
                renderNotes();
            }
        } catch(e) { /* é¿å…å›  event/sync å°éŒ¯èª¤é€ æˆåˆ‡é å¤±æ•ˆ */ }

        // åˆ‡é é¢ä¸åˆ·æ–° Admin é¿å…ä¸­æ–·è¼¸å…¥ï¼Œè³‡æ–™å·²ç”± oninput ä¿å­˜
    }

    // --- Drag & Drop Generic Logic ---
    // Fix: prevent duplicated listeners on re-render (which caused duplicated rows/options after reorder)
    const __sortableCallbacks = window.__sortableCallbacks || (window.__sortableCallbacks = {});

    function makeSortable(tbodyId, onUpdate) {
        const tbody = document.getElementById(tbodyId);
        if (!tbody) return;
        __sortableCallbacks[tbodyId] = onUpdate;
        if (tbody.dataset.sortableInit === '1') return;
        tbody.dataset.sortableInit = '1';

        let dragSrcEl = null;

        tbody.addEventListener('dragstart', function(e) {
            dragSrcEl = e.target.closest('tr');
            if(!dragSrcEl) return;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', dragSrcEl.innerHTML);
            dragSrcEl.classList.add('dragging');
        });

        tbody.addEventListener('dragover', function(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            return false;
        });

        tbody.addEventListener('dragenter', function(e) {
            e.preventDefault();
            const tr = e.target.closest('tr');
            if (tr && tr !== dragSrcEl) {
                // simple visual feedback could go here
            }
        });

        tbody.addEventListener('drop', function(e) {
            e.stopPropagation();
            const dropTarget = e.target.closest('tr');
            if (dragSrcEl && dropTarget && dragSrcEl !== dropTarget) {
                const rect = dropTarget.getBoundingClientRect();
                const next = (e.clientY - rect.top) / (rect.bottom - rect.top) > 0.5;
                tbody.insertBefore(dragSrcEl, next ? dropTarget.nextSibling : dropTarget);
                const cb = __sortableCallbacks[tbodyId];
                if(cb) cb();
            }
            return false;
        });

        tbody.addEventListener('dragend', function(e) {
            if(dragSrcEl) dragSrcEl.classList.remove('dragging');
        });
    }

    // --- Tab 1 Logic ---
    function updateSizeList() {
        const t = document.getElementById('typeSelect').value;
        const valid = Object.keys(toolData).filter(s => toolData[s][t] !== undefined);
        const sel = document.getElementById('sizeSelect');
        const oldVal = sel.value;
        sel.innerHTML = valid.map(s => `<option value="${s}">${s}</option>`).join('');
        if(valid.includes(oldVal)) sel.value = oldVal;
        runQuery();
        syncPickerButtons(); 
        if(isEditing) adminParamRefresh(); // refresh admin table only
    }
    
    function renderTypeSelect() {
        const sel = document.getElementById('typeSelect');
        const oldVal = sel.value;
        sel.innerHTML = '';
        typeDefs.forEach(group => {
            const optgroup = document.createElement('optgroup');
            optgroup.label = group.group;
            group.options.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt.v;
                option.textContent = opt.t;
                optgroup.appendChild(option);
            });
            sel.appendChild(optgroup);
        });
        if (oldVal) sel.value = oldVal;
        if (!sel.value && sel.options.length > 0) sel.selectedIndex = 0;
        updateSizeList(); 
    }

    function adminParamAddType() {
        const groupName = prompt("è«‹è¼¸å…¥æ–°é¡å‹çš„ã€Œç¾¤çµ„åç¨±ã€ï¼ˆä¾‹å¦‚ï¼šç‰¹æ®Šå·¥åºï¼‰ï¼š", "è‡ªè¨‚å·¥åº");
        if (!groupName) return;
        const typeCode = prompt("è«‹è¼¸å…¥ã€Œé¡å‹ä»£ç¢¼ã€ï¼ˆä¾‹å¦‚ï¼šLDï¼‰ï¼š");
        if (!typeCode) return;
        let exists = false;
        typeDefs.forEach(g => { if (g.options.find(o => o.v === typeCode)) exists = true; });
        if (exists) { alert('æ­¤ä»£ç¢¼å·²å­˜åœ¨ï¼'); return; }
        const typeLabel = prompt("è«‹è¼¸å…¥ã€Œé¡å‹é¡¯ç¤ºåç¨±ã€ï¼ˆä¾‹å¦‚ï¼šé›·å°„é‘½å­” (LD)ï¼‰ï¼š", typeCode);
        if (!typeLabel) return;
        let group = typeDefs.find(g => g.group === groupName);
        if (!group) { group = { group: groupName, options: [] }; typeDefs.push(group); }
        group.options.push({ v: typeCode, t: typeLabel });
        renderTypeSelect();
        document.getElementById('typeSelect').value = typeCode;
        updateSizeList();
    }

    function adminParamRenameType() {
        const sel = document.getElementById('typeSelect');
        const code = sel.value;
        if (!code) return;
        let currentLabel = "";
        let optRef = null;
        typeDefs.forEach(g => { const opt = g.options.find(o => o.v === code); if (opt) { currentLabel = opt.t; optRef = opt; } });
        const newLabel = prompt("è«‹è¼¸å…¥æ–°çš„é¡¯ç¤ºåç¨±ï¼š", currentLabel);
        if (newLabel && newLabel !== currentLabel) {
            optRef.t = newLabel;
            renderTypeSelect();
            sel.value = code;
            syncPickerButtons();
        }
    }

    function adminParamDeleteType() {
        const sel = document.getElementById('typeSelect');
        const code = sel.value;
        if (!code) return;
        if (!confirm(`ç¢ºå®šåˆªé™¤é¡å‹ ${code} å—ï¼Ÿ`)) return;
        typeDefs.forEach((g, gIdx) => {
            const idx = g.options.findIndex(o => o.v === code);
            if (idx !== -1) { g.options.splice(idx, 1); if (g.options.length === 0) typeDefs.splice(gIdx, 1); }
        });
        renderTypeSelect();
    }

    function runQuery() {
        const s = document.getElementById('sizeSelect').value, t = document.getElementById('typeSelect').value;
        if (!s || !toolData[s] || !toolData[s][t]) {
             document.getElementById('tableBody').innerHTML = '';
             return;
        }
        const d = toolData[s][t];
        document.getElementById('tableBody').innerHTML = `<tr><td>${d[0]}</td><td>${d[1]}</td><td>${d[2]}</td><td>${d[3]}</td><td>${d[4]??'-'}</td></tr>`;
        syncPickerButtons();
    }

    // --- Tab 2 Logic (Using Array for Options) ---
    function updateStackThickList() {
        const s = document.getElementById('stkSizeSel').value;
        if(!stackingRules[s]) return;
        const optsArray = stackingRules[s].options; // Now an array
        const sel = document.getElementById('stkThickSel');
        // Render options from array to preserve order
        sel.innerHTML = optsArray.map(item => `<option value="${item.r}">${item.r}</option>`).join('');
        runStackQuery();
        syncPickerButtons();
    }
    
    function runStackQuery() {
        const s = document.getElementById('stkSizeSel').value, r = document.getElementById('stkThickSel').value;
        if(!stackingRules[s]) return;
        document.getElementById('stkResMax').innerText = stackingRules[s].max;
        // Find matching object in array
        const matchedOption = stackingRules[s].options.find(item => item.r === r);
        const val = matchedOption ? matchedOption.v : '--';
        document.getElementById('stkResCount').innerText = val + " ç‰‡";
        syncPickerButtons();
    }

    // --- Tab 3 Logic ---
    function runFineQuery() {
        const i = document.getElementById('fineSizeSel').value, d = fineCutData[i], b = document.getElementById('fineBadge');
        if(!d) return;
        b.innerText = d.color; b.style.backgroundColor = getColorHex(d.color);
        document.getElementById('fineTableBody').innerHTML = `<tr><td><span class="val-mid">${d.s[0]}</span><span class="val-range">${d.s[1]}</span></td><td><span class="val-mid">${d.f[0]}</span><span class="val-range">${d.f[1]}</span></td><td><span class="val-mid">${d.t[0]}</span><span class="val-range">${d.t[1]}</span></td><td><span class="val-mid">${d.d[0]}</span><span class="val-range">${d.d[1]}</span></td></tr>`;
        syncPickerButtons();
    }

    // --- Tab 4 Logic ---
    function runFeedQuery() {
        const i = document.getElementById('feedSizeSel').value, d = feedData[i];
        if(!d) return;
        document.getElementById('feedTableBody').innerHTML = `<tr><td><span class="val-mid">${d.s[0]}</span><span class="val-range">${d.s[1]}</span></td><td style="background:#ebf8ff;"><span class="val-mid" style="color:#2b6cb0;">${d.pF[0]}</span><span class="val-range">${d.pF[1]}</span></td><td style="background:#f0fff4;"><span class="val-mid" style="color:#2f855a;">${d.sF[0]}</span><span class="val-range">${d.sF[1]}</span></td><td><span class="val-mid">${d.life}</span></td></tr>`;
        syncPickerButtons();
    }

    // --- Tab 5 Logic ---
    function updateLifeTypeList() {
        const s = document.getElementById('lifeSizeSel').value;
        const tSel = document.getElementById('lifeTypeSel');
        const types = Object.keys(toolLifeRules[s] || {});
        setSelectOptions(tSel, types);
        runLifeQuery();
        syncPickerButtons();
        if(isEditing) adminLifeRefreshPanel();
    }
    function runLifeQuery() {
        const s = document.getElementById('lifeSizeSel').value, t = document.getElementById('lifeTypeSel').value;
        if (!s || !t || !toolLifeRules[s] || !toolLifeRules[s][t]) {
             document.getElementById('lifeTableBody').innerHTML = '';
             return;
        }
        const d = toolLifeRules[s][t];
        syncPickerButtons();
        document.getElementById('lifeTableBody').innerHTML = `<tr>
            <td><span class="val-mid">${d[0][0]}</span><span class="val-range">${d[0][1]}</span></td>
            <td style="background:#fff7ed;"><span class="val-mid" style="color:#c2410c;">${d[1][0]}</span><span class="val-range">${d[1][1]}</span></td>
        </tr>`;
    }

    // --- Tab 6 Logic ---
    function renderNotes(){
        const ul = document.querySelector('.note-list');
        ul.innerHTML = '';
        (notesData || []).forEach((txt, idx) => {
            const li = document.createElement('li');
            li.innerHTML = `<b>${idx+1}.</b> ${txt}`;
            ul.appendChild(li);
        });
    }

    // --- Admin Global ---
    function toggleAdmin() {
        if(!isEditing) {
            if(prompt("å¯†ç¢¼:") !== "YPD14-RT") return;
            isEditing = true;
            document.getElementById('btnAdmin').style.display = 'none';
            document.getElementById('btnExit').style.display = 'block';
            showAdminBar(true);
        } else {
            isEditing = false;
            document.getElementById('btnAdmin').style.display = 'block';
            document.getElementById('btnExit').style.display = 'none';
            showAdminBar(false);
            closeAdminModal();
        }
        document.body.classList.toggle('editing', isEditing);
        adminRefreshAll();
        runQuery(); 
    }

    function showAdminBar(show){
        document.getElementById('adminBar').style.display = show ? 'flex' : 'none';
        document.querySelectorAll('.admin-panel').forEach(p => p.classList.toggle('active', show));
    }

    function adminRefreshAll() {
        if(!isEditing) return;
        adminParamRefresh();
        adminStackRefresh();
        adminFineRefresh();
        adminFeedRefresh();
        adminLifeRefreshPanel();
        adminNoteRefresh();
    }

    // --- Admin: Tab 1 (Param) ---
    function adminParamRefresh(){
        const type = document.getElementById('typeSelect').value;
        const tbody = document.getElementById('adminBody-query');
        tbody.innerHTML = '';
        const sizes = Object.keys(toolData).filter(k => toolData[k][type]);
        sizes.forEach(size => {
            const arr = toolData[size][type];
            const tr = document.createElement('tr');
            tr.setAttribute('draggable', 'true');
            tr.dataset.key = size;
            tr.innerHTML = `
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="${size}" oninput="adminParamRename(this, '${size}')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="${arr[0]}" oninput="adminParamSet('${size}','${type}',0,this.value)"></td>
                <td><input class="admin-input" value="${arr[1]}" oninput="adminParamSet('${size}','${type}',1,this.value)"></td>
                <td><input class="admin-input" value="${arr[2]}" oninput="adminParamSet('${size}','${type}',2,this.value)"></td>
                <td><input class="admin-input" value="${arr[3]}" oninput="adminParamSet('${size}','${type}',3,this.value)"></td>
                <td><input class="admin-input" value="${arr[4]||''}" oninput="adminParamSet('${size}','${type}',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('${size}','${type}')">åˆªé™¤</button></td>
            `;
            tbody.appendChild(tr);
        });
        makeSortable('adminBody-query', adminParamReorder);
    }
    
    function adminParamReorder() {
        const tbody = document.getElementById('adminBody-query');
        const rows = [...tbody.querySelectorAll('tr')];
        const newOrderKeys = rows.map(r => r.dataset.key);
        const newToolData = {};
        const oldKeys = Object.keys(toolData);
        newOrderKeys.forEach(k => { if(toolData[k]) newToolData[k] = toolData[k]; });
        oldKeys.forEach(k => { if(!newToolData[k]) newToolData[k] = toolData[k]; });
        toolData = newToolData;
        updateSizeList(); 
    }

    function adminParamRename(input, oldKey) {
        const newKey = input.value.trim();
        if(!newKey || newKey === oldKey) return;
        if(toolData[newKey]) return;

        // è‹¥ç›®å‰ä¸‹æ‹‰é¸çš„æ˜¯è¢«æ”¹åçš„ keyï¼Œæ”¹åå¾Œè¦æŠŠé¸å–è·Ÿè‘—åˆ‡åˆ°æ–° key
        const sizeSel = document.getElementById('sizeSelect');
        const selectedBefore = sizeSel ? sizeSel.value : '';

        const newToolData = {};
        Object.keys(toolData).forEach(k => {
            if (k === oldKey) newToolData[newKey] = toolData[oldKey];
            else newToolData[k] = toolData[k];
        });
        toolData = newToolData;

        // æ›´æ–°æœ¬åˆ—å¾ŒçºŒäº‹ä»¶ç¶å®š
        input.setAttribute('oninput', `adminParamRename(this, '${newKey}')`);
        const btn = input.closest('tr').querySelector('.btn-danger');
        const type = document.getElementById('typeSelect').value;
        btn.setAttribute('onclick', `adminParamDel('${newKey}','${type}')`);
        input.closest('tr').dataset.key = newKey;

        // âœ… ç«‹åˆ»åŒæ­¥ä¸Šæ–¹é¸å–®ï¼ˆé¿å…ä½ çœ‹åˆ°ã€Œé¸é …æ²’è·Ÿè‘—è®Šã€ï¼‰
        // updateSizeList() æœƒé‡å»ºé¸å–®ä¸¦ runQuery()
        updateSizeList();
        if(sizeSel && selectedBefore === oldKey) {
            sizeSel.value = newKey;
            runQuery();
        }
    }


    function adminParamSet(s,t,idx,val){ toolData[s][t][idx] = val; } 
    
    function adminParamAddSize(){
        const s = prompt("è«‹è¼¸å…¥å°ºå¯¸ Key (ä¾‹å¦‚ 0.055):");
        if(!s) return;
        const t = document.getElementById('typeSelect').value;
        if(!toolData[s]) toolData[s] = {};
        if(toolData[s][t]) { alert('å·²å­˜åœ¨'); return; }
        toolData[s][t] = ["0","0","0","0","0"];
        updateSizeList();
    }
    function adminParamDel(s,t){
        if(!confirm(`ç¢ºå®šåˆªé™¤ ${s} çš„ ${t} æ•¸æ“šå—ï¼Ÿ`)) return;
        delete toolData[s][t];
        updateSizeList();
    }

    // --- Admin: Tab 2 (Stack) - Array-Based Order Preservation ---
    function adminStackRefresh(){
        const tbody = document.getElementById('adminBody-stack');
        tbody.innerHTML = '';
        Object.keys(stackingRules).forEach(key => {
            const rule = stackingRules[key];
            // Reconstruct string from Array to show in input
            const optStr = rule.options.map(o => `${o.r}:${o.v}`).join(', ');
            
            const tr = document.createElement('tr');
            tr.setAttribute('draggable', 'true');
            tr.dataset.key = key;
            tr.innerHTML = `
                <td class="drag-handle">â˜°</td>
                <td><input class="admin-input" value="${key}" oninput="adminStackRename(this, '${key}')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="${rule.max}" oninput="adminStackSetMax('${key}',this.value)"></td>
                <td><input class="admin-input" value="${optStr}" oninput="adminStackSetOpt('${key}',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('${key}')">åˆªé™¤</button></td>
            `;
            tbody.appendChild(tr);
        });
        makeSortable('adminBody-stack', adminStackReorder);
    }
    
    function adminStackReorder(){
        const tbody = document.getElementById('adminBody-stack');
        const rows = [...tbody.querySelectorAll('tr')];
        const newRules = {};
        rows.forEach(r => { const k = r.dataset.key; if(stackingRules[k]) newRules[k] = stackingRules[k]; });
        stackingRules = newRules;
        document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
    }

    function adminStackRename(input, oldKey){
        const newKey = input.value.trim();
        if(!newKey || newKey === oldKey) return;
        if(stackingRules[newKey]) return;
        const newRules = {};
        Object.keys(stackingRules).forEach(k => {
            if(k === oldKey) newRules[newKey] = stackingRules[oldKey];
            else newRules[k] = stackingRules[k];
        });
        stackingRules = newRules;
        input.setAttribute('oninput', `adminStackRename(this, '${newKey}')`);
        const btn = input.closest('tr').querySelector('.btn-danger');
        btn.setAttribute('onclick', `adminStackDel('${newKey}')`);
        input.closest('tr').dataset.key = newKey;
    }

    function adminStackSetMax(k,v){ stackingRules[k].max = v; } 
    
    // ä¿®æ­£ï¼šè¼¸å…¥å­—ä¸²ç›´æ¥è½‰ç‚ºé™£åˆ—ï¼Œç¢ºä¿é †åºèˆ‡è¼¸å…¥ä¸€è‡´
    function adminStackSetOpt(k,v){ 
        const newOptsArray = [];
        v.split(',').forEach(pair => {
            let [rng, val] = pair.split(':');
            if(rng && val) {
                newOptsArray.push({ r: rng.trim(), v: isNaN(Number(val.trim())) ? val.trim() : Number(val.trim()) });
            }
        });
        stackingRules[k].options = newOptsArray;
        updateStackThickList(); // Immediately sync dropdown
    }
    
    function adminStackAdd(){
        const k = prompt("è«‹è¼¸å…¥è¦å‰‡åç¨± (ä¾‹å¦‚ 25.0 (0.70))");
        if(!k || stackingRules[k]) return;
        stackingRules[k] = { max: "0", options: [{r:"1~10", v:1}] };
        adminStackRefresh();
        document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
    }
    function adminStackDel(k){
        if(!confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) return;
        delete stackingRules[k];
        adminStackRefresh();
        document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
    }

    // --- Admin: Tab 3 (Fine) ---
    function adminFineRefresh(){
        const tbody = document.getElementById('adminBody-fine');
        tbody.innerHTML = '';
        fineCutData.forEach((d, idx) => {
            const tr = document.createElement('tr');
            tr.setAttribute('draggable', 'true');
            tr.dataset.idx = idx;
            const cell = (field, sub, w) => `<input class="admin-input" style="width:${w||'60px'}" value="${escAttr(d[field][sub])}" oninput="adminFineSet(${idx},'${field}',${sub},this.value)">`;
            tr.innerHTML = `
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="${escAttr(d.label)}" oninput="adminFineSetLabel(${idx},this.value)" onchange="adminFineSetLabel(${idx},this.value)" onblur="adminFineSetLabel(${idx},this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;">
                    <input id="fineColorName-${idx}" class="admin-input" value="${escAttr(d.color)}" oninput="adminFineSetColor(${idx},this.value)" style="width:80px; display:inline-block; vertical-align:middle;">
                    <input id="fineColorHex-${idx}" type="color" value="${getColorHex(d.color)}" onchange="adminFineSetColorHex(${idx},this.value)" style="width:44px; height:32px; padding:0; border:none; background:transparent; vertical-align:middle; margin-left:6px;" title="èª¿æ•´è‰²ç¢¼">
                </td>
                <td>${cell('s',0)} / ${cell('s',1)}</td>
                <td>${cell('f',0)} / ${cell('f',1)}</td>
                <td>${cell('t',0)} / ${cell('t',1)}</td>
                <td>${cell('d',0)} / ${cell('d',1)}</td>
                <td><button class="btn btn-danger" onclick="adminFineDel(${idx})">åˆª</button></td>
            `;
            tbody.appendChild(tr);
        });
        makeSortable('adminBody-fine', adminFineReorder);
    }
    
    function adminFineReorder(){
        const tbody = document.getElementById('adminBody-fine');
        const rows = [...tbody.querySelectorAll('tr')];
        const newArr = [];
        rows.forEach(r => { newArr.push(fineCutData[parseInt(r.dataset.idx)]); });
        fineCutData = newArr;
        updateFineSel();
        adminFineRefresh();
    }

    function adminFineSet(i,f,s,v){ fineCutData[i][f][s] = v; }
    // ä¿®æ­£ï¼šå³æ™‚æ›´æ–°ä¸‹æ‹‰é¸å–®
    function adminFineSetLabel(i,v){ 
        fineCutData[i].label = v; 
        updateFineSel(); 
    }
    function adminFineSetColor(i,v){
        fineCutData[i].color = v;
        // live update: sync color picker and dropdown label
        const hex = getColorHex(v);
        const elHex = document.getElementById(`fineColorHex-${i}`);
        if(elHex){ try{ elHex.value = hex; }catch(e){} }
        try{ updateFineSel(); }catch(e){}
    }
    function adminFineSetColorHex(i,hex){
        const name = (fineCutData[i] && fineCutData[i].color) ? fineCutData[i].color : '';
        setColorOverride(name, hex);
    }
    function updateFineSel(){ 
        const sel = document.getElementById('fineSizeSel');
        const currentVal = sel.value; 
        sel.innerHTML = fineCutData.map((d, i) => `<option value="${i}">${d.label}</option>`).join(''); 
        if(currentVal && fineCutData[currentVal]) sel.value = currentVal;
        syncPickerButtons();
    }
    function adminFineAdd(){
        fineCutData.push({ label: "æ–°è¦å‰‡", s:["0","0"], f:["0","0"], t:["0","0"], d:["0","0"], color:"ç™½è‰²" });
        updateFineSel(); adminFineRefresh();
    }
    function adminFineDel(i){
        if(!confirm('åˆªé™¤æ­¤åˆ—ï¼Ÿ')) return;
        fineCutData.splice(i,1);
        updateFineSel(); adminFineRefresh();
    }

    // --- Admin: Tab 4 (Feed) ---
    function adminFeedRefresh(){
        const tbody = document.getElementById('adminBody-feed');
        tbody.innerHTML = '';
        feedData.forEach((d, idx) => {
            const cell = (field, sub) => `<input class="admin-input" style="width:50px" value="${escAttr(d[field][sub])}" oninput="adminFeedSet(${idx},'${field}',${sub},this.value)">`;
            const tr = document.createElement('tr');
            tr.setAttribute('draggable', 'true');
            tr.dataset.idx = idx;
            tr.innerHTML = `
                <td class="drag-handle">â˜°</td>
                <td><input type="text" inputmode="text" autocomplete="off" spellcheck="false" class="admin-input" value="${escAttr(d.label)}" oninput="adminFeedSetLabel(${idx},this.value)" onchange="adminFeedSetLabel(${idx},this.value)" onblur="adminFeedSetLabel(${idx},this.value)" style="width:120px;"></td>
                <td>${cell('s',0)} / ${cell('s',1)}</td>
                <td>${cell('pF',0)} / ${cell('pF',1)}</td>
                <td>${cell('sF',0)} / ${cell('sF',1)}</td>
                <td><input class="admin-input" value="${escAttr(d.life)}" oninput="adminFeedSetLife(${idx},this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(${idx})">åˆª</button></td>
            `;
            tbody.appendChild(tr);
        });
        makeSortable('adminBody-feed', adminFeedReorder);
    }
    
    function adminFeedReorder(){
        const tbody = document.getElementById('adminBody-feed');
        const rows = [...tbody.querySelectorAll('tr')];
        const newArr = [];
        rows.forEach(r => { newArr.push(feedData[parseInt(r.dataset.idx)]); });
        feedData = newArr;
        updateFeedSel();
        adminFeedRefresh();
    }

    function adminFeedSet(i,f,s,v){ feedData[i][f][s] = v; }
    // ä¿®æ­£ï¼šå³æ™‚æ›´æ–°ä¸‹æ‹‰é¸å–®
    function adminFeedSetLabel(i,v){ 
        feedData[i].label = v; 
        updateFeedSel(); 
    }
    function adminFeedSetLife(i,v){ feedData[i].life = v; }
    function updateFeedSel(){ 
        const sel = document.getElementById('feedSizeSel');
        const currentVal = sel.value;
        sel.innerHTML = feedData.map((d, i) => `<option value="${i}">${d.label}</option>`).join(''); 
        if(currentVal && feedData[currentVal]) sel.value = currentVal;
        syncPickerButtons();
    }
    function adminFeedAdd(){
        feedData.push({ label: "æ–°ç¯„åœ", s:["0","0"], pF:["0","0"], sF:["0","0"], life: "1500" });
        updateFeedSel(); adminFeedRefresh();
    }
    function adminFeedDel(i){
        if(!confirm('åˆªé™¤ï¼Ÿ')) return;
        feedData.splice(i,1);
        updateFeedSel(); adminFeedRefresh();
    }

    // --- Admin: Tab 5 (Life) ---
    function adminLifeRefreshPanel(){
        const tbody = document.getElementById('adminBody-life');
        if(!tbody) return;
        const sizeKey = document.getElementById('lifeSizeSel').value;
        if(!sizeKey || !toolLifeRules[sizeKey]) { tbody.innerHTML = '<tr><td colspan="7">è«‹é¸æ“‡ç›´å¾‘</td></tr>'; return; }

        // ç”¨ DOM äº‹ä»¶ç¶å®šï¼Œé¿å… sizeKey / type å…§å« " ç­‰å­—å…ƒå°è‡´ inline oninput åƒæ•¸è¢«æˆªæ–·ã€‚
        tbody.innerHTML = '';
        Object.keys(toolLifeRules[sizeKey]).forEach(typeKey => {
            const d = toolLifeRules[sizeKey][typeKey];
            const tr = document.createElement('tr');
            tr.setAttribute('draggable','true');
            tr.dataset.key = typeKey;

            const tdDrag = document.createElement('td');
            tdDrag.className = 'drag-handle';
            tdDrag.textContent = 'â˜°';

            const tdType = document.createElement('td');
            tdType.style.fontWeight = 'bold';
            tdType.textContent = typeKey;

            function mkInput(val, side, idx){
                const td = document.createElement('td');
                const inp = document.createElement('input');
                inp.className = 'admin-input';
                inp.value = val ?? '';
                inp.addEventListener('input', () => adminLifeSet(sizeKey, typeKey, side, idx, inp.value));
                td.appendChild(inp);
                return td;
            }

            const tdDel = document.createElement('td');
            const btn = document.createElement('button');
            btn.className = 'btn btn-danger';
            btn.textContent = 'åˆªé™¤';
            btn.addEventListener('click', () => adminLifeDeleteType(sizeKey, typeKey));
            tdDel.appendChild(btn);

            tr.appendChild(tdDrag);
            tr.appendChild(tdType);
            tr.appendChild(mkInput(d?.[0]?.[0], 0, 0));
            tr.appendChild(mkInput(d?.[0]?.[1], 0, 1));
            tr.appendChild(mkInput(d?.[1]?.[0], 1, 0));
            tr.appendChild(mkInput(d?.[1]?.[1], 1, 1));
            tr.appendChild(tdDel);

            tbody.appendChild(tr);
        });
        makeSortable('adminBody-life', adminLifeReorder);
    }
    
    function adminLifeReorder() {
        const sizeKey = document.getElementById('lifeSizeSel').value;
        const tbody = document.getElementById('adminBody-life');
        const rows = [...tbody.querySelectorAll('tr')];
        const newObj = {};
        rows.forEach(r => { const k = r.dataset.key; if(toolLifeRules[sizeKey][k]) newObj[k] = toolLifeRules[sizeKey][k]; });
        toolLifeRules[sizeKey] = newObj;
        updateLifeTypeList();
    }

    function adminLifeSet(s,t,side,idx,v){
        if(!toolLifeRules[s] || !toolLifeRules[s][t]) return;
        toolLifeRules[s][t][side][idx] = v;
        // åŒæ­¥ï¼šåªè¦æ­£åœ¨åŒä¸€ç›´å¾‘é é¢ï¼Œå°±åˆ·æ–°ä¸Šæ–¹é¡¯ç¤ºï¼ˆè‹¥ç›®å‰é¸åˆ°çš„å‹æ…‹å‰›å¥½æ˜¯è¢«æ”¹çš„é‚£ç­†ï¼Œç•«é¢æœƒç«‹å³æ›´æ–°ï¼‰
        const curS = document.getElementById('lifeSizeSel')?.value;
        if(curS === s){
            runLifeQuery();
            syncPickerButtons();
        }
    }
    function adminLifeAddSize(){
        const s = prompt('è¼¸å…¥æ–°ç›´å¾‘ (ä¾‹: 0.118")');
        if(!s || toolLifeRules[s]) return;
        toolLifeRules[s] = {};
        const sel = document.getElementById('lifeSizeSel');
        setSelectOptions(sel, Object.keys(toolLifeRules));
        sel.value = s;
        updateLifeTypeList();
    }
    function adminLifeDeleteSize(){
        const s = document.getElementById('lifeSizeSel').value;
        if(!confirm('åˆªé™¤ç›´å¾‘ '+s+' ?')) return;
        delete toolLifeRules[s];
        const sel = document.getElementById('lifeSizeSel');
        setSelectOptions(sel, Object.keys(toolLifeRules));
        updateLifeTypeList();
    }
    function adminLifeAddType(){
        const s = document.getElementById('lifeSizeSel').value;
        const t = prompt('è¼¸å…¥å‹æ…‹ (ä¾‹: ç‰¹æ®Šåˆ€)');
        if(!t) return;
        toolLifeRules[s][t] = [["0","0"],["0","0"]];
        adminLifeRefreshPanel();
        updateLifeTypeList();
    }
    function adminLifeDeleteType(s,t){
        if(!confirm('åˆªé™¤ '+t+' ?')) return;
        delete toolLifeRules[s][t];
        adminLifeRefreshPanel();
        updateLifeTypeList();
    }

    function adminLifeRenameSize() {
        const sel = document.getElementById('lifeSizeSel');
        const oldName = sel.value;
        if (!oldName) return;
        const newName = prompt("è«‹è¼¸å…¥æ–°çš„ç›´å¾‘åç¨±ï¼š", oldName);
        if (newName && newName !== oldName) {
            if (toolLifeRules[newName]) { alert("æ­¤ç›´å¾‘åç¨±å·²å­˜åœ¨ï¼"); return; }
            const newRules = {};
            Object.keys(toolLifeRules).forEach(k => {
                if (k === oldName) newRules[newName] = toolLifeRules[oldName];
                else newRules[k] = toolLifeRules[k];
            });
            toolLifeRules = newRules;
            setSelectOptions(sel, Object.keys(toolLifeRules));
            sel.value = newName;
            updateLifeTypeList();
            syncPickerButtons();
        }
    }

    function adminLifeOpenReorder() {
        const tbody = document.getElementById('reorderTbody');
        tbody.innerHTML = '';
        Object.keys(toolLifeRules).forEach(k => {
            const tr = document.createElement('tr');
            tr.draggable = true;
            tr.dataset.key = k;
            tr.innerHTML = `<td class="drag-handle">â˜°</td><td style="font-weight:bold; text-align:left;">${k}</td>`;
            tbody.appendChild(tr);
        });
        makeSortable('reorderTbody');
        document.getElementById('reorderModal').style.display = 'flex';
    }

    function adminLifeSaveOrder() {
        const rows = document.querySelectorAll('#reorderTbody tr');
        const newRules = {};
        rows.forEach(r => { const k = r.dataset.key; if(toolLifeRules[k]) newRules[k] = toolLifeRules[k]; });
        Object.keys(toolLifeRules).forEach(k => { if(!newRules[k]) newRules[k] = toolLifeRules[k]; });
        toolLifeRules = newRules;
        const sel = document.getElementById('lifeSizeSel');
        const currentVal = sel.value;
        setSelectOptions(sel, Object.keys(toolLifeRules));
        if(newRules[currentVal]) sel.value = currentVal;
        else if(Object.keys(newRules).length > 0) sel.value = Object.keys(newRules)[0];
        updateLifeTypeList();
        document.getElementById('reorderModal').style.display = 'none';
        alert('ç›´å¾‘é †åºå·²æ›´æ–°ï¼');
    }

    // --- Admin: Tab 6 (Note) ---
    function adminNoteRefresh(){
        const tbody = document.getElementById('adminBody-note');
        tbody.innerHTML = '';
        notesData.forEach((txt, idx) => {
            const tr = document.createElement('tr');
            tr.setAttribute('draggable', 'true');
            tr.dataset.idx = idx;
            tr.innerHTML = `
                <td class="drag-handle">â˜°</td>
                <td>${idx+1}</td>
                <td><input class="admin-input" value="${txt}" oninput="adminNoteSet(${idx},this.value)" style="width:100%;"></td>
                <td><button class="btn btn-danger" onclick="adminNoteDel(${idx})">åˆª</button></td>
            `;
            tbody.appendChild(tr);
        });
        makeSortable('adminBody-note', adminNoteReorder);
    }
    
    function adminNoteReorder(){
        const tbody = document.getElementById('adminBody-note');
        const rows = [...tbody.querySelectorAll('tr')];
        const newArr = [];
        rows.forEach(r => { newArr.push(notesData[parseInt(r.dataset.idx)]); });
        notesData = newArr;
        renderNotes();
        adminNoteRefresh();
    }

    function adminNoteSet(i,v){ notesData[i] = v; }
    function adminNoteAdd(){ notesData.push("æ–°å‚™è¨»äº‹é …"); adminNoteRefresh(); renderNotes(); }
    function adminNoteDel(i){ notesData.splice(i,1); adminNoteRefresh(); renderNotes(); }


    // --- Persistence & Utils ---
    const STORAGE_KEY = 'rt_param_bundle_v12_perfect_sync'; 
    const STORAGE_VERDATE_KEY = 'rt_param_version_date_v12';

    

    function _formatVerYMD(vd){
        // vd: 'YYYY-MM-DD' -> 'YYYYMMDD'
        return (vd||'').toString().trim().replace(/-/g,'');
    }
    function syncVersionTag(vd){
        const ymd = _formatVerYMD(vd);
        const tag = document.querySelector('.version-tag');
        if(tag && ymd) tag.textContent = 'ç‰ˆæœ¬æ—¥æœŸ: ' + ymd;
    }

function getBundle(){ return { toolData, stackingRules, fineCutData, feedData, toolLifeRules, notesData, typeDefs, colorOverrides }; }
    function setBundle(b){
        if(!b) return;
        if(b.toolData) toolData = b.toolData;
        if(b.stackingRules) stackingRules = b.stackingRules;
        if(b.fineCutData) fineCutData = b.fineCutData;
        if(b.feedData) feedData = b.feedData;
        if(b.toolLifeRules) toolLifeRules = b.toolLifeRules;
        if(b.notesData) notesData = b.notesData;
        if(b.typeDefs) typeDefs = b.typeDefs;
        if(b.colorOverrides) colorOverrides = b.colorOverrides;
    }
    function loadFromStorage(){
        try{
            const raw = localStorage.getItem(STORAGE_KEY);
            if(raw) setBundle(JSON.parse(raw));
            const vd = localStorage.getItem(STORAGE_VERDATE_KEY);
            if(vd) document.getElementById('verDate').value = vd;
            if(vd) syncVersionTag(vd);
        }catch(e){ console.warn(e); }
    }
    function saveAllChanges(){
        const vd = document.getElementById('verDate').value;
        if(!vd) { alert('è«‹å¡«å¯«æ›´æ–°ç‰ˆæœ¬æ—¥æœŸ'); return; }
        localStorage.setItem(STORAGE_KEY, JSON.stringify(getBundle()));
        localStorage.setItem(STORAGE_VERDATE_KEY, vd);
        
        syncVersionTag(vd);
alert('å·²æš«å­˜åˆ°æœ¬æ©Ÿï¼');
    }
    function openAdvancedEditor(){
        document.getElementById('adminJson').value = JSON.stringify(getBundle(), null, 2);
        document.getElementById('adminModalBackdrop').style.display = 'flex';
    }
    function closeAdminModal(){ document.getElementById('adminModalBackdrop').style.display = 'none'; }
    function applyJsonChanges(){
        try{
            setBundle(JSON.parse(document.getElementById('adminJson').value));
            renderTypeSelect();
            document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
            updateStackThickList();
            updateFineSel(); runFineQuery();
            updateFeedSel(); runFeedQuery();
            setSelectOptions(document.getElementById('lifeSizeSel'), Object.keys(toolLifeRules));
            updateLifeTypeList();
            renderNotes();
            adminRefreshAll();
            syncPickerButtons();
            closeAdminModal();
            alert('è®Šæ›´å·²å¥—ç”¨ (è«‹è¨˜å¾—ä¿å­˜)');
        }catch(e){ alert('JSON éŒ¯èª¤: '+e.message); }
    }

    function downloadUpdatedHtml() {
    const vd = document.getElementById('verDate')?.value || localStorage.getItem(STORAGE_VERDATE_KEY) || '';
    const ymd = _formatVerYMD(vd) || '20241121';

    // Clone DOM and reset to "view" default state BEFORE exporting
    const docEl = document.documentElement.cloneNode(true);

    const body = docEl.querySelector('body');
    if (body) body.classList.remove('editing');

    // Ensure exported file is still editable: keep admin UI, just reset to non-editing default
    docEl.querySelectorAll('.admin-panel').forEach(p => {
        p.classList.remove('active');
        if (p.hasAttribute('style')) p.removeAttribute('style');
    });

    const adminBar = docEl.querySelector('#adminBar');
    if (adminBar && adminBar.hasAttribute('style')) adminBar.removeAttribute('style');

    const btnAdmin = docEl.querySelector('#btnAdmin');
    if (btnAdmin) btnAdmin.style.display = 'block'; // keep original inline styles, only reset visibility
    const btnExit = docEl.querySelector('#btnExit');
    if (btnExit) btnExit.style.display = 'none'; // keep original inline styles, only reset visibility

    // Sync sidebar version tag in exported HTML
    const tag = docEl.querySelector('.version-tag');
    if (tag) tag.textContent = 'ç‰ˆæœ¬æ—¥æœŸ: ' + ymd;

    let html = "<!DOCTYPE html>\n" + docEl.outerHTML;

    // Replace data blocks with the latest in-memory data
    html = html.replace(/let toolData = \{[\s\S]*?\};/, `let toolData = ${JSON.stringify(toolData)};`);
    html = html.replace(/let typeDefs = \[[\s\S]*?\];/, `let typeDefs = ${JSON.stringify(typeDefs)};`);
    html = html.replace(/let stackingRules = \{[\s\S]*?\};/, `let stackingRules = ${JSON.stringify(stackingRules)};`);
    html = html.replace(/let fineCutData = \[[\s\S]*?\];/, `let fineCutData = ${JSON.stringify(fineCutData)};`);
    html = html.replace(/let feedData = \[[\s\S]*?\];/, `let feedData = ${JSON.stringify(feedData)};`);
    html = html.replace(/let toolLifeRules = \{[\s\S]*?\};/, `let toolLifeRules = (function(){ 
        // preserve possible Map-like keys
        return ${JSON.stringify(toolLifeRules)}; 
    })();`);
    html = html.replace(/let notesData = \[[\s\S]*?\];/, `let notesData = ${JSON.stringify(notesData)};`);
    html = html.replace(/let colorOverrides = \{[\s\S]*?\};/, `let colorOverrides = ${JSON.stringify(colorOverrides)};`);

    // Safety net for any hardcoded version tag text
    html = html.replace(/(<div class="version-tag">ç‰ˆæœ¬æ—¥æœŸ:\s*)\d{8}(\s*<\/div>)/, `$1${ymd}$2`);

    const blob = new Blob([html], { type: 'text/html' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `RT_Param_Table_v${vd ? vd : new Date().toISOString().split('T')[0]}.html`;
    a.click();
}

    let _pickerSelectId = null;
    function syncPickerButtons() {
        const ids = ['typeSelect', 'sizeSelect', 'stkSizeSel', 'stkThickSel', 'fineSizeSel', 'feedSizeSel', 'lifeSizeSel', 'lifeTypeSel'];
        ids.forEach(id => {
            const sel = document.getElementById(id);
            const btn = document.getElementById(id + 'Btn') || (id === 'lifeSizeSel' ? document.getElementById('lifeSizeBtn') : document.getElementById('lifeTypeBtn'));
            
            if (sel && btn) {
                btn.textContent = sel.options[sel.selectedIndex]?.textContent || 'è«‹é¸æ“‡';
            }
        });
    }
    
    function openPicker(sid, title) {
        if (!window.matchMedia('(max-width: 900px)').matches) return;
        const sel = document.getElementById(sid);
        _pickerSelectId = sid;
        document.getElementById('pickerTitle').textContent = title;
        const list = document.getElementById('pickerList');
        list.innerHTML = '';
        [...sel.options].forEach(opt => {
            if (opt.tagName === 'OPTGROUP') return;
            const item = document.createElement('div');
            item.className = 'picker-item' + (opt.value === sel.value ? ' active' : '');
            item.textContent = opt.textContent;
            item.onclick = () => {
                sel.value = opt.value;
                sel.dispatchEvent(new Event('change'));
                closePicker();
            };
            list.appendChild(item);
        });
        document.getElementById('pickerModal').classList.remove('hidden');
    }
    function closePicker() { document.getElementById('pickerModal').classList.add('hidden'); _pickerSelectId = null; syncPickerButtons(); }

    window.onload = () => {
        loadFromStorage();
        
        const _vd0 = document.getElementById('verDate')?.value || localStorage.getItem(STORAGE_VERDATE_KEY);
        if(_vd0) syncVersionTag(_vd0);
        const _vdInput = document.getElementById('verDate');
        if(_vdInput) _vdInput.addEventListener('input', e=>syncVersionTag(e.target.value));
renderTypeSelect();
        
        document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
        updateStackThickList();
        
        updateFineSel(); runFineQuery();
        
        updateFeedSel(); runFeedQuery();
        
        setSelectOptions(document.getElementById('lifeSizeSel'), Object.keys(toolLifeRules));
        updateLifeTypeList();
        
        renderNotes();
        
        syncPickerButtons();
    };

    document.addEventListener('click', (e) => {
        const sidebar = document.getElementById('sidebar');
        if (!window.matchMedia('(max-width: 900px)').matches) return;
        if (document.getElementById('pickerModal').classList.contains('hidden') === false) return;
        if (e.target.closest('select, input, button, .picker-btn')) return;
        if (!sidebar.contains(e.target) && !e.target.closest('.hamburger-btn')) sidebar.classList.add('collapsed');
    });

</script>


</body></html>
