<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RT åƒæ•¸å°ç…§è¡¨</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --sidebar-width: 280px; --edit-bg: #fff4e5; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: #f4f7f9; margin: 0; display: flex; overflow: hidden; }
        
        /* å´æ¬„å°è¦½ */
        .sidebar { width: var(--sidebar-width); background: var(--primary); color: white; height: 100vh; display: flex; flex-direction: column; flex-shrink: 0; transition: 0.3s; z-index: 2000; }
        .sidebar.collapsed { margin-left: -280px; }
        .sidebar-header { padding: 25px 20px; font-size: 1.4rem; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .sidebar-menu { flex: 1; overflow-y: auto; padding: 10px 0; }
        .menu-item { padding: 15px 20px; cursor: pointer; color: rgba(255,255,255,0.7); border-left: 5px solid transparent; font-size: 15px; transition: 0.2s; }
        .menu-item:hover { background: rgba(255,255,255,0.1); color: white; }
        .menu-item.active { background: rgba(255,255,255,0.15); color: white; border-left-color: var(--accent); }
        .admin-section { padding: 15px; border-top: 1px solid rgba(255,255,255,0.1); }

        /* ä¸»å…§å®¹å€ */
        .main-wrapper { flex: 1; height: 100vh; overflow-y: auto; display: flex; flex-direction: column; z-index: 100; }
        .top-bar { background: white; padding: 12px 20px; display: flex; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .content-section { padding: 20px; display: none; }
        .content-section.active { display: block; animation: fadeIn 0.3s; }
        
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px; position: relative; }
        .query-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 10px; }
        label { display: block; font-size: 13px; font-weight: bold; margin-bottom: 8px; color: #555; }
        
        /* é¸å–®æ¨£å¼ï¼šå¼·åˆ¶é¡¯ç¤ºèˆ‡æ’é–‹ */
        select, input { width: 100% !important; height: 48px; display: block !important; padding: 0 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; background: white; box-sizing: border-box; cursor: pointer; }
        
        /* è¡¨æ ¼æ¨£å¼ */
        .table-wrap { overflow-x: auto; border-radius: 8px; border: 1px solid #eee; margin-top: 15px; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; text-align: center; }
        th { background: #f8fafc; padding: 15px 10px; color: #64748b; font-size: 13px; border-bottom: 2px solid #edf2f7; }
        td { padding: 22px 10px; border-bottom: 1px solid #f1f5f9; font-size: 24px; font-weight: 800; color: #1a202c; }
        .editing .editable { background: #fff4e5; border: 1px solid #f39c12 !important; cursor: pointer; }

        /* æ•¸å€¼è¦–è¦ºæ¨£å¼ */
        .val-mid { font-size: 26px; font-weight: 800; display: block; line-height: 1.1; }
        .val-range { font-size: 12px; color: #7f8c8d; background: #f1f5f9; padding: 2px 6px; border-radius: 4px; display: inline-block; margin-top: 4px; font-weight: normal; }

        /* æ¿å…§æ§½è‰²å¡Šæ¨™ç±¤ (Tab 3) */
        .fine-box { display: flex; align-items: center; gap: 15px; }
        .fine-select { width: 220px !important; }
        .color-badge { display: inline-flex; align-items: center; justify-content: center; padding: 10px 25px; border-radius: 8px; font-size: 20px; font-weight: 900; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); box-shadow: 0 4px 6px rgba(0,0,0,0.1); min-width: 120px; }

        /* å‚™è¨»åˆ—è¡¨ (Tab 6) */
        .note-list { list-style: none; padding: 0; }
        .note-list li { padding: 12px; border-bottom: 1px solid #edf2f7; line-height: 1.6; color: #4a5568; }
        .note-list b { color: #2c3e50; margin-right: 5px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">RT åƒæ•¸å°ç…§æŸ¥è©¢</div>
        <div class="sidebar-menu">
            <div class="menu-item active" onclick="switchTab('tab-query')">ğŸ” åƒæ•¸ä¸­å€¼æŸ¥è©¢</div>
            <div class="menu-item" onclick="switchTab('tab-stack')">ğŸ“Š ç–Šæ¿ç‰‡æ•¸å°ç…§è¡¨</div>
            <div class="menu-item" onclick="switchTab('tab-fine')">ğŸ”§ ç²—æ²–å¾Œç´°åˆ‡-æ¿å…§æ§½</div>
            <div class="menu-item" onclick="switchTab('tab-feed')">ğŸš€ é‘½å­”é€²åˆ€é€Ÿå°ç…§è¡¨</div>
            <div class="menu-item" onclick="switchTab('tab-life')">â³ åˆ‡åˆ€å£½å‘½è¦å®š</div>
            <div class="menu-item" onclick="switchTab('tab-note')">ğŸ“ å‚™è¨»äº‹é …</div>
        </div>
        <div class="admin-section">
            <button style="background:#34495e; color:white; width:100%; padding:12px; border:none; border-radius:8px; cursor:pointer; font-weight:bold;" id="btnAdmin" onclick="toggleAdmin()">âš™ï¸ ç®¡ç†æ¨¡å¼</button>
            <button style="background:#e74c3c; color:white; width:100%; padding:12px; border:none; border-radius:8px; cursor:pointer; font-weight:bold; display:none;" id="btnExit" onclick="toggleAdmin()">ğŸšª é€€å‡ºç®¡ç†</button>
        </div>
    </div>

    <div class="main-wrapper">
        <div class="top-bar">
            <span style="cursor:pointer; font-size:24px; margin-right:15px; color:#2c3e50;" onclick="document.getElementById('sidebar').classList.toggle('collapsed')">â˜°</span>
            <h3 id="currentTitle" style="margin:0; color:#2c3e50;">åƒæ•¸ä¸­å€¼æŸ¥è©¢</h3>
        </div>

        <!-- é é¢ 1: åƒæ•¸ä¸­å€¼æŸ¥è©¢ -->
        <section id="tab-query" class="content-section active">
            <div class="card">
                <div class="query-row">
                    <div class="input-box"><label>é¡å‹</label><select id="typeSelect" onchange="updateSizeList(); runQuery()"></select></div>
                    <div class="input-box"><label>å°ºå¯¸</label><select id="sizeSelect" onchange="runQuery()"></select></div>
                </div>
                <div class="table-wrap">
                    <table id="mainTable">
                        <thead><tr><th>è½‰é€Ÿ (S)</th><th>é€²åˆ€ (F)</th><th>å£½å‘½ (N)</th><th>è£œå„Ÿ (D)</th><th>æª¯é¢é€Ÿåº¦ (F0X)</th></tr></thead>
                        <tbody id="tableBody"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- é é¢ 2: ç–Šæ¿å°ç…§è¡¨ -->
        <section id="tab-stack" class="content-section">
            <div class="card">
                <div class="query-row">
                    <div class="input-box"><label>æœ€å°åˆ‡åˆ€ç›´å¾‘ mil (mm)</label><select id="stkSizeSel" onchange="updateStackThickList(); runStackQuery()"></select></div>
                    <div class="input-box"><label>æˆå“æ¿åš</label><select id="stkThickSel" onchange="runStackQuery()"></select></div>
                </div>
            </div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                <div style="background:#f8fafc; padding:25px; border-radius:12px; text-align:center; border:1px solid #edf2f7;"><span style="font-size:13px; color:#64748b; display:block; margin-bottom:10px; font-weight:bold;">å»ºè­°ç–Šæ¿ç‰‡æ•¸</span><span id="stkResCount" style="font-size:36px; font-weight:800; color:#2b6cb0;">--</span></div>
                <div style="background:#f8fafc; padding:25px; border-radius:12px; text-align:center; border:1px solid #edf2f7;"><span style="font-size:13px; color:#64748b; display:block; margin-bottom:10px; font-weight:bold;">æœ€å¤§ç–Šæ¿åšåº¦ mil (mm)</span><span id="stkResMax" style="font-size:22px; font-weight:800; color:#1a202c;">--</span></div>
            </div>
        </section>

        <!-- é é¢ 3: æ¿å…§æ§½ (å«å¤§å‹è‰²å¡Šæ¨™ç±¤) -->
        <section id="tab-fine" class="content-section">
            <div class="card">
                <div class="input-box" style="margin-bottom:20px;"><label>å°ºå¯¸ mil (mm)</label>
                    <div class="fine-box"><select id="fineSizeSel" class="fine-select" onchange="runFineQuery()"></select><div id="fineBadge" class="color-badge">--</div></div>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead><tr><th>è½‰é€Ÿ (S)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>é€²åˆ€é€Ÿ (F)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>æª¯é¢é€Ÿåº¦ (F)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>è£œå„Ÿå€¼ (D)<br><small>å¯èª¿æ•´ç¯„åœ</small></th></tr></thead>
                        <tbody id="fineTableBody"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- é é¢ 4: é‘½å­”é€²åˆ€é€Ÿ -->
        <section id="tab-feed" class="content-section">
            <div class="card">
                <div class="input-box" style="margin-bottom:20px;"><label>é‘½é ­ç›´å¾‘ inch (mm)</label><select id="feedSizeSel" style="width:300px;" onchange="runFeedQuery()"></select></div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr>
                                <th>è½‰é€Ÿ (S)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th>
                                <th style="background:#ebf8ff; color:#2b6cb0;">å°å¼•å­” (F)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th>
                                <th style="background:#f0fff4; color:#2f855a;">äºŒæ¬¡å­” (F)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th>
                                <th>å£½å‘½ (N)</th>
                            </tr>
                        </thead>
                        <tbody id="feedTableBody"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- é é¢ 5: åˆ‡åˆ€å£½å‘½è¦å®š -->
        <section id="tab-life" class="content-section">
            <div class="card">
                <div class="query-row">
                    <div class="input-box"><label>1. é¸æ“‡ç›´å¾‘ inch (mm)</label><select id="lifeSizeSel" onchange="updateLifeTypeList()"></select></div>
                    <div class="input-box"><label>2. é¸æ“‡å‹æ…‹</label><select id="lifeTypeSel" onchange="runLifeQuery()"></select></div>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr>
                                <th style="width:50%;">æ™®é€šæè³ª</th>
                                <th style="background:#fff7ed; color:#c2410c; border-bottom: 2px solid #fdba74;">é«˜éšæè³ª (HITG, LK, EM526ç­‰)</th>
                            </tr>
                        </thead>
                        <tbody id="lifeTableBody"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- é é¢ 6: å‚™è¨»äº‹é … -->
        <section id="tab-note" class="content-section">
            <div class="card">
                <ul class="note-list">
                    <li><b>1.</b> HITGã€LKã€RFã€HFã€EM390åŠEM526æè³ªçš„å„åˆ‡åˆ€åŠå°å¼•å­”ä¸‹é‘½é€Ÿåº¦ 5~10 (ç²—åˆ‡ã€ç²—åˆ‡å°å¼•å­”åŠå¤–å‹é™¤å¤–)ã€‚</li>
                    <li><b>2.</b> <b>åˆ‡å…§æ§½ç‚ºéŠ…é¢ï¼š</b>åˆ‡åˆ€ 31~59 mil å£½å‘½ç”¨ 50 INCHï¼›62~93 mil å£½å‘½ç”¨ 100 INCHã€‚</li>
                    <li><b>3.</b> è—åœ–æ¨™ç¤º â—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰èµ° G42ï¼Œåˆ‡åˆ€è¦æ ¼å£½å‘½è¦å®šè«‹ä¾åˆ—è¡¨å°ç…§ã€‚</li>
                    <li><b>4.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€ 31~51 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ ~50 INCHï¼Œå°é¢é€Ÿåº¦ 10~30ã€‚</li>
                    <li><b>5.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€ 55~93 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ ~180 INCHï¼Œå°é¢é€Ÿåº¦ 10~50 (M57è–„æ¿ç‚º20)ã€‚</li>
                    <li><b>6.</b> æ¸…ç²‰åˆ‡åˆ€ 31~51 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ï¼Œå°é¢é€Ÿåº¦ 30ã€‚</li>
                    <li><b>7.</b> æ¸…ç²‰åˆ‡åˆ€ 55~93 mil å£½å‘½è¦å®šï¼šæ™®é€šæè³ªè¨­å®šä¸Šé™ï¼Œå°é¢é€Ÿåº¦ 50 (M57è–„æ¿ç‚º20)ã€‚</li>
                    <li><b>8.</b> H30æ–™è™Ÿã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€ï¼š62 mil å£½å‘½è¨­ 200 INCHï¼›79 mil å£½å‘½è¨­ 200 INCHã€‚</li>
                    <li><b>9.</b> C66æ–™è™Ÿå¤–å‹ 62 mil åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š 300 INCHã€‚</li>
                    <li><b>10.</b> 39~47 mil è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„ 35 mil åˆ‡åˆ€ (éœ€æ”¹ç‚º 35 mil åƒæ•¸)ã€‚</li>
                    <li><b>11.</b> C81ã€C91æ–™è™Ÿ 39 milã€47 mil é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š 300 INCHã€‚</li>
                </ul>
            </div>
        </section>
    </div>

<script>
    const colorMap = { "åœŸé»ƒè‰²":"#D4A017", "è˜‹æœç¶ ":"#8DB600", "é†¬ç´…è‰²":"#800000", "é»‘è‰²":"#000000", "æ·±è—è‰²":"#00008B", "å’–å•¡è‰²":"#6F4E37", "é’è‰²":"#00CED1", "æŸ‘ç´…è‰²":"#FF4500", "æ·¡ç´«è‰²":"#E6E6FA", "å¢¨ç¶ è‰²":"#006400", "ç²‰ç´…è‰²":"#FF69B4", "ç™½è‰²":"#C0C0C0", "æ£•ç´…è‰²":"#A52A2A", "æ·¡æ¢¨è‰²":"#F0EAD6", "æ·±ç´«è‰²":"#800080", "æ·¡æ©˜è‰²":"#FFB84D", "å¡å…¶è‰²":"#F0E68C", "æ·¡è—è‰²":"#ADD8E6", "ç°è‰²":"#808080", "å‡é»ƒè‰²":"#F0E68C", "èƒ­è„‚ç´…":"#C71585", "å¤©è—è‰²":"#87CEEB", "æ¡ƒç´…è‰²":"#FF69B4", "å¤§ç´…è‰²":"#FF0000", "æ¾æ¨¹ç¶ ":"#01796F" };

    // --- Tab 1 Data ---
    let toolData = {
        "0.0197": { FF:["40","10","50","0.0098","10"], AA:["40","10","50","0.0098","10"], RD:["40","10","50","0.0098","8"], G42:["40","7","30","0.0098","8"], OR:["40","10","50","0.0103","10"] },
        "0.0197 CB": { FF:["40","10","150","0.0098","10"], AA:["40","10","150","0.0098","10"], RD:["40","10","150","0.0098","8"], G42:["40","7","75","0.0098","8"], OR:["40","10","150","0.0103","10"] },
        "0.0236": { FF:["40","10","50","0.0118","10"], AA:["40","10","50","0.0118","10"], RD:["40","10","50","0.0118","8"], G42:["40","7","30","0.0118","8"], OR:["40","10","50","0.0123","10"] },
        "0.0236 CB": { FF:["40","10","150","0.0118","10"], AA:["40","10","150","0.0118","10"], RD:["40","10","150","0.0118","8"], G42:["40","7","75","0.0118","8"], OR:["40","10","150","0.0123","10"] },
        "0.031": { FF:["33","12","100","0.0155","12"], AA:["30","20","300","0.0155","30"], RD:["30","10","90","0.0155","10"], G42:["33","10","50","0.0155","10"], OR:["30","12","90","0.0160","10"], RDL:["-30","10","90","0.0155","10"] },
        "0.035": { FF:["33","12","100","0.0175","12"], AA:["30","20","300","0.0175","30"], RD:["30","10","90","0.0175","10"], G42:["33","10","50","0.0175","10"], OR:["30","12","90","0.0180","10"] },
        "0.039": { FF:["33","12","200","0.0195","12"], AA:["30","20","300","0.0195","30"], RD:["30","10","200","0.0195","10"], G42:["32","10","50","0.0195","10"], OR:["30","12","200","0.0200","10"], RDL:["-30","10","160","0.0195","10"] },
        "0.039 CB": { FF:["33","12","700","0.0195","12"], AA:["30","20","700","0.0195","30"], RD:["30","10","700","0.0195","10"], G42:["32","10","150","0.0195","10"], OR:["30","12","700","0.0200","10"] },
        "0.039 LCB": { FF:["33","12","300","0.0195","12"], AA:["30","20","300","0.0195","30"], RD:["30","10","300","0.0195","10"], G42:["32","10","300","0.0195","10"], OR:["30","12","300","0.0200","10"] },
        "0.047": { FF:["32","12","200","0.0235","12"], AA:["30","30","370","0.0235","30"], RD:["30","10","200","0.0235","10"], G42:["32","10","80","0.0235","10"], OR:["30","15","200","0.0240","10"] },
        "0.047 CB": { FF:["32","12","300","0.0235","12"], AA:["30","30","300","0.0235","30"], RD:["30","10","300","0.0235","10"], G42:["32","10","300","0.0235","10"], OR:["30","15","300","0.0240","10"] },
        "0.055": { FF:["32","15","420","0.0275","50"], AA:["30","35","420","0.0275","50"], RD:["30","10","200","0.0275","10"], G42:["30","10","80","0.0275","10"], OR:["30","15","200","0.0280","10"] },
        "0.059": { FF:["32","20","420","0.0295","50"], AA:["30","35","420","0.0295","50"], RD:["28","10","250","0.0295","10"], G42:["30","10","80","0.0295","10"], OR:["30","20","250","0.0302","10"] },
        "0.062": { FF:["32","30","520","0.0315","50"], AA:["28","40","520","0.0315","50"], RD:["23","5","350","0.0315","10"], G42:["28","5","100","0.0315","10"], OR:["28","30","350","0.0322","10"] },
        "0.079": { FF:["32","30","700","0.0395","50"], AA:["28","40","700","0.0395","50"], RD:["22","5","400","0.0395","10"], G42:["28","5","100","0.0395","10"], OR:["28","30","400","0.0405","10"] },
        "0.093": { FF:["32","30","1020","0.0465","50"], AA:["28","40","1020","0.0465","50"], RD:["22","5","400","0.0465","10"], G42:["25","5","100","0.0465","10"], OR:["28","30","800","0.0485","10"] },
        "å°æ–¼0.1260(ä¸å«)": { DA:["30","10","1500","--","10"], DAFF:["30","30","1500","--","10"] },
        "å¤§æ–¼0.1260(å«)": { DA:["20","10","1500","--","10"], DAFF:["20","10","1500","--","10"] }
    };

    const stackingRules = {
        "15.7 (0.40)": { max: "40 (1.02)", options: {"9~10":4, "11~13":3, "14~20":2, "21~40":1} },
        "19.7 (0.50)": { max: "66 (1.68)", options: {"10~16":4, "17~22":3, "23~33":2, "34~66":1} },
        "19.7 LCBRD (0.50)": { max: "86 (2.18)", options: {"10~17":5, "18~21":4, "22~28":3, "29~43":2, "44~86":1} },
        "23.6 (0.60)": { max: "88 (2.24)", options: {"15~22":4, "23~29":3, "30~44":2, "45~88":1} },
        "23.6 LCBRD (0.60)": { max: "108 (2.74)", options: {"15~21":5, "22~27":4, "28~36":3, "37~54":2, "55~108":1} },
        "31~35 (0.80-0.90)": { max: "122 (2.74)", options: {"9~12":10, "13":9, "14~15":8, "16~17":7, "18~20":6, "21~24":5, "25~30":4, "31~40":3, "41~61":2, "62~122":1} },
        "35 LRD (0.90)": { max: "170 (4.32)", options: {"15~21":8, "22~24":7, "25~28":6, "29~34":5, "35~42":4, "43~56":3, "57~85":2} },
        "39~55 (0.10-1.40)": { max: "205 (5.21)", options: {"15~22":8, "23~25":7, "26~30":6, "31~37":5, "38~47":4, "48~64":3, "65~99":2} },
        "59~98 (1.50-2.50)": { max: "259 (6.6)", options: {"15~18":12, "19~22":10, "23~28":8, "29~33":7, "34~39":6, "40~47":5, "48~60":4, "61~81":3} },
        "39~47 LCBRD (1.00-1.20)": { max: "263 (6.7)", options: {"15~18":12, "19~22":10, "23~28":8, "29~33":7, "34~39":6, "40~47":5, "48~60":4, "61~68":3} }
    };

    const fineCutData = [
        { label: "0.0197\" (åœŸé»ƒè‰²)", s:["40","30~45"], f:["8","5~10"], t:["8","5~10"], d:["0.0098","+/-0.003\""], color:"åœŸé»ƒè‰²" },
        { label: "0.0197\" LCBRD (è˜‹æœç¶ )", s:["45","40~55"], f:["8","5~10"], t:["8","5~10"], d:["0.0098","+/-0.003\""], color:"è˜‹æœç¶ " },
        { label: "0.0236\" (é†¬ç´…è‰²)", s:["40","30~45"], f:["8","5~10"], t:["8","5~10"], d:["0.0118","+/-0.003\""], color:"é†¬ç´…è‰²" },
        { label: "0.0236\" LCBRD (é»‘è‰²)", s:["40","30~50"], f:["8","5~10"], t:["8","5~10"], d:["0.0118","+/-0.003\""], color:"é»‘è‰²" },
        { label: "0.031\" (æ·±è—è‰²)", s:["30","25~40"], f:["15","10~20"], t:["10","10~20"], d:["0.0155","+/-0.003\""], color:"æ·±è—è‰²" },
        { label: "0.031\" CBRD (å’–å•¡è‰²)", s:["55","40~55"], f:["15","10~20"], t:["10","10~20"], d:["0.0155","+/-0.003\""], color:"å’–å•¡è‰²" },
        { label: "0.031\" (é€†)æ¼¢å° (é’è‰²)", s:["-30","-30"], f:["10","5~10"], t:["10","10~20"], d:["0.0155","+/-0.003\""], color:"é’è‰²" },
        { label: "0.035\" (æŸ‘ç´…è‰²)", s:["30","20~40"], f:["15","10~20"], t:["10","10~20"], d:["0.0175","+/-0.003\""], color:"æŸ‘ç´…è‰²" },
        { label: "0.035\" LRD (æ·¡ç´«è‰²)", s:["30","20~40"], f:["15","10~20"], t:["10","10~20"], d:["0.0175","+/-0.003\""], color:"æ·¡ç´«è‰²" },
        { label: "0.039\" (å¢¨ç¶ è‰²)", s:["30","25~40"], f:["15","10~20"], t:["10","10~20"], d:["0.0195","+/-0.003\""], color:"å¢¨ç¶ è‰²" },
        { label: "0.039\" CBRD (ç²‰ç´…è‰²)", s:["35","25~50"], f:["15","10~20"], t:["10","10~20"], d:["0.0195","+/-0.003\""], color:"ç²‰ç´…è‰²" },
        { label: "0.039\" (é€†)å°–é» (ç™½è‰²)", s:["-30","-25~-40"], f:["10","10~20"], t:["10","10~20"], d:["0.0195","+/-0.003\""], color:"ç™½è‰²" },
        { label: "0.0039\" LCBRD (æ£•ç´…è‰²)", s:["35","25~50"], f:["15","10~20"], t:["10","10~20"], d:["0.0195","+/-0.003\""], color:"æ£•ç´…è‰²" },
        { label: "0.043\" (æ·¡æ¢¨è‰²)", s:["30","25~40"], f:["15","10~20"], t:["10","10~20"], d:["0.0215","+/-0.003\""], color:"æ·¡æ¢¨è‰²" },
        { label: "0.047\" (æ·±ç´«è‰²)", s:["30","20~40"], f:["28","10~30"], t:["20","10~25"], d:["0.0235","+/-0.003\""], color:"æ·±ç´«è‰²" },
        { label: "0.062\" (å‡é»ƒè‰²)", s:["30","18~35"], f:["35","10~40"], t:["25","10~30"], d:["0.0315","+/-0.003\""], color:"å‡é»ƒè‰²" },
        { label: "0.098\" (æ¾æ¨¹ç¶ )", s:["28","18~30"], f:["35","10~40"], t:["40","10~45"], d:["0.0490","+/-0.003\""], color:"æ¾æ¨¹ç¶ " }
    ];

    const feedData = [ { label: "0.0279\" ä»¥ä¸‹", s:["30","20~40"], pF:["20","10~20"], sF:["10","10~20"], life: "1500" }, { label: "0.0280\"~0.0429\"", s:["30","20~40"], pF:["30","10~30"], sF:["10","10~20"], life: "1500" }, { label: "0.0430\"~0.0865\"", s:["30","20~40"], pF:["40","10~40"], sF:["10","10~20"], life: "1500" }, { label: "0.0866\"~0.1014\"", s:["25","20~35"], pF:["50","10~50"], sF:["10","10~20"], life: "1500" }, { label: "0.1015\"~0.1259\"", s:["25","20~35"], pF:["40","10~40"], sF:["10","10~20"], life: "1500" }, { label: "0.1260\"~0.1456\"", s:["20","15~25"], pF:["20","10~20"], sF:["10","10~20"], life: "1500" }, { label: "0.1457\" ä»¥ä¸Š", s:["20","15~25"], pF:["10","10~15"], sF:["10","10~20"], life: "1500" } ];

    const toolLifeRules = {
        "0.0197\" (0.500mm)": { "éè†œåˆ€": [["150","100~150"],["150","100~150"]], "ä¸€èˆ¬åˆ€": [["50","10~50"],["30","10~50"]] },
        "0.0236\" (0.600mm)": { "éè†œåˆ€": [["150","100~150"],["150","100~150"]], "ä¸€èˆ¬åˆ€": [["50","10~50"],["30","10~50"]] },
        "0.031\" (0.800mm)": { "éè†œåˆ€": [["450","300~450"],["300","250~300"]], "ä¸€èˆ¬åˆ€": [["300","260~300"],["100","60~100"]] },
        "0.031\" é€†è½‰åˆ€ (0.800mm)": { "ä¸€èˆ¬åˆ€": [["90","90"],["90","90"]] },
        "0.035\" (0.900mm)": { "ä¸€èˆ¬åˆ€": [["300","260~300"],["100","60~100"]], "é•·åˆƒåˆ€": [["300","260~300"],["100","60~100"]] },
        "0.039\" (1.000mm)": { "éè†œåˆ€": [["1000","700~1000"],["700","600~700"]], "ä¸€èˆ¬åˆ€": [["300","260~300"],["200","120~200"]] },
        "0.039\" é€†è½‰åˆ€ (1.000mm)": { "ä¸€èˆ¬åˆ€": [["160","160"],["160","160"]] },
        "0.043\" (1.100mm)": { "ä¸€èˆ¬åˆ€": [["300","260~300"],["100","60~100"]] },
        "0.047\" (1.200mm)": { "éè†œåˆ€": [["1000","700~1000"],["700","600~700"]], "ä¸€èˆ¬åˆ€": [["370","330~370"],["200","120~200"]] },
        "0.051\"~0.059\" (1.300-1.500mm)": { "ä¸€èˆ¬åˆ€": [["370~420","330~420"],["140~250","100~250"]] },
        "0.062\"~0.075\" (1.600-1.900mm)": { "ä¸€èˆ¬åˆ€": [["520","480~520"],["320~400","280~400"]] },
        "0.079\" (å…§æ§½)": { "ä¸€èˆ¬åˆ€": [["700","580~700"],["620","400~620"]] },
        "0.079\" (å¤–å‹)": { "ä¸€èˆ¬åˆ€": [["620","580~620"],["420","380~420"]] },
        "0.093\" (å…§æ§½)": { "ä¸€èˆ¬åˆ€": [["620","580~620"],["420","380~420"]] },
        "0.093\" (å¤–å‹)": { "ä¸€èˆ¬åˆ€": [["1020","980~1020"],["820","780~820"]] },
        "0.098\" (å…§æ§½)": { "ä¸€èˆ¬åˆ€": [["520","480~520"],["320","280~320"]] }
    };

    let isEditing = false;

    // --- DOM helper (é¿å… innerHTML é€ æˆå« " çš„ option value ç ´ç‰ˆ/ç„¡æ³•é¸å–) ---
    function setSelectOptions(selectEl, values, getLabel) {
        selectEl.innerHTML = "";
        values.forEach(v => {
            const opt = document.createElement('option');
            opt.value = String(v);
            opt.textContent = getLabel ? getLabel(v) : String(v);
            selectEl.appendChild(opt);
        });
    }

    // --- å„é é¢åˆ‡æ› ---
    function switchTab(id) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.currentTarget.classList.add('active');
        document.getElementById('currentTitle').innerText = event.currentTarget.innerText;
    }

    // --- Tab 1 æŸ¥è©¢ ---
    function updateSizeList() {
        const t = document.getElementById('typeSelect').value;
        const valid = Object.keys(toolData).filter(s => toolData[s][t] !== undefined);
        document.getElementById('sizeSelect').innerHTML = valid.sort().map(s => `<option value="${s}">${s}</option>`).join('');
        runQuery();
    }
    function runQuery() {
        const s = document.getElementById('sizeSelect').value, t = document.getElementById('typeSelect').value;
        if (!s || !toolData[s][t]) return;
        document.getElementById('tableBody').innerHTML = '<tr>' + toolData[s][t].map((v, i) => `<td class="${isEditing?'editable':''}" onclick="editField('${s}','${t}',${i})">${v}</td>`).join('') + '</tr>';
    }

    // --- Tab 2 ç–Šæ¿ ---
    function updateStackThickList() {
        const s = document.getElementById('stkSizeSel').value;
        document.getElementById('stkThickSel').innerHTML = Object.keys(stackingRules[s].options).map(t => `<option value="${t}">${t}</option>`).join('');
        runStackQuery();
    }
    function runStackQuery() {
        const s = document.getElementById('stkSizeSel').value, r = document.getElementById('stkThickSel').value;
        document.getElementById('stkResMax').innerText = stackingRules[s].max;
        document.getElementById('stkResCount').innerText = stackingRules[s].options[r] + " ç‰‡";
    }

    // --- Tab 3 ç´°åˆ‡ ---
    function runFineQuery() {
        const i = document.getElementById('fineSizeSel').value, d = fineCutData[i], b = document.getElementById('fineBadge');
        b.innerText = d.color; b.style.backgroundColor = colorMap[d.color] || '#eee';
        document.getElementById('fineTableBody').innerHTML = `<tr><td><span class="val-mid">${d.s[0]}</span><span class="val-range">${d.s[1]}</span></td><td><span class="val-mid">${d.f[0]}</span><span class="val-range">${d.f[1]}</span></td><td><span class="val-mid">${d.t[0]}</span><span class="val-range">${d.t[1]}</span></td><td><span class="val-mid">${d.d[0]}</span><span class="val-range">${d.d[1]}</span></td></tr>`;
    }

    // --- Tab 4 é€²åˆ€ ---
    function runFeedQuery() {
        const i = document.getElementById('feedSizeSel').value, d = feedData[i];
        document.getElementById('feedTableBody').innerHTML = `<tr><td><span class="val-mid">${d.s[0]}</span><span class="val-range">${d.s[1]}</span></td><td style="background:#ebf8ff;"><span class="val-mid" style="color:#2b6cb0;">${d.pF[0]}</span><span class="val-range">${d.pF[1]}</span></td><td style="background:#f0fff4;"><span class="val-mid" style="color:#2f855a;">${d.sF[0]}</span><span class="val-range">${d.sF[1]}</span></td><td><span class="val-mid">${d.life}</span></td></tr>`;
    }

    // --- Tab 5 åˆ‡åˆ€å£½å‘½ (å¾¹åº•ä¿®å¾©å‹æ…‹é€£å‹•) ---
    function updateLifeTypeList() {
        const sizeSel = document.getElementById('lifeSizeSel');
        const typeSel = document.getElementById('lifeTypeSel');
        const selectedSize = sizeSel.value;
        
        // å–å¾—è©²å°ºå¯¸å°æ‡‰çš„æ‰€æœ‰å‹æ…‹é¸é …
        const types = Object.keys(toolLifeRules[selectedSize] || {});

        // ä»¥ DOM API å»ºç«‹ optionï¼Œé¿å…å­—å…ƒé€ æˆ HTML attribute è§£æéŒ¯èª¤
        setSelectOptions(typeSel, types);
        
        // ç”Ÿæˆå‹æ…‹å¾Œç«‹å³åŸ·è¡ŒæŸ¥è©¢
        runLifeQuery();
    }
    
    function runLifeQuery() {
        const sizeSel = document.getElementById('lifeSizeSel');
        const typeSel = document.getElementById('lifeTypeSel');
        const s = sizeSel.value;
        const t = typeSel.value;
        
        if (!s || !t || !toolLifeRules[s] || !toolLifeRules[s][t]) return;
        
        const d = toolLifeRules[s][t];
        document.getElementById('lifeTableBody').innerHTML = `<tr>
            <td><span class="val-mid">${d[0][0]}</span><span class="val-range">${d[0][1]}</span></td>
            <td style="background:#fff7ed;"><span class="val-mid" style="color:#c2410c;">${d[1][0]}</span><span class="val-range">${d[1][1]}</span></td>
        </tr>`;
    }

    // --- Admin ---
    function toggleAdmin() {
        if(!isEditing) { if(prompt("å¯†ç¢¼:") !== "YPD14-RT") return; isEditing = true; 
        document.getElementById('btnAdmin').style.display = 'none'; document.getElementById('btnExit').style.display = 'block'; }
        else { isEditing = false; document.getElementById('btnAdmin').style.display = 'block'; document.getElementById('btnExit').style.display = 'none'; }
        runQuery();
    }
    function editField(s, t, i) { if(isEditing) { const n = prompt("æ–°å€¼:", toolData[s][t][i]); if(n) {toolData[s][t][i]=n; runQuery();}} }

    window.onload = () => { 
        document.getElementById('typeSelect').innerHTML = `<optgroup label="ä¸»è¦å·¥åº"><option value="FF">ç²—åˆ‡ (FF)</option><option value="AA">ç²—åˆ‡ (AA) æ¸…ç²‰</option><option value="RD">å…§æ§½ (RD)ã€é˜»æŠ—æ¢ (CP)</option><option value="G42">å°é–‰æ§½ã€äºŒæ¬¡å­”ã€è€³æœµæ§½ã€è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ (G42)</option><option value="OR">å¤–å‹ (OR)ã€è£é–‹ (HA)</option></optgroup><optgroup label="ç‰¹æ®Šå·¥åº"><option value="RDL">å…§æ§½ (RDL) é€†è½‰åˆ€</option><option value="DA">å°å¼•å­” (DA)</option><option value="DAFF">ç²—åˆ‡å°å¼•å­” (DA FF)</option></optgroup>`;
        updateSizeList();
        document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
        updateStackThickList();
        document.getElementById('fineSizeSel').innerHTML = fineCutData.map((d, i) => `<option value="${i}">${d.label}</option>`).join('');
        runFineQuery();
        document.getElementById('feedSizeSel').innerHTML = feedData.map((d, i) => `<option value="${i}">${d.label}</option>`).join('');
        runFeedQuery();
        
        // åˆå§‹åŒ–ç¬¬äº”åˆ†é ï¼ˆç”¨ DOM APIï¼Œç¢ºä¿åƒ 0.035" é€™ç¨®å« " çš„å€¼ä¸æœƒç ´å£ optionï¼‰
        const lifeSel = document.getElementById('lifeSizeSel');
        setSelectOptions(lifeSel, Object.keys(toolLifeRules));
        updateLifeTypeList();
    };
</script>
</body>
</html>