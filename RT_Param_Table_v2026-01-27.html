<!DOCTYPE html>
<html lang="zh-TW"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RT åƒæ•¸å°ç…§è¡¨_é›»å­ç‰ˆ</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --sidebar-width: 280px; --edit-bg: #fff4e5; }
        * { box-sizing: border-box; } 
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: #f4f7f9; margin: 0; display: flex; overflow: hidden; }
        
        /* å´æ¬„å°è¦½ */
        .sidebar { width: var(--sidebar-width); background: var(--primary); color: white; height: 100vh; display: flex; flex-direction: column; flex-shrink: 0; transition: 0.3s; z-index: 2000; }
        .sidebar.collapsed { margin-left: -280px; }
        .sidebar-header { padding: 25px 20px; font-size: 1.4rem; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; gap: 5px; }
        .version-tag { font-size: 12px; font-weight: normal; color: rgba(255,255,255,0.6); letter-spacing: 0.5px; }
        .sidebar-menu { flex: 1; overflow-y: auto; padding: 10px 0; }
        .menu-item { padding: 15px 20px; cursor: pointer; color: rgba(255,255,255,0.7); border-left: 5px solid transparent; font-size: 15px; transition: 0.2s; }
        .menu-item:hover { background: rgba(255,255,255,0.1); color: white; }
        .menu-item.active { background: rgba(255,255,255,0.15); color: white; border-left-color: var(--accent); }
        .admin-section { padding: 15px; border-top: 1px solid rgba(255,255,255,0.1); }

        /* ä¸»å…§å®¹å€ */
        .main-wrapper { flex: 1; height: 100vh; overflow-y: auto; display: flex; flex-direction: column; z-index: 100; }
        .top-bar { background: white; padding: 12px 20px; display: flex; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .content-section { padding: 20px; display: none; }
        .content-section.active { display: block; animation: fadeIn 0.3s; }
        
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px; position: relative; }
        .query-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 10px; }
        label { display: block; font-size: 13px; font-weight: bold; margin-bottom: 8px; color: #555; }
        
        select, input { width: 100% !important; height: 48px; display: block !important; padding: 0 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; background: white; cursor: pointer; }
        
        .table-wrap { overflow-x: auto; border-radius: 8px; border: 1px solid #eee; margin-top: 15px; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; text-align: center; }
        th { background: #f8fafc; padding: 15px 10px; color: #64748b; font-size: 13px; border-bottom: 2px solid #edf2f7; white-space: nowrap; }
        td { padding: 22px 10px; border-bottom: 1px solid #f1f5f9; font-size: 24px; font-weight: 800; color: #1a202c; white-space: nowrap; }
        
        .val-mid { font-size: 26px; font-weight: 800; display: block; line-height: 1.1; }
        .val-range { font-size: 12px; color: #7f8c8d; background: #f1f5f9; padding: 2px 6px; border-radius: 4px; display: inline-block; margin-top: 4px; font-weight: normal; }

        .fine-box { display: flex; align-items: center; gap: 15px; }
        .fine-select-wrapper { flex: 1; min-width: 200px; }
        .color-badge { display: inline-flex; align-items: center; justify-content: center; padding: 10px 25px; border-radius: 8px; font-size: 20px; font-weight: 900; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); box-shadow: 0 4px 6px rgba(0,0,0,0.1); min-width: 120px; }

        /* Context Notes Styling */
        .context-notes-box { margin-top: 25px; background: #fffbf0; border: 1px solid #fcebbd; border-radius: 8px; padding: 15px 20px; }
        .context-notes-header { font-size: 14px; font-weight: 800; color: #d97706; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
        .context-note-list { list-style: none; padding: 0; margin: 0; }
        .context-note-list li { position: relative; padding-left: 24px; margin-bottom: 8px; font-size: 14px; line-height: 1.6; color: #4b5563; white-space: pre-wrap; }
        .context-note-list li b { position: absolute; left: 0; top: 0; color: #d97706; }

        .note-list { list-style: none; padding: 0; }
        .note-list li { padding: 12px; border-bottom: 1px solid #edf2f7; line-height: 1.6; color: #4a5568; white-space: pre-wrap; }
        .note-list b { color: #2c3e50; margin-right: 5px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Mobile Adjustments */
        @media (max-width: 900px) {
          :root { --sidebar-width: 280px; }
          body { overflow: auto; }
          .sidebar { position: fixed; left: 0; top: 0; height: 100vh; box-shadow: 0 10px 30px rgba(0,0,0,0.25); }
          .sidebar.collapsed { margin-left: calc(-1 * var(--sidebar-width)); }
          .main-wrapper { width: 100vw; }
          .top-bar { position: sticky; top: 0; z-index: 1500; }
          .content-section { padding: 14px; }
          .card { padding: 14px; border-radius: 14px; }
          .query-row { grid-template-columns: 1fr; gap: 12px; }
          select, input { height: 52px; font-size: 17px; border-radius: 10px; }
          table { min-width: 520px; }
          th { padding: 12px 8px; font-size: 12px; }
          td { padding: 16px 8px; font-size: 20px; }
          .val-mid { font-size: 22px; }
          .val-range { font-size: 12px; }
          .fine-box { flex-direction: column; align-items: stretch; gap: 10px; }
          .fine-select-wrapper { width: 100%; }
          .color-badge { width: 100%; min-width: unset; font-size: 18px; padding: 10px 14px; }
          .input-box select, .fine-select-wrapper select { display: none !important; } 

          .input-box .mobile-only, .fine-select-wrapper .mobile-only { display: block !important; }
        }

        /* Mobile Picker */
        .mobile-only { display: none; }
        .picker-btn { width: 100%; height: 52px; border-radius: 10px; border: 1px solid #ddd; background: #fff; font-size: 17px; text-align: left; padding: 0 12px; cursor: pointer; box-sizing: border-box; position: relative; }
        .picker-btn::after { content: "â–¾"; position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #64748b; font-size: 16px; }
        .picker-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.45); display: flex; align-items: flex-end; justify-content: center; z-index: 5000; }
        .picker-modal.hidden { display: none; }
        .picker-sheet { width: 100%; max-width: 640px; background: #fff; border-radius: 16px 16px 0 0; max-height: 78vh; overflow: hidden; box-shadow: 0 -10px 30px rgba(0,0,0,0.25); }
        .picker-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 14px; border-bottom: 1px solid #edf2f7; }
        .picker-title { font-weight: 800; color: #1a202c; }
        .picker-close { border: none; background: #f1f5f9; color: #334155; padding: 10px 12px; border-radius: 10px; font-weight: 700; cursor: pointer; }
        .picker-list { overflow-y: auto; -webkit-overflow-scrolling: touch; max-height: calc(78vh - 58px); }
        .picker-item { padding: 16px 14px; border-bottom: 1px solid #f1f5f9; font-size: 16px; color: #1f2937; cursor: pointer; }
        .picker-item.active { background: #ebf8ff; color: #1d4ed8; font-weight: 800; }

        /* Admin UI */
        .admin-bar { display:none; gap:10px; align-items:center; padding:10px 12px; margin-left:auto; }
        .admin-badge { font-size:12px; font-weight:800; color:#0f172a; background:#fde68a; padding:6px 10px; border-radius:999px; border:1px solid #f59e0b; }
        .admin-date { display:flex; align-items:center; gap:8px; }
        .admin-date label { margin:0; font-size:12px; color:#334155; }
        .admin-date input[type="date"]{ height:38px; font-size:14px; padding:0 10px; border-radius:10px; }
        .btn { border:none; border-radius:10px; padding:8px 12px; font-weight:800; cursor:pointer; font-size: 14px; transition: 0.2s; white-space: nowrap; }
        .btn-primary{ background:#2563eb; color:#fff; }
        .btn-success{ background:#10b981; color:#fff; }
        .btn-warning{ background:#f59e0b; color:#fff; }
        .btn-ghost{ background:#f1f5f9; color:#0f172a; }
        .btn-danger{ background:#fee2e2; color:#ef4444; }
        .btn-danger:hover { background: #ef4444; color: white; }
        .btn:active{ transform: translateY(1px); }

        .admin-panel { display: none; background: #fafafa; border-top: 2px dashed #e2e8f0; padding: 15px; margin-top: 20px; border-radius: 0 0 12px 12px; }
        .admin-panel.active { display: block; animation: fadeIn 0.3s; }
        .admin-hint { font-size: 12px; color: #64748b; margin-bottom: 10px; line-height: 1.5; }
        
        .admin-table-wrap { overflow-x: auto; border: 1px solid #e2e8f0; border-radius: 8px; background: white; max-height: 400px; }
        .admin-table { width: 100%; border-collapse: collapse; min-width: 500px; }
        .admin-table th { background: #f1f5f9; color: #475569; font-size: 12px; padding: 8px; font-weight: bold; border-bottom: 1px solid #cbd5e1; white-space: nowrap; position: sticky; top: 0; z-index: 10;}
        .admin-table td { padding: 6px; border-bottom: 1px solid #f1f5f9; font-size: 13px; color: #334155; vertical-align: middle; white-space: nowrap; }
        
        .admin-input { width: 100%; height: 32px; border: 1px solid #cbd5e1; border-radius: 6px; padding: 0 8px; font-size: 13px; background: #fff; box-sizing: border-box; }
        .admin-input:focus { border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59,130,246,0.1); }
        .admin-textarea { width: 100%; min-height: 60px; border: 1px solid #cbd5e1; border-radius: 6px; padding: 5px; font-size: 13px; font-family: inherit; resize: vertical; }
        .admin-actions-row { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; margin-bottom: 10px; }
        
        /* --- å‚™è¨»æ¨™ç±¤æ¨£å¼ --- */
        .tab-selector-group { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 6px; align-items: center; }
        .tab-chk { position: absolute; opacity: 0; width: 0; height: 0; margin: 0; }
        .tab-chk-label { font-size: 12px; padding: 4px 10px; background: #f1f5f9; color: #64748b; border-radius: 20px; cursor: pointer; border: 1px solid #cbd5e1; user-select: none; transition: all 0.2s; font-weight: 500; }
        .tab-chk-label:hover { background: #e2e8f0; color: #334155; }
        .tab-chk:checked + .tab-chk-label { background: #3b82f6; color: white; border-color: #2563eb; box-shadow: 0 2px 4px rgba(59, 130, 246, 0.3); }

        /* æ‹–æ›³æ‰‹æŠŠèˆ‡ç‹€æ…‹æ¨£å¼ */
        .drag-handle { cursor: grab; color: #94a3b8; font-size: 22px; width: 40px; text-align: center; user-select: none; padding: 0; vertical-align: middle; }
        .drag-handle:active { cursor: grabbing; color: #2563eb; }
        
        /* æ‹–æ›³æ™‚çš„ç›®æ¨™ç·šç´¢ */
        .admin-table tr.drag-over-top { border-top: 3px solid #3b82f6 !important; }
        .admin-table tr.drag-over-bottom { border-bottom: 3px solid #3b82f6 !important; }
        /* æ‹–æ›³ä¸­çš„æœ¬é«”è®ŠåŠé€æ˜ */
        .admin-table tr.dragging { opacity: 0.2; background: #e2e8f0; }

        /* Drag animation (lightweight) */
        .admin-table tr { transition: transform 120ms ease, background-color 120ms ease; }
        .admin-table tr.drop-flash { animation: dropFlash 180ms ease-out; }
        @keyframes dropFlash { from { background: #dbeafe; } to { background: transparent; } }
        /* Clear any inline borders from legacy code */
        .admin-table tr.drag-over-style { border-top: none !important; }

        @media (max-width: 900px){
          .admin-bar{ flex-wrap:wrap; justify-content:flex-end; }
          .admin-date{ width:100%; justify-content:flex-end; }
        }

        /* Modals */
        .admin-modal-backdrop{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.45); z-index:5000; align-items:center; justify-content:center; padding:16px; }
        .admin-modal{ width:min(860px, 100%); max-height: 88vh; overflow:auto; background:#fff; border-radius:16px; box-shadow:0 20px 60px rgba(0,0,0,.25); display: flex; flex-direction: column;}
        .admin-modal header { padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; background: #fff; position: sticky; top: 0; z-index: 10; border-radius: 16px 16px 0 0; }
        .admin-modal .body{ padding:16px; flex: 1; overflow-y: auto; }
        .admin-field textarea{ width:100%; min-height: 220px; border:1px solid #cbd5e1; border-radius:12px; padding:10px; font-family: monospace; }
        .admin-actions { padding: 15px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px; background: #fff; position: sticky; bottom: 0; z-index: 10; border-radius: 0 0 16px 16px; }
    </style>
</head>
<body class="">

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            RT åƒæ•¸å°ç…§æŸ¥è©¢
            <div class="version-tag">ç‰ˆæœ¬æ—¥æœŸ: 20260121</div>
        </div>
        <div class="sidebar-menu">
            <div class="menu-item active" onclick="switchTab('tab-query')">ğŸ” åƒæ•¸ä¸­å€¼æŸ¥è©¢</div>
            <div class="menu-item" onclick="switchTab('tab-stack')">ğŸ“Š ç–Šæ¿ç‰‡æ•¸å°ç…§è¡¨</div>
            <div class="menu-item" onclick="switchTab('tab-fine')">ğŸ”§ ç²—æ²–å¾Œç´°åˆ‡-æ¿å…§æ§½</div>
            <div class="menu-item" onclick="switchTab('tab-feed')">ğŸš€ é‘½å­”é€²åˆ€é€Ÿå°ç…§è¡¨</div>
            <div class="menu-item" onclick="switchTab('tab-life')">â³ åˆ‡åˆ€å£½å‘½è¦å®š</div>
            <div class="menu-item" onclick="switchTab('tab-note')">ğŸ“ å‚™è¨»äº‹é …</div>
        </div>
        <div class="admin-section">
            <button style="background: rgb(52, 73, 94); color: white; width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; display: block;" id="btnAdmin" onclick="toggleAdmin()">âš™ï¸ ç®¡ç†æ¨¡å¼</button>
            <button style="background: rgb(231, 76, 60); color: white; width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; display: none;" id="btnExit" onclick="toggleAdmin()">ğŸšª é€€å‡ºç®¡ç†</button>
        </div>
    </div>

    <div class="main-wrapper">
        <div class="top-bar">
            <span class="hamburger-btn" style="cursor:pointer; font-size:24px; margin-right:15px; color:#2c3e50;" onclick="document.getElementById('sidebar').classList.toggle('collapsed')">â˜°</span>
            <h3 id="currentTitle" style="margin:0; color:#2c3e50;">ğŸ” åƒæ•¸ä¸­å€¼æŸ¥è©¢</h3>
            <div class="admin-bar" id="adminBar">
                <span class="admin-badge">ç®¡ç†æ¨¡å¼</span>
                <div class="admin-date">
                    <label for="verDate">æ›´æ–°ç‰ˆæœ¬æ—¥æœŸ</label>
                    <input id="verDate" type="date">
                </div>
                <button class="btn btn-ghost" onclick="openAdvancedEditor()">JSON ç·¨è¼¯</button>
                <button class="btn btn-primary" onclick="saveAllChanges()">æš«å­˜(æœ¬æ©Ÿ)</button>
                <button class="btn btn-success" onclick="downloadUpdatedHtml()">ğŸ“¥ åŒ¯å‡º HTML (æ°¸ä¹…ä¿å­˜)</button>
            </div>
        </div>

        <section id="tab-query" class="content-section active">
            <div class="card">
                <div class="query-row">
                    <div class="input-box">
                        <label>é¡å‹</label>
                        <select id="typeSelect" onchange="updateSizeList();"><optgroup label="ä¸»è¦å·¥åº"><option value="FF">ç²—åˆ‡ (FF)</option><option value="AA">ç²—åˆ‡ (AA) æ¸…ç²‰</option><option value="RD">å…§æ§½ (RD)ã€é˜»æŠ—æ¢ (CP)</option><option value="G42">å°é–‰æ§½ã€äºŒæ¬¡å­”ã€è€³æœµæ§½ã€è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ (G42)</option><option value="OR">å¤–å‹ (OR)ã€è£é–‹ (HA)</option></optgroup><optgroup label="ç‰¹æ®Šå·¥åº"><option value="RDL">å…§æ§½ (RDL) é€†è½‰åˆ€</option><option value="DA">å°å¼•å­” (DA)</option><option value="DAFF">ç²—åˆ‡å°å¼•å­” (DA FF)</option></optgroup></select>
                        <button type="button" class="picker-btn mobile-only" id="typeSelectBtn" onclick="openPicker('typeSelect','é¸æ“‡é¡å‹')">ç²—åˆ‡ (FF)</button>
                    </div>
                    <div class="input-box">
                        <label>å°ºå¯¸</label>
                        <select id="sizeSelect" onchange="runQuery()"><option value="0.0197">0.0197</option><option value="0.0197 CB">0.0197 CB</option><option value="0.0236">0.0236</option><option value="0.0236 CB">0.0236 CB</option><option value="0.031">0.031</option><option value="0.035">0.035</option><option value="0.039">0.039</option><option value="0.039 CB">0.039 CB</option><option value="0.039 LCB">0.039 LCB</option><option value="0.047">0.047</option><option value="0.047 LCB">0.047 LCB</option><option value="0.055">0.055</option><option value="0.059">0.059</option><option value="0.062">0.062</option><option value="0.079">0.079</option><option value="0.093">0.093</option></select>
                        <button type="button" class="picker-btn mobile-only" id="sizeSelectBtn" onclick="openPicker('sizeSelect','é¸æ“‡å°ºå¯¸')">0.0197</button>
                    </div>
                </div>
                <div class="table-wrap">
                    <table id="mainTable">
                        <thead><tr><th>è½‰é€Ÿ (S)</th><th>é€²åˆ€ (F)</th><th>å£½å‘½ (N)</th><th>è£œå„Ÿ (D)</th><th>æª¯é¢é€Ÿåº¦ (F0X)</th></tr></thead>
                        <tbody id="tableBody"><tr><td>40</td><td>10</td><td>50</td><td>0.0098</td><td>10</td></tr></tbody>
                    </table>
                </div>

                <div class="context-note-area"><div class="context-notes-box">
            <div class="context-notes-header">âš ï¸ æ³¨æ„äº‹é …</div>
            <ul class="context-note-list"><li><b>1.</b> HITGã€LKã€RFã€HFã€EM390åŠEM526æè³ªçš„å„åˆ‡åˆ€åŠå°å¼•å­”ä¸‹é‘½é€Ÿåº¦5~10(ç²—åˆ‡ã€ç²—åˆ‡å°å¼•å­”åŠå¤–å‹é™¤å¤–)ã€‚</li><li><b>2.</b> åˆ‡å…§æ§½ç‚ºéŠ…é¢:
åˆ‡åˆ€31ï½59mil[0.80~1.50mm]å£½å‘½ç”¨50INCHï¼Œ
         62ï½93mil[1.60~2.38mm]å£½å‘½ç”¨100INCHã€‚</li><li><b>3.</b> è—åœ–æœ‰æ¨™ç¤ºâ—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰T Codeæœ‰èµ°G42(å¤–å‹ã€é˜»æŠ—æ¢å¤–) ï¼Œ
åˆ‡åˆ€ 19.7ï½23.6 mil[0.50~0.60mm]å£½å‘½ç”¨30 INCHï¼Œ
         19.7ï½23.6 miléè†œåˆ€[0.50~0.60mm]å£½å‘½ç”¨75 INCHï¼Œ
         31ï½43 mil[0.80~1.10mm]å£½å‘½ç”¨50 INCHï¼Œ
         47ï½59 mil[1.20~1.50mm]å£½å‘½ç”¨80 INCHï¼Œ
         62ï½93 mil[1.60~2.38mm]å£½å‘½ç”¨100 INCHï¼Œ
         39ï½47miléè†œåˆ€[1.00~1.20mm]å£½å‘½ç”¨150 INCHã€‚</li><li><b>4.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€31ï½51mil[0.79~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™~50INCHè¨­å®š,å°é¢é€Ÿåº¦10~30ã€‚</li><li><b>5.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™  ~180INCHè¨­å®šï¼Œå°é¢é€Ÿåº¦10~50 (M57è–„æ¿ç‚º20)ã€‚</li><li><b>6.</b> æ¸…ç²‰åˆ‡åˆ€31ï½51mil[0.80~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦30ã€‚</li><li><b>7.</b> æ¸…ç²‰åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦50 (M57è–„æ¿ç‚º20)ã€‚</li><li><b>8.</b> H30æ–™è™Ÿï¼ˆéè»Ÿç¡¬æ¿ï¼‰ã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€
62 mil[1.60mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚
79 mil[2.00mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚</li><li><b>9.</b> C66æ–™è™Ÿå¤–å‹62mil[1.60mm]åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCHã€‚</li><li><b>10.</b> 39~47mil[1.00~1.20mm]è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„35mil[0.90mm]åˆ‡åˆ€(éœ€æ”¹ç‚º35mil[0.90mm]åˆ‡åˆ€åƒæ•¸)ã€‚</li><li><b>11.</b> C81ã€C91æ–™è™Ÿ39mil[1.00mm]ã€47mil[1.20mm]é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCH</li></ul></div></div>

                <div id="adminPanel-query" class="admin-panel">
                    <div class="admin-hint">
                        æ‹–æ›³ã€Œâ˜°ã€å¯èª¿æ•´å°ºå¯¸é †åºã€‚<br>
                    </div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminParamAddSize()">ï¼‹ æ–°å¢å°ºå¯¸</button>
                        <div style="border-left: 1px solid #cbd5e1; padding-left: 10px; margin-left: 5px; display: flex; gap: 8px;">
                            <button class="btn btn-ghost" onclick="adminParamAddType()">ï¼‹ æ–°å¢é¡å‹</button>
                            <button class="btn btn-ghost" onclick="adminParamRenameType()">âœ ä¿®æ”¹åç¨±</button>
                            <button class="btn btn-danger" onclick="adminParamDeleteType()">ğŸ—‘ï¸ åˆªé™¤é¡å‹</button>
                        </div>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th>å°ºå¯¸ Key (å¯æ”¹å)</th><th>è½‰é€Ÿ (S)</th><th>é€²åˆ€ (F)</th><th>å£½å‘½ (N)</th><th>è£œå„Ÿ (D)</th><th>F0X</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-query"><tr data-key="0.0197"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0197" oninput="adminParamRename(this, '0.0197')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40" oninput="adminParamSet('0.0197','FF',0,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0197','FF',1,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.0197','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0098" oninput="adminParamSet('0.0197','FF',3,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0197','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.0197','FF')">åˆªé™¤</button></td></tr><tr data-key="0.0197 CB"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0197 CB" oninput="adminParamRename(this, '0.0197 CB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40" oninput="adminParamSet('0.0197 CB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0197 CB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="150" oninput="adminParamSet('0.0197 CB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0098" oninput="adminParamSet('0.0197 CB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0197 CB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.0197 CB','FF')">åˆªé™¤</button></td></tr><tr data-key="0.0236"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0236" oninput="adminParamRename(this, '0.0236')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40" oninput="adminParamSet('0.0236','FF',0,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0236','FF',1,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.0236','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0118" oninput="adminParamSet('0.0236','FF',3,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0236','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.0236','FF')">åˆªé™¤</button></td></tr><tr data-key="0.0236 CB"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0236 CB" oninput="adminParamRename(this, '0.0236 CB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40" oninput="adminParamSet('0.0236 CB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0236 CB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="150" oninput="adminParamSet('0.0236 CB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0118" oninput="adminParamSet('0.0236 CB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="10" oninput="adminParamSet('0.0236 CB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.0236 CB','FF')">åˆªé™¤</button></td></tr><tr data-key="0.031"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.031" oninput="adminParamRename(this, '0.031')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.031','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.031','FF',1,this.value)"></td>
                <td><input class="admin-input" value="100" oninput="adminParamSet('0.031','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0155" oninput="adminParamSet('0.031','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.031','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.031','FF')">åˆªé™¤</button></td></tr><tr data-key="0.035"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.035" oninput="adminParamRename(this, '0.035')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.035','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.035','FF',1,this.value)"></td>
                <td><input class="admin-input" value="100" oninput="adminParamSet('0.035','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0175" oninput="adminParamSet('0.035','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.035','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.035','FF')">åˆªé™¤</button></td></tr><tr data-key="0.039"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.039" oninput="adminParamRename(this, '0.039')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.039','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039','FF',1,this.value)"></td>
                <td><input class="admin-input" value="200" oninput="adminParamSet('0.039','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0195" oninput="adminParamSet('0.039','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.039','FF')">åˆªé™¤</button></td></tr><tr data-key="0.039 CB"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.039 CB" oninput="adminParamRename(this, '0.039 CB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.039 CB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039 CB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="700" oninput="adminParamSet('0.039 CB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0195" oninput="adminParamSet('0.039 CB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039 CB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.039 CB','FF')">åˆªé™¤</button></td></tr><tr data-key="0.039 LCB"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.039 LCB" oninput="adminParamRename(this, '0.039 LCB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="33" oninput="adminParamSet('0.039 LCB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039 LCB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="300" oninput="adminParamSet('0.039 LCB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0195" oninput="adminParamSet('0.039 LCB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.039 LCB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.039 LCB','FF')">åˆªé™¤</button></td></tr><tr data-key="0.047"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.047" oninput="adminParamRename(this, '0.047')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.047','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.047','FF',1,this.value)"></td>
                <td><input class="admin-input" value="200" oninput="adminParamSet('0.047','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0235" oninput="adminParamSet('0.047','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.047','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.047','FF')">åˆªé™¤</button></td></tr><tr data-key="0.047 LCB"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.047 LCB" oninput="adminParamRename(this, '0.047 LCB')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.047 LCB','FF',0,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.047 LCB','FF',1,this.value)"></td>
                <td><input class="admin-input" value="300" oninput="adminParamSet('0.047 LCB','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0235" oninput="adminParamSet('0.047 LCB','FF',3,this.value)"></td>
                <td><input class="admin-input" value="12" oninput="adminParamSet('0.047 LCB','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.047 LCB','FF')">åˆªé™¤</button></td></tr><tr data-key="0.055"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.055" oninput="adminParamRename(this, '0.055')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.055','FF',0,this.value)"></td>
                <td><input class="admin-input" value="15" oninput="adminParamSet('0.055','FF',1,this.value)"></td>
                <td><input class="admin-input" value="420" oninput="adminParamSet('0.055','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0275" oninput="adminParamSet('0.055','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.055','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.055','FF')">åˆªé™¤</button></td></tr><tr data-key="0.059"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.059" oninput="adminParamRename(this, '0.059')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.059','FF',0,this.value)"></td>
                <td><input class="admin-input" value="20" oninput="adminParamSet('0.059','FF',1,this.value)"></td>
                <td><input class="admin-input" value="420" oninput="adminParamSet('0.059','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0295" oninput="adminParamSet('0.059','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.059','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.059','FF')">åˆªé™¤</button></td></tr><tr data-key="0.062"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.062" oninput="adminParamRename(this, '0.062')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.062','FF',0,this.value)"></td>
                <td><input class="admin-input" value="30" oninput="adminParamSet('0.062','FF',1,this.value)"></td>
                <td><input class="admin-input" value="520" oninput="adminParamSet('0.062','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0315" oninput="adminParamSet('0.062','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.062','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.062','FF')">åˆªé™¤</button></td></tr><tr data-key="0.079"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.079" oninput="adminParamRename(this, '0.079')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.079','FF',0,this.value)"></td>
                <td><input class="admin-input" value="30" oninput="adminParamSet('0.079','FF',1,this.value)"></td>
                <td><input class="admin-input" value="700" oninput="adminParamSet('0.079','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0395" oninput="adminParamSet('0.079','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.079','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.079','FF')">åˆªé™¤</button></td></tr><tr data-key="0.093"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.093" oninput="adminParamRename(this, '0.093')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="32" oninput="adminParamSet('0.093','FF',0,this.value)"></td>
                <td><input class="admin-input" value="30" oninput="adminParamSet('0.093','FF',1,this.value)"></td>
                <td><input class="admin-input" value="1020" oninput="adminParamSet('0.093','FF',2,this.value)"></td>
                <td><input class="admin-input" value="0.0465" oninput="adminParamSet('0.093','FF',3,this.value)"></td>
                <td><input class="admin-input" value="50" oninput="adminParamSet('0.093','FF',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('0.093','FF')">åˆªé™¤</button></td></tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-stack" class="content-section">
            <div class="card">
                <div class="query-row">
                    <div class="input-box">
                        <label>æœ€å°åˆ‡åˆ€ç›´å¾‘ mil (mm)</label>
                        <select id="stkSizeSel" onchange="updateStackThickList(); runStackQuery()"><option value="15.7 (0.40)">15.7 (0.40)</option><option value="19.7 (0.50)">19.7 (0.50)</option><option value="19.7 LCBRD (0.50)">19.7 LCBRD (0.50)</option><option value="23.6 (0.60)">23.6 (0.60)</option><option value="23.6 LCBRD (0.60)">23.6 LCBRD (0.60)</option><option value="31~35 (0.80-0.90)">31~35 (0.80-0.90)</option><option value="35 LRD (0.90)">35 LRD (0.90)</option><option value="39~55 (0.10-1.40)">39~55 (0.10-1.40)</option><option value="59~98 (1.50-2.50)">59~98 (1.50-2.50)</option><option value="39~47 LCBRD (1.00-1.20)">39~47 LCBRD (1.00-1.20)</option></select>
                        <button type="button" class="picker-btn mobile-only" id="stkSizeSelBtn" onclick="openPicker('stkSizeSel','é¸æ“‡æœ€å°åˆ‡åˆ€ç›´å¾‘')">15.7 (0.40)</button>
                    </div>
                    <div class="input-box">
                        <label>æˆå“æ¿åš</label>
                        <select id="stkThickSel" onchange="runStackQuery()"><option value="9~10">9~10</option><option value="11~13">11~13</option><option value="14~20">14~20</option><option value="21~40">21~40</option></select>
                        <button type="button" class="picker-btn mobile-only" id="stkThickSelBtn" onclick="openPicker('stkThickSel','é¸æ“‡æˆå“æ¿åš')">9~10</button>
                    </div>
                </div>
                
                <div class="context-note-area"></div>

                <div id="adminPanel-stack" class="admin-panel">
                    <div class="admin-hint">
                        ä¿®æ”¹ã€Œè¦å‰‡å­—ä¸²ã€æœƒå³æ™‚æ›´æ–°ä¸‹æ‹‰é¸å–®é †åºã€‚<br>
                        æ ¼å¼ç¯„ä¾‹ï¼š<code>13:9, 9~12:10</code>
                    </div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminStackAdd()">ï¼‹ æ–°å¢å°ºå¯¸è¦å‰‡</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th>å°ºå¯¸ Key (å¯æ”¹å)</th><th>æœ€å¤§åšåº¦æ–‡å­—</th><th>è¦å‰‡å­—ä¸² (ç¯„åœ:ç‰‡æ•¸)</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-stack"><tr data-key="15.7 (0.40)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="15.7 (0.40)" oninput="adminStackRename(this, '15.7 (0.40)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="40 (1.02)" oninput="adminStackSetMax('15.7 (0.40)',this.value)"></td>
                <td><input class="admin-input" value="9~10:4, 11~13:3, 14~20:2, 21~40:1" oninput="adminStackSetOpt('15.7 (0.40)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('15.7 (0.40)')">åˆªé™¤</button></td></tr><tr data-key="19.7 (0.50)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="19.7 (0.50)" oninput="adminStackRename(this, '19.7 (0.50)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="66 (1.68)" oninput="adminStackSetMax('19.7 (0.50)',this.value)"></td>
                <td><input class="admin-input" value="10~16:4, 17~22:3, 23~33:2, 34~66:1" oninput="adminStackSetOpt('19.7 (0.50)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('19.7 (0.50)')">åˆªé™¤</button></td></tr><tr data-key="19.7 LCBRD (0.50)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="19.7 LCBRD (0.50)" oninput="adminStackRename(this, '19.7 LCBRD (0.50)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="86 (2.18)" oninput="adminStackSetMax('19.7 LCBRD (0.50)',this.value)"></td>
                <td><input class="admin-input" value="10~17:5, 18~21:4, 22~28:3, 29~43:2, 44~86:1" oninput="adminStackSetOpt('19.7 LCBRD (0.50)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('19.7 LCBRD (0.50)')">åˆªé™¤</button></td></tr><tr data-key="23.6 (0.60)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="23.6 (0.60)" oninput="adminStackRename(this, '23.6 (0.60)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="88 (2.24)" oninput="adminStackSetMax('23.6 (0.60)',this.value)"></td>
                <td><input class="admin-input" value="15~22:4, 23~29:3, 30~44:2, 45~88:1" oninput="adminStackSetOpt('23.6 (0.60)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('23.6 (0.60)')">åˆªé™¤</button></td></tr><tr data-key="23.6 LCBRD (0.60)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="23.6 LCBRD (0.60)" oninput="adminStackRename(this, '23.6 LCBRD (0.60)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="108 (2.74)" oninput="adminStackSetMax('23.6 LCBRD (0.60)',this.value)"></td>
                <td><input class="admin-input" value="15~21:5, 22~27:4, 28~36:3, 37~54:2, 55~108:1" oninput="adminStackSetOpt('23.6 LCBRD (0.60)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('23.6 LCBRD (0.60)')">åˆªé™¤</button></td></tr><tr data-key="31~35 (0.80-0.90)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="31~35 (0.80-0.90)" oninput="adminStackRename(this, '31~35 (0.80-0.90)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="122 (2.74)" oninput="adminStackSetMax('31~35 (0.80-0.90)',this.value)"></td>
                <td><input class="admin-input" value="9~12:10, 13:9, 14~15:8, 16~17:7, 18~20:6, 21~24:5, 25~30:4, 31~40:3, 41~61:2, 62~122:1" oninput="adminStackSetOpt('31~35 (0.80-0.90)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('31~35 (0.80-0.90)')">åˆªé™¤</button></td></tr><tr data-key="35 LRD (0.90)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="35 LRD (0.90)" oninput="adminStackRename(this, '35 LRD (0.90)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="170 (4.32)" oninput="adminStackSetMax('35 LRD (0.90)',this.value)"></td>
                <td><input class="admin-input" value="15~21:8, 22~24:7, 25~28:6, 29~34:5, 35~42:4, 43~56:3, 57~85:2" oninput="adminStackSetOpt('35 LRD (0.90)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('35 LRD (0.90)')">åˆªé™¤</button></td></tr><tr data-key="39~55 (0.10-1.40)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="39~55 (0.10-1.40)" oninput="adminStackRename(this, '39~55 (0.10-1.40)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="205 (5.21)" oninput="adminStackSetMax('39~55 (0.10-1.40)',this.value)"></td>
                <td><input class="admin-input" value="15~22:8, 23~25:7, 26~30:6, 31~37:5, 38~47:4, 48~64:3, 65~99:2" oninput="adminStackSetOpt('39~55 (0.10-1.40)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('39~55 (0.10-1.40)')">åˆªé™¤</button></td></tr><tr data-key="59~98 (1.50-2.50)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="59~98 (1.50-2.50)" oninput="adminStackRename(this, '59~98 (1.50-2.50)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="259 (6.6)" oninput="adminStackSetMax('59~98 (1.50-2.50)',this.value)"></td>
                <td><input class="admin-input" value="15~18:12, 19~22:10, 23~28:8, 29~33:7, 34~39:6, 40~47:5, 48~60:4, 61~81:3" oninput="adminStackSetOpt('59~98 (1.50-2.50)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('59~98 (1.50-2.50)')">åˆªé™¤</button></td></tr><tr data-key="39~47 LCBRD (1.00-1.20)"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="39~47 LCBRD (1.00-1.20)" oninput="adminStackRename(this, '39~47 LCBRD (1.00-1.20)')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="263 (6.7)" oninput="adminStackSetMax('39~47 LCBRD (1.00-1.20)',this.value)"></td>
                <td><input class="admin-input" value="15~18:12, 19~22:10, 23~28:8, 29~33:7, 34~39:6, 40~47:5, 48~60:4, 61~68:3" oninput="adminStackSetOpt('39~47 LCBRD (1.00-1.20)',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('39~47 LCBRD (1.00-1.20)')">åˆªé™¤</button></td></tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                <div style="background:#f8fafc; padding:25px; border-radius:12px; text-align:center; border:1px solid #edf2f7;"><span style="font-size:13px; color:#64748b; display:block; margin-bottom:10px; font-weight:bold;">å»ºè­°ç–Šæ¿ç‰‡æ•¸</span><span id="stkResCount" style="font-size:36px; font-weight:800; color:#2b6cb0;">4 ç‰‡</span></div>
                <div style="background:#f8fafc; padding:25px; border-radius:12px; text-align:center; border:1px solid #edf2f7;"><span style="font-size:13px; color:#64748b; display:block; margin-bottom:10px; font-weight:bold;">æœ€å¤§ç–Šæ¿åšåº¦ mil (mm)</span><span id="stkResMax" style="font-size:22px; font-weight:800; color:#1a202c;">40 (1.02)</span></div>
            </div>
        </section>

        <section id="tab-fine" class="content-section">
            <div class="card">
                <div class="input-box" style="margin-bottom:20px;">
                    <label>å°ºå¯¸ (mil/mm)</label>
                    <div class="fine-box">
                        <div class="fine-select-wrapper">
                            <select id="fineSizeSel" onchange="runFineQuery()"><option value="0">0.0197"(0.500) (åœŸé»ƒè‰²)</option><option value="1">0.0197" LCBRD(0.500) (è˜‹æœç¶ )</option><option value="2">0.0236"(0.600) (é†¬ç´…è‰²)</option><option value="3">0.0236" LCBRD(0.600) (é»‘è‰²)</option><option value="4">0.031"(0.800) (æ·±è—è‰²)</option><option value="5">0.031" CBRD(0.800) (å’–å•¡è‰²)</option><option value="6">0.031" (é€†)æ¼¢å°(0.800) (é’è‰²)</option><option value="7">0.035"(0.900) (æŸ‘ç´…è‰²)</option><option value="8">0.035" LRD(0.900) (æ·¡ç´«è‰²)</option><option value="9">0.039"(1.000) (å¢¨ç¶ è‰²)</option><option value="10">0.039" CBRD(1.000) (ç²‰ç´…è‰²)</option><option value="11">0.039" (é€†)å°–é»(1.000) (ç™½è‰²)</option><option value="12">0.039" (é€†)æ—­è²¿(1.000) (ç™½è‰²)</option><option value="13">0.0039" LCBRD(1.000) (æ£•ç´…è‰²)</option><option value="14">0.043"(1.100) (æ·¡æ¢¨è‰²)</option><option value="15">0.047"(1.200) (æ·±ç´«è‰²)</option><option value="16">0.047"(1.200) (æ©„æ¬–ç¶ )</option><option value="17">0.047" LCBRD(1.200)(æ·¡æ©˜è‰²)</option><option value="18">0.051"(1.300)(å¡å…¶è‰²)</option><option value="19">0.055"(1.400)(æ·¡è—è‰²)</option><option value="20">0.059"(1.500)(ç°è‰²)</option><option value="21">0.062"(1.600) (å‡é»ƒè‰²)</option><option value="22">0.067"(1.700)(èƒ­è„‚ç´…)</option><option value="23">0.069"(1.750)(è˜‹æœç¶ )</option><option value="24">0.071"(1.800)(å¤©è—è‰²)</option><option value="25">0.075"(1.900)(æ¡ƒç´…è‰²)</option><option value="26">0.079"(2.000)(å¤§ç´…è‰²)</option><option value="27">0.093"(2.380)(ç™½è‰²)</option><option value="28">0.098"(2.500) (æ¾æ¨¹ç¶ )</option></select>
                            <button type="button" class="picker-btn mobile-only" id="fineSizeSelBtn" onclick="openPicker('fineSizeSel','é¸æ“‡å°ºå¯¸')">0.0197"(0.500) (åœŸé»ƒè‰²)</button>
                        </div>
                        <div id="fineBadge" class="color-badge" style="background-color: rgb(212, 160, 23);">åœŸé»ƒè‰²</div>
                    </div>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead><tr><th>è½‰é€Ÿ (S)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>é€²åˆ€é€Ÿ (F)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>æª¯é¢é€Ÿåº¦ (F)<br><small>ä¸­å€¼ (ç¯„åœ)</small></th><th>è£œå„Ÿå€¼ (D)<br><small>å¯èª¿æ•´ç¯„åœ</small></th></tr></thead>
                        <tbody id="fineTableBody"><tr><td><span class="val-mid">40</span><span class="val-range">30~45</span></td><td><span class="val-mid">8</span><span class="val-range">5~10</span></td><td><span class="val-mid">8</span><span class="val-range">5~10</span></td><td><span class="val-mid">0.0098</span><span class="val-range">+/-0.003"</span></td></tr></tbody>
                    </table>
                </div>

                <div class="context-note-area"></div>

                <div id="adminPanel-fine" class="admin-panel">
                    <div class="admin-hint">ä¿®æ”¹ã€Œå°ºå¯¸æ¨™ç±¤ã€æœƒå³æ™‚åŒæ­¥ä¸Šæ–¹é¸å–®ã€‚</div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminFineAdd()">ï¼‹ æ–°å¢ç´°åˆ‡è¦å‰‡</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th>å°ºå¯¸æ¨™ç±¤ (mil/mm)</th><th>é¡è‰²</th><th>è½‰é€Ÿ(ä¸­/ç¯„)</th><th>é€²åˆ€(ä¸­/ç¯„)</th><th>æª¯é¢(ä¸­/ç¯„)</th><th>è£œå„Ÿ(ä¸­/ç¯„)</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-fine"><tr data-idx="0"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0197&quot;(0.500) (åœŸé»ƒè‰²)" oninput="adminFineSetLabel(0,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-0" class="admin-input" value="åœŸé»ƒè‰²" oninput="adminFineSetColor(0,this.value)" style="width:80px;"><input id="fineColorHex-0" type="color" value="#D4A017" onchange="adminFineSetColorHex(0,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(0,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="30~45" oninput="adminFineSet(0,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(0,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(0,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(0,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(0,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0098" oninput="adminFineSet(0,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(0,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(0)">åˆª</button></td></tr><tr data-idx="1"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0197&quot; LCBRD(0.500) (è˜‹æœç¶ )" oninput="adminFineSetLabel(1,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-1" class="admin-input" value="è˜‹æœç¶ " oninput="adminFineSetColor(1,this.value)" style="width:80px;"><input id="fineColorHex-1" type="color" value="#8DB600" onchange="adminFineSetColorHex(1,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="45" oninput="adminFineSet(1,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="40~55" oninput="adminFineSet(1,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(1,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(1,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(1,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(1,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0098" oninput="adminFineSet(1,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(1,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(1)">åˆª</button></td></tr><tr data-idx="2"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0236&quot;(0.600) (é†¬ç´…è‰²)" oninput="adminFineSetLabel(2,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-2" class="admin-input" value="é†¬ç´…è‰²" oninput="adminFineSetColor(2,this.value)" style="width:80px;"><input id="fineColorHex-2" type="color" value="#800000" onchange="adminFineSetColorHex(2,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(2,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="30~45" oninput="adminFineSet(2,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(2,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(2,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(2,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(2,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0118" oninput="adminFineSet(2,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(2,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(2)">åˆª</button></td></tr><tr data-idx="3"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0236&quot; LCBRD(0.600) (é»‘è‰²)" oninput="adminFineSetLabel(3,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-3" class="admin-input" value="é»‘è‰²" oninput="adminFineSetColor(3,this.value)" style="width:80px;"><input id="fineColorHex-3" type="color" value="#000000" onchange="adminFineSetColorHex(3,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(3,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="30~50" oninput="adminFineSet(3,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(3,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(3,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="8" oninput="adminFineSet(3,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(3,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0118" oninput="adminFineSet(3,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(3,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(3)">åˆª</button></td></tr><tr data-idx="4"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.031&quot;(0.800) (æ·±è—è‰²)" oninput="adminFineSetLabel(4,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-4" class="admin-input" value="æ·±è—è‰²" oninput="adminFineSetColor(4,this.value)" style="width:80px;"><input id="fineColorHex-4" type="color" value="#00008B" onchange="adminFineSetColorHex(4,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(4,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~40" oninput="adminFineSet(4,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(4,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(4,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(4,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(4,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0155" oninput="adminFineSet(4,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(4,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(4)">åˆª</button></td></tr><tr data-idx="5"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.031&quot; CBRD(0.800) (å’–å•¡è‰²)" oninput="adminFineSetLabel(5,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-5" class="admin-input" value="å’–å•¡è‰²" oninput="adminFineSetColor(5,this.value)" style="width:80px;"><input id="fineColorHex-5" type="color" value="#6F4E37" onchange="adminFineSetColorHex(5,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="55" oninput="adminFineSet(5,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="40~55" oninput="adminFineSet(5,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(5,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(5,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(5,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(5,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0155" oninput="adminFineSet(5,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(5,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(5)">åˆª</button></td></tr><tr data-idx="6"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.031&quot; (é€†)æ¼¢å°(0.800) (é’è‰²)" oninput="adminFineSetLabel(6,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-6" class="admin-input" value="é’è‰²" oninput="adminFineSetColor(6,this.value)" style="width:80px;"><input id="fineColorHex-6" type="color" value="#00CED1" onchange="adminFineSetColorHex(6,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="-30" oninput="adminFineSet(6,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="-30" oninput="adminFineSet(6,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(6,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="5~10" oninput="adminFineSet(6,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(6,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~10" oninput="adminFineSet(6,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0155" oninput="adminFineSet(6,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(6,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(6)">åˆª</button></td></tr><tr data-idx="7"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.035&quot;(0.900) (æŸ‘ç´…è‰²)" oninput="adminFineSetLabel(7,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-7" class="admin-input" value="æŸ‘ç´…è‰²" oninput="adminFineSetColor(7,this.value)" style="width:80px;"><input id="fineColorHex-7" type="color" value="#FF4500" onchange="adminFineSetColorHex(7,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(7,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~40" oninput="adminFineSet(7,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(7,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(7,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(7,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(7,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0175" oninput="adminFineSet(7,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(7,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(7)">åˆª</button></td></tr><tr data-idx="8"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.035&quot; LRD(0.900) (æ·¡ç´«è‰²)" oninput="adminFineSetLabel(8,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-8" class="admin-input" value="æ·¡ç´«è‰²" oninput="adminFineSetColor(8,this.value)" style="width:80px;"><input id="fineColorHex-8" type="color" value="#E6E6FA" onchange="adminFineSetColorHex(8,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(8,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~40" oninput="adminFineSet(8,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(8,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(8,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(8,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(8,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0175" oninput="adminFineSet(8,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(8,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(8)">åˆª</button></td></tr><tr data-idx="9"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.039&quot;(1.000) (å¢¨ç¶ è‰²)" oninput="adminFineSetLabel(9,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-9" class="admin-input" value="å¢¨ç¶ è‰²" oninput="adminFineSetColor(9,this.value)" style="width:80px;"><input id="fineColorHex-9" type="color" value="#006400" onchange="adminFineSetColorHex(9,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(9,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~40" oninput="adminFineSet(9,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(9,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(9,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(9,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(9,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(9,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(9,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(9)">åˆª</button></td></tr><tr data-idx="10"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.039&quot; CBRD(1.000) (ç²‰ç´…è‰²)" oninput="adminFineSetLabel(10,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-10" class="admin-input" value="ç²‰ç´…è‰²" oninput="adminFineSetColor(10,this.value)" style="width:80px;"><input id="fineColorHex-10" type="color" value="#FF69B4" onchange="adminFineSetColorHex(10,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(10,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~50" oninput="adminFineSet(10,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(10,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(10,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(10,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(10,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(10,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(10,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(10)">åˆª</button></td></tr><tr data-idx="11"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.039&quot; (é€†)å°–é»(1.000) (ç™½è‰²)" oninput="adminFineSetLabel(11,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-11" class="admin-input" value="ç™½è‰²" oninput="adminFineSetColor(11,this.value)" style="width:80px;"><input id="fineColorHex-11" type="color" value="#FFFFFF" onchange="adminFineSetColorHex(11,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="-30" oninput="adminFineSet(11,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="-25~-40" oninput="adminFineSet(11,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(11,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(11,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(11,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(11,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(11,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(11,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(11)">åˆª</button></td></tr><tr data-idx="12"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.039&quot; (é€†)æ—­è²¿(1.000) (ç™½è‰²)" oninput="adminFineSetLabel(12,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-12" class="admin-input" value="ç™½è‰²" oninput="adminFineSetColor(12,this.value)" style="width:80px;"><input id="fineColorHex-12" type="color" value="#FFFFFF" onchange="adminFineSetColorHex(12,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="-30" oninput="adminFineSet(12,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="-25~-40" oninput="adminFineSet(12,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(12,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(12,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(12,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(12,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(12,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(12,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(12)">åˆª</button></td></tr><tr data-idx="13"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.0039&quot; LCBRD(1.000) (æ£•ç´…è‰²)" oninput="adminFineSetLabel(13,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-13" class="admin-input" value="æ£•ç´…è‰²" oninput="adminFineSetColor(13,this.value)" style="width:80px;"><input id="fineColorHex-13" type="color" value="#A52A2A" onchange="adminFineSetColorHex(13,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(13,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~50" oninput="adminFineSet(13,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(13,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(13,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(13,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(13,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0195" oninput="adminFineSet(13,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(13,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(13)">åˆª</button></td></tr><tr data-idx="14"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.043&quot;(1.100) (æ·¡æ¢¨è‰²)" oninput="adminFineSetLabel(14,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-14" class="admin-input" value="æ·¡æ¢¨è‰²" oninput="adminFineSetColor(14,this.value)" style="width:80px;"><input id="fineColorHex-14" type="color" value="#F0EAD6" onchange="adminFineSetColorHex(14,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(14,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~40" oninput="adminFineSet(14,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(14,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(14,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(14,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(14,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0215" oninput="adminFineSet(14,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(14,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(14)">åˆª</button></td></tr><tr data-idx="15"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.047&quot;(1.200) (æ·±ç´«è‰²)" oninput="adminFineSetLabel(15,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-15" class="admin-input" value="æ·±ç´«è‰²" oninput="adminFineSetColor(15,this.value)" style="width:80px;"><input id="fineColorHex-15" type="color" value="#800080" onchange="adminFineSetColorHex(15,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(15,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~40" oninput="adminFineSet(15,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(15,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(15,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(15,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~25" oninput="adminFineSet(15,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0235" oninput="adminFineSet(15,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(15,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(15)">åˆª</button></td></tr><tr data-idx="16"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.047&quot;(1.200) (æ©„æ¬–ç¶ )" oninput="adminFineSetLabel(16,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-16" class="admin-input" value="æ©„æ¬–ç¶ " oninput="adminFineSetColor(16,this.value)" style="width:80px;"><input id="fineColorHex-16" type="color" value="#6B8E23" onchange="adminFineSetColorHex(16,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(16,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~40" oninput="adminFineSet(16,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(16,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(16,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(16,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~25" oninput="adminFineSet(16,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0235" oninput="adminFineSet(16,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(16,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(16)">åˆª</button></td></tr><tr data-idx="17"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.047&quot; LCBRD(1.200)(æ·¡æ©˜è‰²)" oninput="adminFineSetLabel(17,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-17" class="admin-input" value="æ·¡æ©˜è‰²" oninput="adminFineSetColor(17,this.value)" style="width:80px;"><input id="fineColorHex-17" type="color" value="#FFB84D" onchange="adminFineSetColorHex(17,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(17,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~50" oninput="adminFineSet(17,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="15" oninput="adminFineSet(17,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(17,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="10" oninput="adminFineSet(17,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~20" oninput="adminFineSet(17,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0235&quot;" oninput="adminFineSet(17,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(17,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(17)">åˆª</button></td></tr><tr data-idx="18"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.051&quot;(1.300)(å¡å…¶è‰²)" oninput="adminFineSetLabel(18,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-18" class="admin-input" value="å¡å…¶è‰²" oninput="adminFineSetColor(18,this.value)" style="width:80px;"><input id="fineColorHex-18" type="color" value="#F0E68C" onchange="adminFineSetColorHex(18,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(18,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~35" oninput="adminFineSet(18,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(18,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(18,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(18,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~25" oninput="adminFineSet(18,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0255&quot;" oninput="adminFineSet(18,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(18,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(18)">åˆª</button></td></tr><tr data-idx="19"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.055&quot;(1.400)(æ·¡è—è‰²)" oninput="adminFineSetLabel(19,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-19" class="admin-input" value="æ·¡è—è‰²" oninput="adminFineSetColor(19,this.value)" style="width:80px;"><input id="fineColorHex-19" type="color" value="#ADD8E6" onchange="adminFineSetColorHex(19,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(19,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~35" oninput="adminFineSet(19,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(19,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~35" oninput="adminFineSet(19,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(19,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~27" oninput="adminFineSet(19,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0275&quot;" oninput="adminFineSet(19,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(19,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(19)">åˆª</button></td></tr><tr data-idx="20"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.059&quot;(1.500)(ç°è‰²)" oninput="adminFineSetLabel(20,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-20" class="admin-input" value="ç°è‰²" oninput="adminFineSetColor(20,this.value)" style="width:80px;"><input id="fineColorHex-20" type="color" value="#808080" onchange="adminFineSetColorHex(20,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(20,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~35" oninput="adminFineSet(20,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(20,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~35" oninput="adminFineSet(20,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="20" oninput="adminFineSet(20,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~27" oninput="adminFineSet(20,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0295&quot;" oninput="adminFineSet(20,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(20,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(20)">åˆª</button></td></tr><tr data-idx="21"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.062&quot;(1.600) (å‡é»ƒè‰²)" oninput="adminFineSetLabel(21,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-21" class="admin-input" value="å‡é»ƒè‰²" oninput="adminFineSetColor(21,this.value)" style="width:80px;"><input id="fineColorHex-21" type="color" value="#F0E68C" onchange="adminFineSetColorHex(21,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(21,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="18~35" oninput="adminFineSet(21,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(21,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(21,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="25" oninput="adminFineSet(21,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(21,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0315" oninput="adminFineSet(21,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(21,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(21)">åˆª</button></td></tr><tr data-idx="22"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.067&quot;(1.700)(èƒ­è„‚ç´…)" oninput="adminFineSetLabel(22,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-22" class="admin-input" value="èƒ­è„‚ç´…" oninput="adminFineSetColor(22,this.value)" style="width:80px;"><input id="fineColorHex-22" type="color" value="#C71585" onchange="adminFineSetColorHex(22,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(22,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~35" oninput="adminFineSet(22,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(22,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(22,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="25" oninput="adminFineSet(22,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(22,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0335&quot;" oninput="adminFineSet(22,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(22,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(22)">åˆª</button></td></tr><tr data-idx="23"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.069&quot;(1.750)(è˜‹æœç¶ )" oninput="adminFineSetLabel(23,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-23" class="admin-input" value="è˜‹æœç¶ " oninput="adminFineSetColor(23,this.value)" style="width:80px;"><input id="fineColorHex-23" type="color" value="#8DB600" onchange="adminFineSetColorHex(23,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(23,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~35" oninput="adminFineSet(23,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(23,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(23,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="25" oninput="adminFineSet(23,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(23,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0345&quot;" oninput="adminFineSet(23,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(23,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(23)">åˆª</button></td></tr><tr data-idx="24"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.071&quot;(1.800)(å¤©è—è‰²)" oninput="adminFineSetLabel(24,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-24" class="admin-input" value="å¤©è—è‰²" oninput="adminFineSetColor(24,this.value)" style="width:80px;"><input id="fineColorHex-24" type="color" value="#87CEEB" onchange="adminFineSetColorHex(24,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(24,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~35" oninput="adminFineSet(24,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(24,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(24,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="25" oninput="adminFineSet(24,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~30" oninput="adminFineSet(24,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0355&quot;" oninput="adminFineSet(24,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(24,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(24)">åˆª</button></td></tr><tr data-idx="25"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.075&quot;(1.900)(æ¡ƒç´…è‰²)" oninput="adminFineSetLabel(25,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-25" class="admin-input" value="æ¡ƒç´…è‰²" oninput="adminFineSetColor(25,this.value)" style="width:80px;"><input id="fineColorHex-25" type="color" value="#FF69B4" onchange="adminFineSetColorHex(25,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(25,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="25~35" oninput="adminFineSet(25,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(25,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(25,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(25,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~35" oninput="adminFineSet(25,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0375&quot;" oninput="adminFineSet(25,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(25,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(25)">åˆª</button></td></tr><tr data-idx="26"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.079&quot;(2.000)(å¤§ç´…è‰²)" oninput="adminFineSetLabel(26,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-26" class="admin-input" value="å¤§ç´…è‰²" oninput="adminFineSetColor(26,this.value)" style="width:80px;"><input id="fineColorHex-26" type="color" value="#FF0000" onchange="adminFineSetColorHex(26,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(26,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="20~35" oninput="adminFineSet(26,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(26,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(26,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="30" oninput="adminFineSet(26,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~35" oninput="adminFineSet(26,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0395&quot;" oninput="adminFineSet(26,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(26,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(26)">åˆª</button></td></tr><tr data-idx="27"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.093&quot;(2.380)(ç™½è‰²)" oninput="adminFineSetLabel(27,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-27" class="admin-input" value="ç™½è‰²" oninput="adminFineSetColor(27,this.value)" style="width:80px;"><input id="fineColorHex-27" type="color" value="#FFFFFF" onchange="adminFineSetColorHex(27,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(27,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="18~30" oninput="adminFineSet(27,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(27,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(27,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(27,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~45" oninput="adminFineSet(27,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0490&quot;" oninput="adminFineSet(27,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(27,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(27)">åˆª</button></td></tr><tr data-idx="28"><td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="0.098&quot;(2.500) (æ¾æ¨¹ç¶ )" oninput="adminFineSetLabel(28,this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-28" class="admin-input" value="æ¾æ¨¹ç¶ " oninput="adminFineSetColor(28,this.value)" style="width:80px;"><input id="fineColorHex-28" type="color" value="#01796F" onchange="adminFineSetColorHex(28,this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td><input class="admin-input" style="width:60px" value="28" oninput="adminFineSet(28,'s',0,this.value)"> / <input class="admin-input" style="width:60px" value="18~30" oninput="adminFineSet(28,'s',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="35" oninput="adminFineSet(28,'f',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~40" oninput="adminFineSet(28,'f',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="40" oninput="adminFineSet(28,'t',0,this.value)"> / <input class="admin-input" style="width:60px" value="10~45" oninput="adminFineSet(28,'t',1,this.value)"></td><td><input class="admin-input" style="width:60px" value="0.0490" oninput="adminFineSet(28,'d',0,this.value)"> / <input class="admin-input" style="width:60px" value="+/-0.003&quot;" oninput="adminFineSet(28,'d',1,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminFineDel(28)">åˆª</button></td></tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-feed" class="content-section">
            <div class="card">
                <div class="input-box" style="margin-bottom:20px;">
                    <label>é‘½é ­ç›´å¾‘ (inch/mm)</label>
                    <select id="feedSizeSel" style="width:300px;" onchange="runFeedQuery()"><option value="0">0.0279" ä»¥ä¸‹</option><option value="1">0.0280"~0.0429"</option><option value="2">0.0430"~0.0865"</option><option value="3">0.0866"~0.1014"</option><option value="4">0.1015"~0.1259"</option><option value="5">0.1260"~0.1456"</option><option value="6">0.1457" ä»¥ä¸Š</option></select>
                    <button type="button" class="picker-btn mobile-only" id="feedSizeSelBtn" onclick="openPicker('feedSizeSel','é¸æ“‡ç›´å¾‘')">0.0279" ä»¥ä¸‹</button>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr><th>è½‰é€Ÿ (S)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th><th style="background:#ebf8ff; color:#2b6cb0;">å°å¼•å­” (F)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th><th style="background:#f0fff4; color:#2f855a;">äºŒæ¬¡å­” (F)<br><small>åƒè€ƒå€¼ (ç¯„åœ)</small></th><th>å£½å‘½ (N)</th></tr>
                        </thead>
                        <tbody id="feedTableBody"><tr><td><span class="val-mid">30</span><span class="val-range">20~40</span></td><td style="background:#ebf8ff;"><span class="val-mid" style="color:#2b6cb0;">20</span><span class="val-range">10~20</span></td><td style="background:#f0fff4;"><span class="val-mid" style="color:#2f855a;">10</span><span class="val-range">10~20</span></td><td><span class="val-mid">1500</span></td></tr></tbody>
                    </table>
                </div>

                 <div class="context-note-area"></div>

                 <div id="adminPanel-feed" class="admin-panel">
                    <div class="admin-hint">ä¿®æ”¹ã€Œç›´å¾‘æ¨™ç±¤ã€æœƒå³æ™‚åŒæ­¥ä¸Šæ–¹é¸å–®ã€‚</div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminFeedAdd()">ï¼‹ æ–°å¢é€²åˆ€è¦å‰‡</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th>ç›´å¾‘æ¨™ç±¤ (inch/mm)</th><th>è½‰é€Ÿ(åƒ/ç¯„)</th><th>å°å¼•å­”(åƒ/ç¯„)</th><th>äºŒæ¬¡å­”(åƒ/ç¯„)</th><th>å£½å‘½</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-feed"><tr data-idx="0"><td class="drag-handle" draggable="true">â˜°</td><td><input class="admin-input" value="0.0279&quot; ä»¥ä¸‹" oninput="adminFeedSetLabel(0,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="30" oninput="adminFeedSet(0,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~40" oninput="adminFeedSet(0,'s',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="20" oninput="adminFeedSet(0,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(0,'pF',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(0,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(0,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(0,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(0)">åˆª</button></td></tr><tr data-idx="1"><td class="drag-handle" draggable="true">â˜°</td><td><input class="admin-input" value="0.0280&quot;~0.0429&quot;" oninput="adminFeedSetLabel(1,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="30" oninput="adminFeedSet(1,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~40" oninput="adminFeedSet(1,'s',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="30" oninput="adminFeedSet(1,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~30" oninput="adminFeedSet(1,'pF',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(1,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(1,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(1,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(1)">åˆª</button></td></tr><tr data-idx="2"><td class="drag-handle" draggable="true">â˜°</td><td><input class="admin-input" value="0.0430&quot;~0.0865&quot;" oninput="adminFeedSetLabel(2,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="30" oninput="adminFeedSet(2,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~40" oninput="adminFeedSet(2,'s',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="40" oninput="adminFeedSet(2,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~40" oninput="adminFeedSet(2,'pF',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(2,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(2,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(2,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(2)">åˆª</button></td></tr><tr data-idx="3"><td class="drag-handle" draggable="true">â˜°</td><td><input class="admin-input" value="0.0866&quot;~0.1014&quot;" oninput="adminFeedSetLabel(3,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="25" oninput="adminFeedSet(3,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~35" oninput="adminFeedSet(3,'s',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="50" oninput="adminFeedSet(3,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~50" oninput="adminFeedSet(3,'pF',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(3,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(3,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(3,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(3)">åˆª</button></td></tr><tr data-idx="4"><td class="drag-handle" draggable="true">â˜°</td><td><input class="admin-input" value="0.1015&quot;~0.1259&quot;" oninput="adminFeedSetLabel(4,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="25" oninput="adminFeedSet(4,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="20~35" oninput="adminFeedSet(4,'s',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="40" oninput="adminFeedSet(4,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~40" oninput="adminFeedSet(4,'pF',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(4,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(4,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(4,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(4)">åˆª</button></td></tr><tr data-idx="5"><td class="drag-handle" draggable="true">â˜°</td><td><input class="admin-input" value="0.1260&quot;~0.1456&quot;" oninput="adminFeedSetLabel(5,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="20" oninput="adminFeedSet(5,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="15~25" oninput="adminFeedSet(5,'s',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="20" oninput="adminFeedSet(5,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(5,'pF',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(5,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(5,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(5,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(5)">åˆª</button></td></tr><tr data-idx="6"><td class="drag-handle" draggable="true">â˜°</td><td><input class="admin-input" value="0.1457&quot; ä»¥ä¸Š" oninput="adminFeedSetLabel(6,this.value)" style="width:120px;"></td>
                <td><input class="admin-input" style="width:50px" value="20" oninput="adminFeedSet(6,'s',0,this.value)"> / <input class="admin-input" style="width:50px" value="15~25" oninput="adminFeedSet(6,'s',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(6,'pF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~15" oninput="adminFeedSet(6,'pF',1,this.value)"></td><td><input class="admin-input" style="width:50px" value="10" oninput="adminFeedSet(6,'sF',0,this.value)"> / <input class="admin-input" style="width:50px" value="10~20" oninput="adminFeedSet(6,'sF',1,this.value)"></td>
                <td><input class="admin-input" value="1500" oninput="adminFeedSetLife(6,this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(6)">åˆª</button></td></tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-life" class="content-section">
            <div class="card">
                <div class="query-row">
                    <div class="input-box">
                        <label>1. é¸æ“‡ç›´å¾‘ inch (mm)</label>
                        <select id="lifeSizeSel" onchange="updateLifeTypeList()"><option value="0.0197&quot; (0.500mm)">0.0197" (0.500mm)</option><option value="0.0236&quot; (0.600mm)">0.0236" (0.600mm)</option><option value="0.031&quot; (0.800mm)">0.031" (0.800mm)</option><option value="0.031&quot; é€†è½‰åˆ€ (0.800mm)">0.031" é€†è½‰åˆ€ (0.800mm)</option><option value="0.035&quot; (0.900mm)">0.035" (0.900mm)</option><option value="0.039&quot; (1.000mm)">0.039" (1.000mm)</option><option value="0.039&quot; é€†è½‰åˆ€ (1.000mm)">0.039" é€†è½‰åˆ€ (1.000mm)</option><option value="0.043&quot; (1.100mm)">0.043" (1.100mm)</option><option value="0.047&quot; (1.200mm)">0.047" (1.200mm)</option><option value="0.051&quot;(1.300)">0.051"(1.300)</option><option value="0.055&quot;(1.400)">0.055"(1.400)</option><option value="0.059&quot;(1.500)">0.059"(1.500)</option><option value="0.062&quot;(1.600)">0.062"(1.600)</option><option value="0.067&quot;(1.700)">0.067"(1.700)</option><option value="0.069&quot;(1.750)">0.069"(1.750)</option><option value="0.071&quot;(1.800)">0.071"(1.800)</option><option value="0.075&quot;(1.900)">0.075"(1.900)</option><option value="0.079&quot;(2.000) (å…§æ§½)">0.079"(2.000) (å…§æ§½)</option><option value="0.079&quot;(2.000) (å¤–å‹)">0.079"(2.000) (å¤–å‹)</option><option value="0.093&quot;(2.380) (å…§æ§½)">0.093"(2.380) (å…§æ§½)</option><option value="0.093&quot;(2.380) (å¤–å‹)">0.093"(2.380) (å¤–å‹)</option><option value="0.098&quot;(2.500) (å…§æ§½)">0.098"(2.500) (å…§æ§½)</option></select>
                        <button type="button" class="picker-btn mobile-only" id="lifeSizeBtn" onclick="openPicker('lifeSizeSel','é¸æ“‡ç›´å¾‘')">0.0197" (0.500mm)</button>
                    </div>
                    <div class="input-box">
                        <label>2. é¸æ“‡å‹æ…‹</label>
                        <select id="lifeTypeSel" onchange="runLifeQuery()"><option value="éè†œåˆ€">éè†œåˆ€</option><option value="ä¸€èˆ¬åˆ€">ä¸€èˆ¬åˆ€</option></select>
                        <button type="button" class="picker-btn mobile-only" id="lifeTypeBtn" onclick="openPicker('lifeTypeSel','é¸æ“‡å‹æ…‹')">éè†œåˆ€</button>
                    </div>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr><th style="width:50%;">æ™®é€šæè³ª</th><th style="background:#fff7ed; color:#c2410c; border-bottom: 2px solid #fdba74;">å…¶ä»–æè³ª</th></tr>
                        </thead>
                        <tbody id="lifeTableBody"><tr>
            <td><span class="val-mid">150</span><span class="val-range">100~150</span></td>
            <td style="background:#fff7ed;"><span class="val-mid" style="color:#c2410c;">150</span><span class="val-range">100~150</span></td>
        </tr></tbody>
                    </table>
                </div>

                <div class="context-note-area"><div class="context-notes-box">
            <div class="context-notes-header">âš ï¸ æ³¨æ„äº‹é …</div>
            <ul class="context-note-list"><li><b>1.</b> åˆ‡å…§æ§½ç‚ºéŠ…é¢:
åˆ‡åˆ€31ï½59mil[0.80~1.50mm]å£½å‘½ç”¨50INCHï¼Œ
         62ï½93mil[1.60~2.38mm]å£½å‘½ç”¨100INCHã€‚</li><li><b>2.</b> è—åœ–æœ‰æ¨™ç¤ºâ—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰T Codeæœ‰èµ°G42(å¤–å‹ã€é˜»æŠ—æ¢å¤–) ï¼Œ
åˆ‡åˆ€ 19.7ï½23.6 mil[0.50~0.60mm]å£½å‘½ç”¨30 INCHï¼Œ
         19.7ï½23.6 miléè†œåˆ€[0.50~0.60mm]å£½å‘½ç”¨75 INCHï¼Œ
         31ï½43 mil[0.80~1.10mm]å£½å‘½ç”¨50 INCHï¼Œ
         47ï½59 mil[1.20~1.50mm]å£½å‘½ç”¨80 INCHï¼Œ
         62ï½93 mil[1.60~2.38mm]å£½å‘½ç”¨100 INCHï¼Œ
         39ï½47miléè†œåˆ€[1.00~1.20mm]å£½å‘½ç”¨150 INCHã€‚</li><li><b>3.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€31ï½51mil[0.79~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™~50INCHè¨­å®š,å°é¢é€Ÿåº¦10~30ã€‚</li><li><b>4.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™  ~180INCHè¨­å®šï¼Œå°é¢é€Ÿåº¦10~50 (M57è–„æ¿ç‚º20)ã€‚</li><li><b>5.</b> æ¸…ç²‰åˆ‡åˆ€31ï½51mil[0.80~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦30ã€‚</li><li><b>6.</b> H30æ–™è™Ÿï¼ˆéè»Ÿç¡¬æ¿ï¼‰ã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€
62 mil[1.60mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚
79 mil[2.00mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚</li><li><b>7.</b> C66æ–™è™Ÿå¤–å‹62mil[1.60mm]åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCHã€‚</li><li><b>8.</b> 39~47mil[1.00~1.20mm]è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„35mil[0.90mm]åˆ‡åˆ€(éœ€æ”¹ç‚º35mil[0.90mm]åˆ‡åˆ€åƒæ•¸)ã€‚</li><li><b>9.</b> C81ã€C91æ–™è™Ÿ39mil[1.00mm]ã€47mil[1.20mm]é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCH</li></ul></div></div>

                <div id="adminPanel-life" class="admin-panel">
                    <div class="admin-hint">é»æ“Šã€Œâ‡… èª¿æ•´ç›´å¾‘é †åºã€å¯ç›´è§€èª¿æ•´ä¸‹æ‹‰é¸å–®çš„é †åºã€‚</div>
                    <div class="admin-actions-row">
                        <button type="button" class="btn btn-primary" onclick="adminLifeAddSize()">ï¼‹ æ–°å¢ç›´å¾‘</button>
                        <button type="button" class="btn btn-danger" onclick="adminLifeDeleteSize()">åˆªé™¤ç›®å‰ç›´å¾‘</button>
                        <button type="button" class="btn btn-warning" onclick="adminLifeRenameSize()">âœ ä¿®æ”¹ç›´å¾‘åç¨±</button>
                        <button type="button" class="btn btn-ghost" onclick="adminLifeOpenReorder()">â‡… èª¿æ•´ç›´å¾‘é †åº</button>
                        <button type="button" class="btn btn-ghost" onclick="adminLifeAddType()">ï¼‹ æ–°å¢å‹æ…‹</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:20px;"></th><th>å‹æ…‹</th><th>æ™®é€š-ä¸­å€¼</th><th>æ™®é€š-ç¯„åœ</th><th>å…¶ä»–æè³ª-ä¸­å€¼</th><th>å…¶ä»–æè³ª-ç¯„åœ</th><th>æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-life"><tr data-key="éè†œåˆ€"><td class="drag-handle" draggable="true">â˜°</td><td style="font-weight: bold;">éè†œåˆ€</td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><button class="btn btn-danger">åˆªé™¤</button></td></tr><tr data-key="ä¸€èˆ¬åˆ€"><td class="drag-handle" draggable="true">â˜°</td><td style="font-weight: bold;">ä¸€èˆ¬åˆ€</td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><input class="admin-input"></td><td><button class="btn btn-danger">åˆªé™¤</button></td></tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="tab-note" class="content-section">
            <div class="card">
                <ul class="note-list"><li><b>1.</b> HITGã€LKã€RFã€HFã€EM390åŠEM526æè³ªçš„å„åˆ‡åˆ€åŠå°å¼•å­”ä¸‹é‘½é€Ÿåº¦5~10(ç²—åˆ‡ã€ç²—åˆ‡å°å¼•å­”åŠå¤–å‹é™¤å¤–)ã€‚</li><li><b>2.</b> åˆ‡å…§æ§½ç‚ºéŠ…é¢:
åˆ‡åˆ€31ï½59mil[0.80~1.50mm]å£½å‘½ç”¨50INCHï¼Œ
62ï½93mil[1.60~2.38mm]å£½å‘½ç”¨100INCHã€‚</li><li><b>3.</b> è—åœ–æœ‰æ¨™ç¤ºâ—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰T Codeæœ‰èµ°G42(å¤–å‹ã€é˜»æŠ—æ¢å¤–) ï¼Œ
åˆ‡åˆ€ 19.7ï½23.6 mil[0.50~0.60mm]å£½å‘½ç”¨30 INCHï¼Œ
    19.7ï½23.6 miléè†œåˆ€[0.50~0.60mm]å£½å‘½ç”¨75 INCHï¼Œ
    31ï½43 mil[0.80~1.10mm]å£½å‘½ç”¨50 INCHï¼Œ
    47ï½59 mil[1.20~1.50mm]å£½å‘½ç”¨80 INCHï¼Œ
    62ï½93 mil[1.60~2.38mm]å£½å‘½ç”¨100 INCHï¼Œ
    39ï½47miléè†œåˆ€[1.00~1.20mm]å£½å‘½ç”¨150 INCHã€‚</li><li><b>4.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€31ï½51mil[0.79~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™~50INCHè¨­å®š,å°é¢é€Ÿåº¦10~30ã€‚</li><li><b>5.</b> ç²—ã€è£åˆ‡åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™  ~180INCHè¨­å®šï¼Œå°é¢é€Ÿåº¦10~50 (M57è–„æ¿ç‚º20)ã€‚</li><li><b>6.</b> æ¸…ç²‰åˆ‡åˆ€31ï½51mil[0.80~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦30ã€‚</li><li><b>7.</b> æ¸…ç²‰åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦50 (M57è–„æ¿ç‚º20)ã€‚</li><li><b>8.</b> H30æ–™è™Ÿï¼ˆéè»Ÿç¡¬æ¿ï¼‰ã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€
62 mil[1.60mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚
79 mil[2.00mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚</li><li><b>9.</b> C66æ–™è™Ÿå¤–å‹62mil[1.60mm]åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCHã€‚</li><li><b>10.</b> 39~47mil[1.00~1.20mm]è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„35mil[0.90mm]åˆ‡åˆ€(éœ€æ”¹ç‚º35mil[0.90mm]åˆ‡åˆ€åƒæ•¸)ã€‚</li><li><b>11.</b> C81ã€C91æ–™è™Ÿ39mil[1.00mm]ã€47mil[1.20mm]é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCH</li></ul> 
                <div id="adminPanel-note" class="admin-panel">
                    <div class="admin-hint">å‚™è¨»äº‹é …ç®¡ç†ã€‚<br>æ‹–æ›³ã€Œâ˜°ã€åœ–ç¤ºå³å¯æ’åºã€‚<br>åœ¨å…§å®¹æ¡†æŒ‰ <b>Enter</b> å³å¯æ›è¡Œã€‚</div>
                    <div class="admin-actions-row">
                        <button class="btn btn-primary" onclick="adminNoteAdd()">ï¼‹ æ–°å¢å‚™è¨»</button>
                    </div>
                    <div class="admin-table-wrap">
                        <table class="admin-table">
                            <thead><tr><th style="width:40px;"></th><th style="width:50px;">åºè™Ÿ</th><th>å…§å®¹èˆ‡é¡¯ç¤ºä½ç½®</th><th style="width:60px;">æ“ä½œ</th></tr></thead>
                            <tbody id="adminBody-note"><tr data-idx="0">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">1</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(0,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">HITGã€LKã€RFã€HFã€EM390åŠEM526æè³ªçš„å„åˆ‡åˆ€åŠå°å¼•å­”ä¸‹é‘½é€Ÿåº¦5~10(ç²—åˆ‡ã€ç²—åˆ‡å°å¼•å­”åŠå¤–å‹é™¤å¤–)ã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-0-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(0, 'tab-query', this.checked)">
                        <label for="nchk-0-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-0-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(0, 'tab-stack', this.checked)">
                        <label for="nchk-0-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-0-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(0, 'tab-fine', this.checked)">
                        <label for="nchk-0-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-0-tab-feed" class="tab-chk" value="tab-feed" checked="" onchange="adminNoteSetTab(0, 'tab-feed', this.checked)">
                        <label for="nchk-0-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-0-tab-life" class="tab-chk" value="tab-life" onchange="adminNoteSetTab(0, 'tab-life', this.checked)">
                        <label for="nchk-0-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(0)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="1">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">2</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(1,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">åˆ‡å…§æ§½ç‚ºéŠ…é¢:
åˆ‡åˆ€31ï½59mil[0.80~1.50mm]å£½å‘½ç”¨50INCHï¼Œ
62ï½93mil[1.60~2.38mm]å£½å‘½ç”¨100INCHã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-1-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(1, 'tab-query', this.checked)">
                        <label for="nchk-1-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-1-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(1, 'tab-stack', this.checked)">
                        <label for="nchk-1-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-1-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(1, 'tab-fine', this.checked)">
                        <label for="nchk-1-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-1-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(1, 'tab-feed', this.checked)">
                        <label for="nchk-1-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-1-tab-life" class="tab-chk" value="tab-life" checked="" onchange="adminNoteSetTab(1, 'tab-life', this.checked)">
                        <label for="nchk-1-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(1)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="2">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">3</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(2,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">è—åœ–æœ‰æ¨™ç¤ºâ—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰T Codeæœ‰èµ°G42(å¤–å‹ã€é˜»æŠ—æ¢å¤–) ï¼Œ
åˆ‡åˆ€ 19.7ï½23.6 mil[0.50~0.60mm]å£½å‘½ç”¨30 INCHï¼Œ
    19.7ï½23.6 miléè†œåˆ€[0.50~0.60mm]å£½å‘½ç”¨75 INCHï¼Œ
    31ï½43 mil[0.80~1.10mm]å£½å‘½ç”¨50 INCHï¼Œ
    47ï½59 mil[1.20~1.50mm]å£½å‘½ç”¨80 INCHï¼Œ
    62ï½93 mil[1.60~2.38mm]å£½å‘½ç”¨100 INCHï¼Œ
    39ï½47miléè†œåˆ€[1.00~1.20mm]å£½å‘½ç”¨150 INCHã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-2-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(2, 'tab-query', this.checked)">
                        <label for="nchk-2-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-2-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(2, 'tab-stack', this.checked)">
                        <label for="nchk-2-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-2-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(2, 'tab-fine', this.checked)">
                        <label for="nchk-2-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-2-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(2, 'tab-feed', this.checked)">
                        <label for="nchk-2-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-2-tab-life" class="tab-chk" value="tab-life" checked="" onchange="adminNoteSetTab(2, 'tab-life', this.checked)">
                        <label for="nchk-2-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(2)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="3">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">4</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(3,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">ç²—ã€è£åˆ‡åˆ‡åˆ€31ï½51mil[0.79~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™~50INCHè¨­å®š,å°é¢é€Ÿåº¦10~30ã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-3-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(3, 'tab-query', this.checked)">
                        <label for="nchk-3-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-3-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(3, 'tab-stack', this.checked)">
                        <label for="nchk-3-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-3-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(3, 'tab-fine', this.checked)">
                        <label for="nchk-3-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-3-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(3, 'tab-feed', this.checked)">
                        <label for="nchk-3-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-3-tab-life" class="tab-chk" value="tab-life" checked="" onchange="adminNoteSetTab(3, 'tab-life', this.checked)">
                        <label for="nchk-3-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(3)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="4">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">5</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(4,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">ç²—ã€è£åˆ‡åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™  ~180INCHè¨­å®šï¼Œå°é¢é€Ÿåº¦10~50 (M57è–„æ¿ç‚º20)ã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-4-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(4, 'tab-query', this.checked)">
                        <label for="nchk-4-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-4-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(4, 'tab-stack', this.checked)">
                        <label for="nchk-4-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-4-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(4, 'tab-fine', this.checked)">
                        <label for="nchk-4-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-4-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(4, 'tab-feed', this.checked)">
                        <label for="nchk-4-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-4-tab-life" class="tab-chk" value="tab-life" checked="" onchange="adminNoteSetTab(4, 'tab-life', this.checked)">
                        <label for="nchk-4-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(4)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="5">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">6</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(5,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">æ¸…ç²‰åˆ‡åˆ€31ï½51mil[0.80~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦30ã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-5-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(5, 'tab-query', this.checked)">
                        <label for="nchk-5-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-5-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(5, 'tab-stack', this.checked)">
                        <label for="nchk-5-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-5-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(5, 'tab-fine', this.checked)">
                        <label for="nchk-5-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-5-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(5, 'tab-feed', this.checked)">
                        <label for="nchk-5-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-5-tab-life" class="tab-chk" value="tab-life" onchange="adminNoteSetTab(5, 'tab-life', this.checked)">
                        <label for="nchk-5-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(5)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="6">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">7</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(6,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">æ¸…ç²‰åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦50 (M57è–„æ¿ç‚º20)ã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-6-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(6, 'tab-query', this.checked)">
                        <label for="nchk-6-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-6-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(6, 'tab-stack', this.checked)">
                        <label for="nchk-6-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-6-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(6, 'tab-fine', this.checked)">
                        <label for="nchk-6-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-6-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(6, 'tab-feed', this.checked)">
                        <label for="nchk-6-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-6-tab-life" class="tab-chk" value="tab-life" onchange="adminNoteSetTab(6, 'tab-life', this.checked)">
                        <label for="nchk-6-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(6)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="7">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">8</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(7,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">H30æ–™è™Ÿï¼ˆéè»Ÿç¡¬æ¿ï¼‰ã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€
62 mil[1.60mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚
79 mil[2.00mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-7-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(7, 'tab-query', this.checked)">
                        <label for="nchk-7-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-7-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(7, 'tab-stack', this.checked)">
                        <label for="nchk-7-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-7-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(7, 'tab-fine', this.checked)">
                        <label for="nchk-7-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-7-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(7, 'tab-feed', this.checked)">
                        <label for="nchk-7-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-7-tab-life" class="tab-chk" value="tab-life" checked="" onchange="adminNoteSetTab(7, 'tab-life', this.checked)">
                        <label for="nchk-7-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(7)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="8">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">9</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(8,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">C66æ–™è™Ÿå¤–å‹62mil[1.60mm]åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCHã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-8-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(8, 'tab-query', this.checked)">
                        <label for="nchk-8-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-8-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(8, 'tab-stack', this.checked)">
                        <label for="nchk-8-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-8-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(8, 'tab-fine', this.checked)">
                        <label for="nchk-8-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-8-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(8, 'tab-feed', this.checked)">
                        <label for="nchk-8-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-8-tab-life" class="tab-chk" value="tab-life" checked="" onchange="adminNoteSetTab(8, 'tab-life', this.checked)">
                        <label for="nchk-8-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(8)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="9">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">10</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(9,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">39~47mil[1.00~1.20mm]è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„35mil[0.90mm]åˆ‡åˆ€(éœ€æ”¹ç‚º35mil[0.90mm]åˆ‡åˆ€åƒæ•¸)ã€‚</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-9-tab-query" class="tab-chk" value="tab-query" checked="" onchange="adminNoteSetTab(9, 'tab-query', this.checked)">
                        <label for="nchk-9-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-9-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(9, 'tab-stack', this.checked)">
                        <label for="nchk-9-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-9-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(9, 'tab-fine', this.checked)">
                        <label for="nchk-9-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-9-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(9, 'tab-feed', this.checked)">
                        <label for="nchk-9-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-9-tab-life" class="tab-chk" value="tab-life" checked="" onchange="adminNoteSetTab(9, 'tab-life', this.checked)">
                        <label for="nchk-9-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(9)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr><tr data-idx="10">
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">11</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(10,this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">C81ã€C91æ–™è™Ÿ39mil[1.00mm]ã€47mil[1.20mm]é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCH</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-10-tab-query" class="tab-chk" value="tab-query" onchange="adminNoteSetTab(10, 'tab-query', this.checked)">
                        <label for="nchk-10-tab-query" class="tab-chk-label">åƒæ•¸</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-10-tab-stack" class="tab-chk" value="tab-stack" onchange="adminNoteSetTab(10, 'tab-stack', this.checked)">
                        <label for="nchk-10-tab-stack" class="tab-chk-label">ç–Šæ¿</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-10-tab-fine" class="tab-chk" value="tab-fine" onchange="adminNoteSetTab(10, 'tab-fine', this.checked)">
                        <label for="nchk-10-tab-fine" class="tab-chk-label">ç´°åˆ‡</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-10-tab-feed" class="tab-chk" value="tab-feed" onchange="adminNoteSetTab(10, 'tab-feed', this.checked)">
                        <label for="nchk-10-tab-feed" class="tab-chk-label">é‘½å­”</label>
                    </div>
                
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-10-tab-life" class="tab-chk" value="tab-life" checked="" onchange="adminNoteSetTab(10, 'tab-life', this.checked)">
                        <label for="nchk-10-tab-life" class="tab-chk-label">å£½å‘½</label>
                    </div>
                
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(10)" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            </tr></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>


    <div id="pickerModal" class="picker-modal hidden" role="dialog"><div class="picker-sheet"><div class="picker-header"><div id="pickerTitle" class="picker-title">é¸æ“‡</div><button type="button" class="picker-close" onclick="closePicker()">é—œé–‰</button></div><div id="pickerList" class="picker-list"></div></div></div>
    
    <div class="admin-modal-backdrop" id="adminModalBackdrop" role="dialog"><div class="admin-modal"><header><h4 style="margin:0;font-size:16px;">é€²éšç·¨è¼¯ï¼ˆJSONï¼‰</h4><button class="btn btn-ghost" onclick="closeAdminModal()">é—œé–‰</button></header><div class="body"><div class="admin-hint">å¯åœ¨æ­¤å‚™ä»½æˆ–é‚„åŸæ‰€æœ‰è¨­å®šã€‚</div><div class="admin-field"><textarea id="adminJson" spellcheck="false"></textarea></div></div><div class="admin-actions"><button class="btn btn-primary" onclick="applyJsonChanges()">å¥—ç”¨</button></div></div></div>

    <div class="admin-modal-backdrop" id="reorderModal" role="dialog" style="z-index: 5001;">
        <div class="admin-modal" style="width: 450px; max-width: 90%; max-height: 80vh;">
            <header>
                <h4 style="margin:0;font-size:16px;">èª¿æ•´ç›´å¾‘é †åº</h4>
                <button class="btn btn-ghost" onclick="document.getElementById('reorderModal').style.display='none'">å–æ¶ˆ</button>
            </header>
            <div class="body">
                <div class="admin-hint">æ‹–æ›³ã€Œâ˜°ã€å³å¯èª¿æ•´é †åºï¼Œå®Œæˆå¾Œè«‹æŒ‰ã€Œä¿å­˜é †åºã€ã€‚</div>
                <div class="admin-table-wrap" style="max-height: 50vh; overflow-y: auto;">
                    <table class="admin-table">
                        <tbody id="reorderTbody"></tbody>
                    </table>
                </div>
            </div>
            <div class="admin-actions">
                <button class="btn btn-primary" onclick="adminLifeSaveOrder()">ä¿å­˜é †åº</button>
            </div>
        </div>
    </div>

<script>

// --- HTML escape for attribute values ---
function escAttr(v){
    return String(v ?? "").replace(/&/g,"&amp;")
        .replace(/</g,"&lt;")
        .replace(/>/g,"&gt;")
        .replace(/\"/g,"&quot;")
        .replace(/'/g,"&#39;");
}

    const colorMap = { "åœŸé»ƒè‰²":"#D4A017", "è˜‹æœç¶ ":"#8DB600", "é†¬ç´…è‰²":"#800000", "é»‘è‰²":"#000000", "æ·±è—è‰²":"#00008B", "å’–å•¡è‰²":"#6F4E37", "é’è‰²":"#00CED1", "æŸ‘ç´…è‰²":"#FF4500", "æ·¡ç´«è‰²":"#E6E6FA", "å¢¨ç¶ è‰²":"#006400", "ç²‰ç´…è‰²":"#FF69B4", "ç™½è‰²":"#C0C0C0", "æ£•ç´…è‰²":"#A52A2A", "æ·¡æ¢¨è‰²":"#F0EAD6", "æ·±ç´«è‰²":"#800080", "æ·¡æ©˜è‰²":"#FFB84D", "å¡å…¶è‰²":"#F0E68C", "æ·¡è—è‰²":"#ADD8E6", "ç°è‰²":"#808080", "å‡é»ƒè‰²":"#F0E68C", "èƒ­è„‚ç´…":"#C71585", "å¤©è—è‰²":"#87CEEB", "æ¡ƒç´…è‰²":"#FF69B4", "å¤§ç´…è‰²":"#FF0000", "æ¾æ¨¹ç¶ ":"#01796F" , "æ©„æ¬–ç¶ ":"#6B8E23", "æ©„æ¬–è‰²":"#6B8E23"};

    let colorOverrides = {"ç™½è‰²":"#FFFFFF"};

    function _hslToHex(h, s, l){
        s/=100; l/=100;
        const k = n => (n + h/30) % 12;
        const a = s * Math.min(l, 1-l);
        const f = n => l - a * Math.max(-1, Math.min(k(n)-3, Math.min(9-k(n), 1)));
        const toHex = x => Math.round(255*x).toString(16).padStart(2,'0');
        return '#' + toHex(f(0)) + toHex(f(8)) + toHex(f(4));
    }

    function _autoColorHexFromName(name){
        const str = String(name || '').trim();
        if(!str) return '#eeeeee';
        let hash = 5381;
        for (let i=0;i<str.length;i++){
            hash = ((hash << 5) + hash) + str.charCodeAt(i);
            hash = hash >>> 0;
        }
        const hue = hash % 360;
        return _hslToHex(hue, 55, 45);
    }

    function getColorHex(colorName){
        const n = String(colorName || '').trim();
        if(!n) return '#eeeeee';
        if(colorOverrides && colorOverrides[n]) return colorOverrides[n];
        if(colorMap && colorMap[n]) return colorMap[n];
        return _autoColorHexFromName(n);
    }

    function setColorOverride(colorName, hex){
        const n = String(colorName || '').trim();
        if(!n) return;
        const h = String(hex || '').trim();
        if(!/^#[0-9a-fA-F]{6}$/.test(h)) { alert('è‰²ç¢¼æ ¼å¼éŒ¯èª¤ï¼Œè«‹ä½¿ç”¨ #RRGGBB'); return; }
        if(!colorOverrides) colorOverrides = {};
        colorOverrides[n] = h.toUpperCase();
        try{ runFineQuery(); }catch(e){}
        try{ adminFineRefresh(); }catch(e){}
    }

    let typeDefs = [{"group":"ä¸»è¦å·¥åº","options":[{"v":"FF","t":"ç²—åˆ‡ (FF)"},{"v":"AA","t":"ç²—åˆ‡ (AA) æ¸…ç²‰"},{"v":"RD","t":"å…§æ§½ (RD)ã€é˜»æŠ—æ¢ (CP)"},{"v":"G42","t":"å°é–‰æ§½ã€äºŒæ¬¡å­”ã€è€³æœµæ§½ã€è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ (G42)"},{"v":"OR","t":"å¤–å‹ (OR)ã€è£é–‹ (HA)"}]},{"group":"ç‰¹æ®Šå·¥åº","options":[{"v":"RDL","t":"å…§æ§½ (RDL) é€†è½‰åˆ€"},{"v":"DA","t":"å°å¼•å­” (DA)"},{"v":"DAFF","t":"ç²—åˆ‡å°å¼•å­” (DA FF)"}]}];

    let toolData = {"0.0197":{"FF":["40","10","50","0.0098","10"],"AA":["40","10","50","0.0098","10"],"RD":["40","10","50","0.0098","8"],"G42":["40","7","30","0.0098","8"],"OR":["40","10","50","0.0103","10"]},"0.0197 CB":{"FF":["40","10","150","0.0098","10"],"AA":["40","10","150","0.0098","10"],"RD":["40","10","150","0.0098","8"],"G42":["40","7","75","0.0098","8"],"OR":["40","10","150","0.0103","10"]},"0.0236":{"FF":["40","10","50","0.0118","10"],"AA":["40","10","50","0.0118","10"],"RD":["40","10","50","0.0118","8"],"G42":["40","7","30","0.0118","8"],"OR":["40","10","50","0.0123","10"]},"0.0236 CB":{"FF":["40","10","150","0.0118","10"],"AA":["40","10","150","0.0118","10"],"RD":["40","10","150","0.0118","8"],"G42":["40","7","75","0.0118","8"],"OR":["40","10","150","0.0123","10"]},"0.031":{"FF":["33","12","100","0.0155","12"],"AA":["30","20","300","0.0155","30"],"RD":["30","10","90","0.0155","10"],"G42":["33","10","50","0.0155","10"],"OR":["30","12","90","0.0160","10"],"RDL":["-30","10","90","0.0155","10"]},"0.035":{"FF":["33","12","100","0.0175","12"],"AA":["30","20","300","0.0175","30"],"RD":["30","10","90","0.0175","10"],"G42":["33","10","50","0.0175","10"],"OR":["30","12","90","0.0180","10"]},"0.039":{"FF":["33","12","200","0.0195","12"],"AA":["30","20","300","0.0195","30"],"RD":["30","10","200","0.0195","10"],"G42":["32","10","50","0.0195","10"],"OR":["30","12","200","0.0200","10"],"RDL":["-30","10","160","0.0195","10"]},"0.039 CB":{"FF":["33","12","700","0.0195","12"],"AA":["30","20","700","0.0195","30"],"RD":["30","10","700","0.0195","10"],"G42":["32","10","150","0.0195","10"],"OR":["30","12","700","0.0200","10"]},"0.039 LCB":{"FF":["33","12","300","0.0195","12"],"AA":["30","20","300","0.0195","30"],"RD":["30","10","300","0.0195","10"],"G42":["32","10","300","0.0195","10"],"OR":["30","12","300","0.0200","10"]},"0.047":{"FF":["32","12","200","0.0235","12"],"AA":["30","30","370","0.0235","30"],"RD":["30","10","200","0.0235","10"],"G42":["32","10","80","0.0235","10"],"OR":["30","15","200","0.0240","10"]},"0.047 LCB":{"FF":["32","12","300","0.0235","12"],"AA":["30","30","300","0.0235","30"],"RD":["30","10","300","0.0235","10"],"G42":["32","10","300","0.0235","10"],"OR":["30","15","300","0.0240","10"]},"0.055":{"FF":["32","15","420","0.0275","50"],"AA":["30","35","420","0.0275","50"],"RD":["30","10","200","0.0275","10"],"G42":["30","10","80","0.0275","10"],"OR":["30","15","200","0.0280","10"]},"0.059":{"FF":["32","20","420","0.0295","50"],"AA":["30","35","420","0.0295","50"],"RD":["28","10","250","0.0295","10"],"G42":["30","10","80","0.0295","10"],"OR":["30","20","250","0.0302","10"]},"0.062":{"FF":["32","30","520","0.0315","50"],"AA":["28","40","520","0.0315","50"],"RD":["23","5","350","0.0315","10"],"G42":["28","5","100","0.0315","10"],"OR":["28","30","350","0.0322","10"]},"0.079":{"FF":["32","30","700","0.0395","50"],"AA":["28","40","700","0.0395","50"],"RD":["22","5","400","0.0395","10"],"G42":["28","5","100","0.0395","10"],"OR":["28","30","400","0.0405","10"]},"0.093":{"FF":["32","30","1020","0.0465","50"],"AA":["28","40","1020","0.0465","50"],"RD":["22","5","400","0.0465","10"],"G42":["25","5","100","0.0465","10"],"OR":["28","30","800","0.0485","10"]},"å°æ–¼0.0280(ä¸å«)":{"DAFF":["30","20","1500","--","--"]},"å°æ–¼0.1260(ä¸å«)":{"DA":["30","10","1500","--","--"],"DAFF":["30","30","1500","--","--"]},"å¤§æ–¼0.1260(å«)":{"DA":["20","10","1500","--","--"],"DAFF":["20","10","1500","--","--"]}};

    // options is now an Array of objects to preserve order
    let stackingRules = {"15.7 (0.40)":{"max":"40 (1.02)","options":[{"r":"9~10","v":4},{"r":"11~13","v":3},{"r":"14~20","v":2},{"r":"21~40","v":1}]},"19.7 (0.50)":{"max":"66 (1.68)","options":[{"r":"10~16","v":4},{"r":"17~22","v":3},{"r":"23~33","v":2},{"r":"34~66","v":1}]},"19.7 LCBRD (0.50)":{"max":"86 (2.18)","options":[{"r":"10~17","v":5},{"r":"18~21","v":4},{"r":"22~28","v":3},{"r":"29~43","v":2},{"r":"44~86","v":1}]},"23.6 (0.60)":{"max":"88 (2.24)","options":[{"r":"15~22","v":4},{"r":"23~29","v":3},{"r":"30~44","v":2},{"r":"45~88","v":1}]},"23.6 LCBRD (0.60)":{"max":"108 (2.74)","options":[{"r":"15~21","v":5},{"r":"22~27","v":4},{"r":"28~36","v":3},{"r":"37~54","v":2},{"r":"55~108","v":1}]},"31~35 (0.80-0.90)":{"max":"122 (2.74)","options":[{"r":"9~12","v":10},{"r":"13","v":9},{"r":"14~15","v":8},{"r":"16~17","v":7},{"r":"18~20","v":6},{"r":"21~24","v":5},{"r":"25~30","v":4},{"r":"31~40","v":3},{"r":"41~61","v":2},{"r":"62~122","v":1}]},"35 LRD (0.90)":{"max":"170 (4.32)","options":[{"r":"15~21","v":8},{"r":"22~24","v":7},{"r":"25~28","v":6},{"r":"29~34","v":5},{"r":"35~42","v":4},{"r":"43~56","v":3},{"r":"57~85","v":2}]},"39~55 (0.10-1.40)":{"max":"205 (5.21)","options":[{"r":"15~22","v":8},{"r":"23~25","v":7},{"r":"26~30","v":6},{"r":"31~37","v":5},{"r":"38~47","v":4},{"r":"48~64","v":3},{"r":"65~99","v":2}]},"59~98 (1.50-2.50)":{"max":"259 (6.6)","options":[{"r":"15~18","v":12},{"r":"19~22","v":10},{"r":"23~28","v":8},{"r":"29~33","v":7},{"r":"34~39","v":6},{"r":"40~47","v":5},{"r":"48~60","v":4},{"r":"61~81","v":3}]},"39~47 LCBRD (1.00-1.20)":{"max":"263 (6.7)","options":[{"r":"15~18","v":12},{"r":"19~22","v":10},{"r":"23~28","v":8},{"r":"29~33","v":7},{"r":"34~39","v":6},{"r":"40~47","v":5},{"r":"48~60","v":4},{"r":"61~68","v":3}]}};

    let fineCutData = [{"label":"0.0197\"(0.500) (åœŸé»ƒè‰²)","s":["40","30~45"],"f":["8","5~10"],"t":["8","5~10"],"d":["0.0098","+/-0.003\""],"color":"åœŸé»ƒè‰²"},{"label":"0.0197\" LCBRD(0.500) (è˜‹æœç¶ )","s":["45","40~55"],"f":["8","5~10"],"t":["8","5~10"],"d":["0.0098","+/-0.003\""],"color":"è˜‹æœç¶ "},{"label":"0.0236\"(0.600) (é†¬ç´…è‰²)","s":["40","30~45"],"f":["8","5~10"],"t":["8","5~10"],"d":["0.0118","+/-0.003\""],"color":"é†¬ç´…è‰²"},{"label":"0.0236\" LCBRD(0.600) (é»‘è‰²)","s":["40","30~50"],"f":["8","5~10"],"t":["8","5~10"],"d":["0.0118","+/-0.003\""],"color":"é»‘è‰²"},{"label":"0.031\"(0.800) (æ·±è—è‰²)","s":["30","25~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0155","+/-0.003\""],"color":"æ·±è—è‰²"},{"label":"0.031\" CBRD(0.800) (å’–å•¡è‰²)","s":["55","40~55"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0155","+/-0.003\""],"color":"å’–å•¡è‰²"},{"label":"0.031\" (é€†)æ¼¢å°(0.800) (é’è‰²)","s":["-30","-30"],"f":["10","5~10"],"t":["10","10~10"],"d":["0.0155","+/-0.003\""],"color":"é’è‰²"},{"label":"0.035\"(0.900) (æŸ‘ç´…è‰²)","s":["30","20~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0175","+/-0.003\""],"color":"æŸ‘ç´…è‰²"},{"label":"0.035\" LRD(0.900) (æ·¡ç´«è‰²)","s":["30","20~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0175","+/-0.003\""],"color":"æ·¡ç´«è‰²"},{"label":"0.039\"(1.000) (å¢¨ç¶ è‰²)","s":["30","25~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"å¢¨ç¶ è‰²"},{"label":"0.039\" CBRD(1.000) (ç²‰ç´…è‰²)","s":["35","25~50"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"ç²‰ç´…è‰²"},{"label":"0.039\" (é€†)å°–é»(1.000) (ç™½è‰²)","s":["-30","-25~-40"],"f":["10","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"ç™½è‰²"},{"label":"0.039\" (é€†)æ—­è²¿(1.000) (ç™½è‰²)","s":["-30","-25~-40"],"f":["10","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"ç™½è‰²"},{"label":"0.0039\" LCBRD(1.000) (æ£•ç´…è‰²)","s":["35","25~50"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0195","+/-0.003\""],"color":"æ£•ç´…è‰²"},{"label":"0.043\"(1.100) (æ·¡æ¢¨è‰²)","s":["30","25~40"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0215","+/-0.003\""],"color":"æ·¡æ¢¨è‰²"},{"label":"0.047\"(1.200) (æ·±ç´«è‰²)","s":["30","20~40"],"f":["28","10~30"],"t":["20","10~25"],"d":["0.0235","+/-0.003\""],"color":"æ·±ç´«è‰²"},{"label":"0.047\"(1.200) (æ©„æ¬–ç¶ )","s":["30","20~40"],"f":["28","10~30"],"t":["20","10~25"],"d":["0.0235","+/-0.003\""],"color":"æ©„æ¬–ç¶ "},{"label":"0.047\" LCBRD(1.200)(æ·¡æ©˜è‰²)","s":["35","25~50"],"f":["15","10~20"],"t":["10","10~20"],"d":["0.0235\"","+/-0.003\""],"color":"æ·¡æ©˜è‰²"},{"label":"0.051\"(1.300)(å¡å…¶è‰²)","s":["30","20~35"],"f":["28","10~30"],"t":["20","10~25"],"d":["0.0255\"","+/-0.003\""],"color":"å¡å…¶è‰²"},{"label":"0.055\"(1.400)(æ·¡è—è‰²)","s":["30","20~35"],"f":["30","10~35"],"t":["20","10~27"],"d":["0.0275\"","+/-0.003\""],"color":"æ·¡è—è‰²"},{"label":"0.059\"(1.500)(ç°è‰²)","s":["30","20~35"],"f":["30","10~35"],"t":["20","10~27"],"d":["0.0295\"","+/-0.003\""],"color":"ç°è‰²"},{"label":"0.062\"(1.600) (å‡é»ƒè‰²)","s":["30","18~35"],"f":["35","10~40"],"t":["25","10~30"],"d":["0.0315","+/-0.003\""],"color":"å‡é»ƒè‰²"},{"label":"0.067\"(1.700)(èƒ­è„‚ç´…)","s":["30","25~35"],"f":["35","10~40"],"t":["25","10~30"],"d":["0.0335\"","+/-0.003\""],"color":"èƒ­è„‚ç´…"},{"label":"0.069\"(1.750)(è˜‹æœç¶ )","s":["30","25~35"],"f":["35","10~40"],"t":["25","10~30"],"d":["0.0345\"","+/-0.003\""],"color":"è˜‹æœç¶ "},{"label":"0.071\"(1.800)(å¤©è—è‰²)","s":["30","25~35"],"f":["35","10~40"],"t":["25","10~30"],"d":["0.0355\"","+/-0.003\""],"color":"å¤©è—è‰²"},{"label":"0.075\"(1.900)(æ¡ƒç´…è‰²)","s":["30","25~35"],"f":["35","10~40"],"t":["30","10~35"],"d":["0.0375\"","+/-0.003\""],"color":"æ¡ƒç´…è‰²"},{"label":"0.079\"(2.000)(å¤§ç´…è‰²)","s":["30","20~35"],"f":["35","10~40"],"t":["30","10~35"],"d":["0.0395\"","+/-0.003\""],"color":"å¤§ç´…è‰²"},{"label":"0.093\"(2.380)(ç™½è‰²)","s":["28","18~30"],"f":["35","10~40"],"t":["40","10~45"],"d":["0.0490\"","+/-0.003\""],"color":"ç™½è‰²"},{"label":"0.098\"(2.500) (æ¾æ¨¹ç¶ )","s":["28","18~30"],"f":["35","10~40"],"t":["40","10~45"],"d":["0.0490","+/-0.003\""],"color":"æ¾æ¨¹ç¶ "}];

    let feedData = [{"label":"0.0279\" ä»¥ä¸‹","s":["30","20~40"],"pF":["20","10~20"],"sF":["10","10~20"],"life":"1500"},{"label":"0.0280\"~0.0429\"","s":["30","20~40"],"pF":["30","10~30"],"sF":["10","10~20"],"life":"1500"},{"label":"0.0430\"~0.0865\"","s":["30","20~40"],"pF":["40","10~40"],"sF":["10","10~20"],"life":"1500"},{"label":"0.0866\"~0.1014\"","s":["25","20~35"],"pF":["50","10~50"],"sF":["10","10~20"],"life":"1500"},{"label":"0.1015\"~0.1259\"","s":["25","20~35"],"pF":["40","10~40"],"sF":["10","10~20"],"life":"1500"},{"label":"0.1260\"~0.1456\"","s":["20","15~25"],"pF":["20","10~20"],"sF":["10","10~20"],"life":"1500"},{"label":"0.1457\" ä»¥ä¸Š","s":["20","15~25"],"pF":["10","10~15"],"sF":["10","10~20"],"life":"1500"}];

    let toolLifeRules = (function(){ 
        return {"0.0197\" (0.500mm)":{"éè†œåˆ€":[["150","100~150"],["150","100~150"]],"ä¸€èˆ¬åˆ€":[["50","10~50"],["30","10~50"]]},"0.0236\" (0.600mm)":{"éè†œåˆ€":[["150","100~150"],["150","100~150"]],"ä¸€èˆ¬åˆ€":[["50","10~50"],["30","10~50"]]},"0.031\" (0.800mm)":{"éè†œåˆ€":[["450","300~450"],["300","250~300"]],"ä¸€èˆ¬åˆ€":[["300","260~300"],["100","60~100"]]},"0.031\" é€†è½‰åˆ€ (0.800mm)":{"ä¸€èˆ¬åˆ€":[["90","90"],["90","90"]]},"0.035\" (0.900mm)":{"ä¸€èˆ¬åˆ€":[["300","260~300"],["100","60~100"]],"é•·åˆƒåˆ€":[["300","260~300"],["100","60~100"]]},"0.039\" (1.000mm)":{"éè†œåˆ€":[["1000","700~1000"],["700","600~700"]],"ä¸€èˆ¬åˆ€":[["300","260~300"],["200","120~200"]]},"0.039\" é€†è½‰åˆ€ (1.000mm)":{"ä¸€èˆ¬åˆ€":[["160","160"],["160","160"]]},"0.043\" (1.100mm)":{"ä¸€èˆ¬åˆ€":[["300","260~300"],["100","60~100"]]},"0.047\" (1.200mm)":{"éè†œåˆ€":[["1000","700~1000"],["700","600~700"]],"ä¸€èˆ¬åˆ€":[["370","330~370"],["200","120~200"]]},"0.051\"(1.300)":{"ä¸€èˆ¬åˆ€":[["370","330~370"],["140","100~140"]]},"0.055\"(1.400)":{"ä¸€èˆ¬åˆ€":[["420","380~420"],["220","180~220"]]},"0.059\"(1.500)":{"ä¸€èˆ¬åˆ€":[["420","380~420"],["250","180~250"]]},"0.062\"(1.600)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["400","300~400"]]},"0.067\"(1.700)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]},"0.069\"(1.750)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]},"0.071\"(1.800)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]},"0.075\"(1.900)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]},"0.079\"(2.000) (å…§æ§½)":{"ä¸€èˆ¬åˆ€":[["700","580~700"],["620","400~620"]]},"0.079\"(2.000) (å¤–å‹)":{"ä¸€èˆ¬åˆ€":[["620","580~620"],["420","380~420"]]},"0.093\"(2.380) (å…§æ§½)":{"ä¸€èˆ¬åˆ€":[["620","580~620"],["420","380~420"]]},"0.093\"(2.380) (å¤–å‹)":{"ä¸€èˆ¬åˆ€":[["1020","980~1020"],["820","780~820"]]},"0.098\"(2.500) (å…§æ§½)":{"ä¸€èˆ¬åˆ€":[["520","480~520"],["320","280~320"]]}}; 
    })();

    // Updated Notes Data Structure: Objects with 'text' and 'tabs' array
    let notesData = [{"text":"HITGã€LKã€RFã€HFã€EM390åŠEM526æè³ªçš„å„åˆ‡åˆ€åŠå°å¼•å­”ä¸‹é‘½é€Ÿåº¦5~10(ç²—åˆ‡ã€ç²—åˆ‡å°å¼•å­”åŠå¤–å‹é™¤å¤–)ã€‚","tabs":["tab-query","tab-feed"]},{"text":"åˆ‡å…§æ§½ç‚ºéŠ…é¢:\nåˆ‡åˆ€31ï½59mil[0.80~1.50mm]å£½å‘½ç”¨50INCHï¼Œ\n         62ï½93mil[1.60~2.38mm]å£½å‘½ç”¨100INCHã€‚","tabs":["tab-query","tab-life","tab-fine"]},{"text":"è—åœ–æœ‰æ¨™ç¤ºâ—ã€â–³ã€åˆ‡è‘«è˜†å­”ã€é‡‘æ‰‹æŒ‡ã€äºŒæ¬¡å­”æˆ–ç¨‹å¼æœ‰T Codeæœ‰èµ°G42(å¤–å‹ã€é˜»æŠ—æ¢å¤–) ï¼Œ\nåˆ‡åˆ€ 19.7ï½23.6 mil[0.50~0.60mm]å£½å‘½ç”¨30 INCHï¼Œ\n         19.7ï½23.6 miléè†œåˆ€[0.50~0.60mm]å£½å‘½ç”¨75 INCHï¼Œ\n         31ï½43 mil[0.80~1.10mm]å£½å‘½ç”¨50 INCHï¼Œ\n         47ï½59 mil[1.20~1.50mm]å£½å‘½ç”¨80 INCHï¼Œ\n         62ï½93 mil[1.60~2.38mm]å£½å‘½ç”¨100 INCHï¼Œ\n         39ï½47miléè†œåˆ€[1.00~1.20mm]å£½å‘½ç”¨150 INCHã€‚","tabs":["tab-query","tab-life"]},{"text":"ç²—ã€è£åˆ‡åˆ‡åˆ€31ï½51mil[0.79~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™~50INCHè¨­å®š,å°é¢é€Ÿåº¦10~30ã€‚","tabs":["tab-query","tab-life"]},{"text":"ç²—ã€è£åˆ‡åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™  ~180INCHè¨­å®šï¼Œå°é¢é€Ÿåº¦10~50 (M57è–„æ¿ç‚º20)ã€‚","tabs":["tab-query","tab-life","tab-fine"]},{"text":"æ¸…ç²‰åˆ‡åˆ€31ï½51mil[0.80~1.30mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦30ã€‚","tabs":["tab-query","tab-fine","tab-life"]},{"text":"æ¸…ç²‰åˆ‡åˆ€55ï½93mil[1.40~2.38mm]å£½å‘½è¦å®šï¼›æ™®é€šæè³ªè¨­å®šç¯„åœä¸Šé™ï¼Œå°é¢é€Ÿåº¦50 (M57è–„æ¿ç‚º20)ã€‚","tabs":["tab-query","tab-fine"]},{"text":"H30æ–™è™Ÿï¼ˆéè»Ÿç¡¬æ¿ï¼‰ã€R01æ–™è™Ÿåˆ‡å…§æ§½åˆ‡åˆ€\n62 mil[1.60mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚\n79 mil[2.00mm]åˆ‡åˆ€å£½å‘½è¨­200INCHã€‚","tabs":["tab-query","tab-life"]},{"text":"C66æ–™è™Ÿå¤–å‹62mil[1.60mm]åˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCHã€‚","tabs":["tab-query","tab-life"]},{"text":"39~47mil[1.00~1.20mm]è£é–‹åˆ€å¯æ”¹ä½¿ç”¨ç›²åˆ‡éçš„35mil[0.90mm]åˆ‡åˆ€(éœ€æ”¹ç‚º35mil[0.90mm]åˆ‡åˆ€åƒæ•¸)ã€‚","tabs":["tab-query","tab-life"]},{"text":"C81ã€C91æ–™è™Ÿ39mil[1.00mm]ã€47mil[1.20mm]é•·åˆƒéè†œåˆ‡åˆ€å£½å‘½ä¸Šé™è¨­å®š300INCH","tabs":["tab-life","tab-query"]}];

    let isEditing = false;
    let _tabMap = {
        'tab-query': 'åƒæ•¸',
        'tab-stack': 'ç–Šæ¿',
        'tab-fine': 'ç´°åˆ‡',
        'tab-feed': 'é‘½å­”',
        'tab-life': 'å£½å‘½'
    };

    // --- Core Logic ---
    function setSelectOptions(selectEl, values, getLabel) {
        selectEl.innerHTML = "";
        values.forEach(v => {
            const opt = document.createElement('option');
            opt.value = String(v);
            opt.textContent = getLabel ? getLabel(v) : String(v);
            selectEl.appendChild(opt);
        });
    }

    function switchTab(id) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
        if (event && event.currentTarget) {
            event.currentTarget.classList.add('active');
            document.getElementById('currentTitle').innerText = event.currentTarget.innerText;
        }
        if (window.matchMedia('(max-width: 900px)').matches) {
            document.getElementById('sidebar').classList.add('collapsed');
        }
        document.querySelector('.main-wrapper')?.scrollTo({ top: 0, behavior: 'smooth' });

        // Render context notes for the current tab
        renderContextNotes(id);

        try {
            if (id === 'tab-fine') {
                updateFineSel();
                runFineQuery();
            } else if (id === 'tab-feed') {
                updateFeedSel();
                runFeedQuery();
            } else if (id === 'tab-stack') {
                const sSel = document.getElementById('stkSizeSel');
                if (sSel) {
                    const cur = sSel.value;
                    sSel.innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
                    if (cur && stackingRules[cur]) sSel.value = cur;
                }
                updateStackThickList();
                runStackQuery();
            } else if (id === 'tab-life') {
                const sSel = document.getElementById('lifeSizeSel');
                if (sSel) {
                    const cur = sSel.value;
                    setSelectOptions(sSel, Object.keys(toolLifeRules));
                    if (cur && toolLifeRules[cur]) sSel.value = cur;
                }
                updateLifeTypeList();
                runLifeQuery();
            } else if (id === 'tab-note') {
                renderNotes();
            }
        } catch(e) { }
    }

    // --- DRAG & DROP: GLOBAL HANDLER (FIXED + INSERT LINE + LIGHT ANIMATION) ---
// Only draggable from the â˜° handle. Works across all admin tables without per-row listeners.

let _draggingIndex = -1;
let _draggingType = null; // 'notes', 'fine', 'stack', 'feed', 'query', 'life', 'lifeSizeOrder'
let _draggingTbodyId = null;
let _dropTargetIndex = -1;
let _dropInsertAfter = false; // false => insert before target, true => insert after target
let _rafDragOver = 0;

// Utility: get the <tr> we are actually dragging (via handle)
function _getDragRowFromEvent(e){
    const handle = e.target.closest('.drag-handle');
    if(!handle) return null;
    return handle.closest('tr');
}

// Utility: which table are we in?
function _getDragTypeByTbodyId(tbodyId){
    if (tbodyId === 'adminBody-note') return 'notes';
    if (tbodyId === 'adminBody-fine') return 'fine';
    if (tbodyId === 'adminBody-feed') return 'feed';
    if (tbodyId === 'adminBody-stack') return 'stack';
    if (tbodyId === 'adminBody-query') return 'query';
    if (tbodyId === 'adminBody-life') return 'life';
    if (tbodyId === 'reorderTbody') return 'lifeSizeOrder';
    return null;
}

function _clearDragIndicators(tbody){
    if(!tbody) return;
    tbody.querySelectorAll('tr').forEach(tr=>{
        tr.classList.remove('drag-over-top','drag-over-bottom','drop-flash');
    });
}

document.addEventListener('dragstart', (e) => {
    const row = _getDragRowFromEvent(e);
    if (!row) return;

    const tbody = row.closest('tbody');
    if (!tbody) return;

    const dtype = _getDragTypeByTbodyId(tbody.id);
    if (!dtype) return;

    _draggingType = dtype;
    _draggingTbodyId = tbody.id;
    _draggingIndex = Array.from(tbody.children).indexOf(row);

    // Standard Drag setup
    e.dataTransfer.effectAllowed = 'move';
    try{
        // Prevent "ğŸš«" for some browsers by providing data
        e.dataTransfer.setData('text/plain', String(_draggingIndex));
        // Use the row as drag image (small offset so cursor doesn't cover the line)
        e.dataTransfer.setDragImage(row, 10, 10);
    }catch(err){}

    row.classList.add('dragging');
});

document.addEventListener('dragover', (e) => {
    if(!_draggingType) return;
    // Allow drop
    e.preventDefault();

    // Throttle for performance
    if(_rafDragOver) return;
    _rafDragOver = requestAnimationFrame(() => {
        _rafDragOver = 0;

        const row = e.target.closest('tr');
        if (!row) return;

        const tbody = row.closest('tbody');
        if (!tbody || tbody.id !== _draggingTbodyId) return;

        const rows = Array.from(tbody.children);
        const targetIndex = rows.indexOf(row);
        if (targetIndex < 0) return;

        // Decide before/after based on cursor position
        const rect = row.getBoundingClientRect();
        const isAfter = (e.clientY - rect.top) > (rect.height / 2);

        _dropTargetIndex = targetIndex;
        _dropInsertAfter = isAfter;

        // Visual: clear then set indicator line
        _clearDragIndicators(tbody);
        row.classList.add(isAfter ? 'drag-over-bottom' : 'drag-over-top');
    });
});

document.addEventListener('dragleave', (e) => {
    if(!_draggingType) return;
    const row = e.target.closest('tr');
    const tbody = row?.closest('tbody');
    if(tbody && tbody.id === _draggingTbodyId){
        // light cleanup; dragover will redraw anyway
        row.classList.remove('drag-over-top','drag-over-bottom');
    }
});

document.addEventListener('dragend', (e) => {
    const row = e.target.closest('tr');
    if(row) row.classList.remove('dragging');
    const tbody = document.getElementById(_draggingTbodyId);
    _clearDragIndicators(tbody);

    _draggingIndex = -1;
    _draggingType = null;
    _draggingTbodyId = null;
    _dropTargetIndex = -1;
    _dropInsertAfter = false;
});

document.addEventListener('drop', (e) => {
    if(!_draggingType) return;
    e.preventDefault();

    const targetRow = e.target.closest('tr');
    if (!targetRow || _draggingIndex === -1) return;

    const tbody = targetRow.closest('tbody');
    if (!tbody || tbody.id !== _draggingTbodyId) return;

    const rows = Array.from(tbody.children);
    let targetIndex = rows.indexOf(targetRow);
    if (targetIndex < 0) return;

    // Compute final insert index in array terms
    let insertIndex = targetIndex + (_dropInsertAfter ? 1 : 0);

    // If moving down and inserting after/before, adjust because removal shifts indexes
    if (_draggingIndex < insertIndex) insertIndex -= 1;

    if (insertIndex === _draggingIndex) return;

    // --- PERFORM DATA MOVE / DOM MOVE ---
    if (_draggingType === 'notes') {
        const item = notesData.splice(_draggingIndex, 1)[0];
        notesData.splice(insertIndex, 0, item);
        adminNoteRefresh();
        renderNotes();
        const activeId = document.querySelector('.content-section.active')?.id;
        if(activeId) renderContextNotes(activeId);
    }
    else if (_draggingType === 'fine') {
        const item = fineCutData.splice(_draggingIndex, 1)[0];
        fineCutData.splice(insertIndex, 0, item);
        adminFineRefresh();
        updateFineSel();
    }
    else if (_draggingType === 'feed') {
        const item = feedData.splice(_draggingIndex, 1)[0];
        feedData.splice(insertIndex, 0, item);
        adminFeedRefresh();
        updateFeedSel();
    }
    else if (_draggingType === 'stack') {
        let entries = Object.entries(stackingRules);
        const item = entries.splice(_draggingIndex, 1)[0];
        entries.splice(insertIndex, 0, item);
        stackingRules = Object.fromEntries(entries);
        adminStackRefresh();
        document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join('');
    }
    else if (_draggingType === 'query') {
        const type = document.getElementById('typeSelect').value;
        const allKeys = Object.keys(toolData);
        const visibleKeys = allKeys.filter(k => toolData[k][type]);

        const moveKey = visibleKeys[_draggingIndex];
        if(!moveKey) return;

        visibleKeys.splice(_draggingIndex, 1);
        visibleKeys.splice(insertIndex, 0, moveKey);

        const currentKeys = Object.keys(toolData);
        const finalData = {};
        visibleKeys.forEach(k => { finalData[k] = toolData[k]; });
        currentKeys.forEach(k => { if(!finalData[k]) finalData[k] = toolData[k]; });

        toolData = finalData;
        adminParamRefresh();
        updateSizeList();
    }
    else if (_draggingType === 'life') {
        const sizeKey = document.getElementById('lifeSizeSel').value;
        let subObj = toolLifeRules[sizeKey];
        if(!subObj) return;

        let entries = Object.entries(subObj);
        const item = entries.splice(_draggingIndex, 1)[0];
        entries.splice(insertIndex, 0, item);

        toolLifeRules[sizeKey] = Object.fromEntries(entries);
        adminLifeRefreshPanel();
        updateLifeTypeList();
    }
    else if (_draggingType === 'lifeSizeOrder') {
        // Reorder modal: move DOM rows only; save order via "ä¿å­˜é †åº" button
        const dragRow = rows[_draggingIndex];
        if(!dragRow) return;

        const refRow = rows[targetIndex];
        if(!refRow) return;

        if(_dropInsertAfter){
            tbody.insertBefore(dragRow, refRow.nextSibling);
        }else{
            tbody.insertBefore(dragRow, refRow);
        }
        // flash the target to give feedback
        refRow.classList.add('drop-flash');
        setTimeout(()=>refRow.classList.remove('drop-flash'), 220);
    }

    // Cleanup indicator lines
    _clearDragIndicators(tbody);

    // Reset (so next drag is clean)
    _draggingIndex = -1;
    _draggingType = null;
    _draggingTbodyId = null;
    _dropTargetIndex = -1;
    _dropInsertAfter = false;
});


// --- Tab 1 Logic ---

    function updateSizeList() {
        const t = document.getElementById('typeSelect').value;
        const valid = Object.keys(toolData).filter(s => toolData[s][t] !== undefined);
        const sel = document.getElementById('sizeSelect');
        const oldVal = sel.value;
        sel.innerHTML = valid.map(s => `<option value="${s}">${s}</option>`).join('');
        if(valid.includes(oldVal)) sel.value = oldVal;
        runQuery();
        syncPickerButtons(); 
        if(isEditing) adminParamRefresh();
    }
    
    function renderTypeSelect() {
        const sel = document.getElementById('typeSelect');
        const oldVal = sel.value;
        sel.innerHTML = '';
        typeDefs.forEach(group => {
            const optgroup = document.createElement('optgroup');
            optgroup.label = group.group;
            group.options.forEach(opt => {
                const option = document.createElement('option');
                option.value = opt.v;
                option.textContent = opt.t;
                optgroup.appendChild(option);
            });
            sel.appendChild(optgroup);
        });
        if (oldVal) sel.value = oldVal;
        if (!sel.value && sel.options.length > 0) sel.selectedIndex = 0;
        updateSizeList(); 
    }

    // [Admin Param Functions]
    function adminParamAddType() {
        const groupName = prompt("è«‹è¼¸å…¥æ–°é¡å‹çš„ã€Œç¾¤çµ„åç¨±ã€ï¼š", "è‡ªè¨‚å·¥åº"); if (!groupName) return;
        const typeCode = prompt("è«‹è¼¸å…¥ã€Œé¡å‹ä»£ç¢¼ã€ï¼š"); if (!typeCode) return;
        let exists = false; typeDefs.forEach(g => { if (g.options.find(o => o.v === typeCode)) exists = true; });
        if (exists) { alert('æ­¤ä»£ç¢¼å·²å­˜åœ¨ï¼'); return; }
        const typeLabel = prompt("è«‹è¼¸å…¥ã€Œé¡å‹é¡¯ç¤ºåç¨±ã€ï¼š", typeCode); if (!typeLabel) return;
        let group = typeDefs.find(g => g.group === groupName);
        if (!group) { group = { group: groupName, options: [] }; typeDefs.push(group); }
        group.options.push({ v: typeCode, t: typeLabel });
        renderTypeSelect(); document.getElementById('typeSelect').value = typeCode; updateSizeList();
    }
    function adminParamRenameType() {
        const sel = document.getElementById('typeSelect'); const code = sel.value; if (!code) return;
        let currentLabel = ""; let optRef = null;
        typeDefs.forEach(g => { const opt = g.options.find(o => o.v === code); if (opt) { currentLabel = opt.t; optRef = opt; } });
        const newLabel = prompt("è«‹è¼¸å…¥æ–°çš„é¡¯ç¤ºåç¨±ï¼š", currentLabel);
        if (newLabel && newLabel !== currentLabel) { optRef.t = newLabel; renderTypeSelect(); sel.value = code; syncPickerButtons(); }
    }
    function adminParamDeleteType() {
        const sel = document.getElementById('typeSelect'); const code = sel.value; if (!code) return;
        if (!confirm(`ç¢ºå®šåˆªé™¤é¡å‹ ${code} å—ï¼Ÿ`)) return;
        typeDefs.forEach((g, gIdx) => { const idx = g.options.findIndex(o => o.v === code); if (idx !== -1) { g.options.splice(idx, 1); if (g.options.length === 0) typeDefs.splice(gIdx, 1); } });
        renderTypeSelect();
    }
    function runQuery() {
        const s = document.getElementById('sizeSelect').value, t = document.getElementById('typeSelect').value;
        if (!s || !toolData[s] || !toolData[s][t]) { document.getElementById('tableBody').innerHTML = ''; return; }
        const d = toolData[s][t];
        document.getElementById('tableBody').innerHTML = `<tr><td>${d[0]}</td><td>${d[1]}</td><td>${d[2]}</td><td>${d[3]}</td><td>${d[4]??'-'}</td></tr>`;
        syncPickerButtons();
    }

    // --- Tab 2 Logic ---
    function updateStackThickList() {
        const s = document.getElementById('stkSizeSel').value;
        if(!stackingRules[s]) return;
        const optsArray = stackingRules[s].options;
        const sel = document.getElementById('stkThickSel');
        sel.innerHTML = optsArray.map(item => `<option value="${item.r}">${item.r}</option>`).join('');
        runStackQuery();
        syncPickerButtons();
    }
    function runStackQuery() {
        const s = document.getElementById('stkSizeSel').value, r = document.getElementById('stkThickSel').value;
        if(!stackingRules[s]) return;
        document.getElementById('stkResMax').innerText = stackingRules[s].max;
        const matchedOption = stackingRules[s].options.find(item => item.r === r);
        const val = matchedOption ? matchedOption.v : '--';
        document.getElementById('stkResCount').innerText = val + " ç‰‡";
        syncPickerButtons();
    }

    // --- Tab 3 Logic ---
    function runFineQuery() {
        const i = document.getElementById('fineSizeSel').value, d = fineCutData[i], b = document.getElementById('fineBadge');
        if(!d) return;
        b.innerText = d.color; b.style.backgroundColor = getColorHex(d.color);
        document.getElementById('fineTableBody').innerHTML = `<tr><td><span class="val-mid">${d.s[0]}</span><span class="val-range">${d.s[1]}</span></td><td><span class="val-mid">${d.f[0]}</span><span class="val-range">${d.f[1]}</span></td><td><span class="val-mid">${d.t[0]}</span><span class="val-range">${d.t[1]}</span></td><td><span class="val-mid">${d.d[0]}</span><span class="val-range">${d.d[1]}</span></td></tr>`;
        syncPickerButtons();
    }

    // --- Tab 4 Logic ---
    function runFeedQuery() {
        const i = document.getElementById('feedSizeSel').value, d = feedData[i];
        if(!d) return;
        document.getElementById('feedTableBody').innerHTML = `<tr><td><span class="val-mid">${d.s[0]}</span><span class="val-range">${d.s[1]}</span></td><td style="background:#ebf8ff;"><span class="val-mid" style="color:#2b6cb0;">${d.pF[0]}</span><span class="val-range">${d.pF[1]}</span></td><td style="background:#f0fff4;"><span class="val-mid" style="color:#2f855a;">${d.sF[0]}</span><span class="val-range">${d.sF[1]}</span></td><td><span class="val-mid">${d.life}</span></td></tr>`;
        syncPickerButtons();
    }

    // --- Tab 5 Logic ---
    function updateLifeTypeList() {
        const s = document.getElementById('lifeSizeSel').value;
        const tSel = document.getElementById('lifeTypeSel');
        const types = Object.keys(toolLifeRules[s] || {});
        setSelectOptions(tSel, types);
        runLifeQuery();
        syncPickerButtons();
        if(isEditing) adminLifeRefreshPanel();
    }
    function runLifeQuery() {
        const s = document.getElementById('lifeSizeSel').value, t = document.getElementById('lifeTypeSel').value;
        if (!s || !t || !toolLifeRules[s] || !toolLifeRules[s][t]) {
             document.getElementById('lifeTableBody').innerHTML = '';
             return;
        }
        const d = toolLifeRules[s][t];
        syncPickerButtons();
        document.getElementById('lifeTableBody').innerHTML = `<tr>
            <td><span class="val-mid">${d[0][0]}</span><span class="val-range">${d[0][1]}</span></td>
            <td style="background:#fff7ed;"><span class="val-mid" style="color:#c2410c;">${d[1][0]}</span><span class="val-range">${d[1][1]}</span></td>
        </tr>`;
    }

    // --- Tab 6 & Context Notes Logic ---
    function renderNotes(){
        // Render Global Notes Tab
        const ul = document.querySelector('.note-list');
        ul.innerHTML = '';
        (notesData || []).forEach((note, idx) => {
            const li = document.createElement('li');
            li.innerHTML = `<b>${idx+1}.</b> ${note.text}`;
            ul.appendChild(li);
        });
    }

    function renderContextNotes(currentTabId) {
        // Render Notes specific to the current Tab
        const container = document.querySelector(`#${currentTabId} .context-note-area`);
        
        if (!container) return;

        // Filter notes that have this tabId in their tabs array
        const relevantNotes = notesData.filter(n => n.tabs && n.tabs.includes(currentTabId));

        if (relevantNotes.length === 0) {
            container.innerHTML = '';
            return;
        }

        let html = `<div class="context-notes-box">
            <div class="context-notes-header">âš ï¸ æ³¨æ„äº‹é …</div>
            <ul class="context-note-list">`;
        
        relevantNotes.forEach((n, idx) => {
            html += `<li><b>${idx + 1}.</b> ${n.text}</li>`;
        });
        
        html += `</ul></div>`;
        container.innerHTML = html;
    }

    // --- Admin Global ---
    function toggleAdmin() {
        if(!isEditing) {
            if(prompt("å¯†ç¢¼:") !== "YPD14-RT") return;
            isEditing = true;
            document.getElementById('btnAdmin').style.display = 'none';
            document.getElementById('btnExit').style.display = 'block';
            showAdminBar(true);
        } else {
            isEditing = false;
            document.getElementById('btnAdmin').style.display = 'block';
            document.getElementById('btnExit').style.display = 'none';
            showAdminBar(false);
            closeAdminModal();
        }
        document.body.classList.toggle('editing', isEditing);
        adminRefreshAll();
        // Refresh current tab to show context notes if changed
        const activeSection = document.querySelector('.content-section.active');
        if(activeSection) renderContextNotes(activeSection.id);
        renderNotes(); // Refresh note tab
        runQuery(); 
    }

    function showAdminBar(show){
        document.getElementById('adminBar').style.display = show ? 'flex' : 'none';
        document.querySelectorAll('.admin-panel').forEach(p => p.classList.toggle('active', show));
    }

    function adminRefreshAll() {
        if(!isEditing) return;
        adminParamRefresh();
        adminStackRefresh();
        adminFineRefresh();
        adminFeedRefresh();
        adminLifeRefreshPanel();
        adminNoteRefresh();
    }

    // [Admin Param, Stack, Fine, Feed, Life functions]
    function adminParamRefresh(){
        const type = document.getElementById('typeSelect').value;
        const tbody = document.getElementById('adminBody-query');
        tbody.innerHTML = '';
        const sizes = Object.keys(toolData).filter(k => toolData[k][type]);
        sizes.forEach(size => {
            const arr = toolData[size][type];
            const tr = document.createElement('tr');
            // draggable is handled by .drag-handle only
tr.dataset.key = size;
            tr.innerHTML = `<td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="${size}" oninput="adminParamRename(this, '${size}')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="${arr[0]}" oninput="adminParamSet('${size}','${type}',0,this.value)"></td>
                <td><input class="admin-input" value="${arr[1]}" oninput="adminParamSet('${size}','${type}',1,this.value)"></td>
                <td><input class="admin-input" value="${arr[2]}" oninput="adminParamSet('${size}','${type}',2,this.value)"></td>
                <td><input class="admin-input" value="${arr[3]}" oninput="adminParamSet('${size}','${type}',3,this.value)"></td>
                <td><input class="admin-input" value="${arr[4]||''}" oninput="adminParamSet('${size}','${type}',4,this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminParamDel('${size}','${type}')">åˆªé™¤</button></td>`;
            tbody.appendChild(tr);
        });
    }
    
    function adminParamRename(input, oldKey) {
        const newKey = input.value.trim(); if(!newKey || newKey === oldKey) return; if(toolData[newKey]) return;
        const sizeSel = document.getElementById('sizeSelect'); const selectedBefore = sizeSel ? sizeSel.value : '';
        const newToolData = {};
        Object.keys(toolData).forEach(k => { if (k === oldKey) newToolData[newKey] = toolData[oldKey]; else newToolData[k] = toolData[k]; });
        toolData = newToolData;
        input.setAttribute('oninput', `adminParamRename(this, '${newKey}')`);
        const btn = input.closest('tr').querySelector('.btn-danger'); const type = document.getElementById('typeSelect').value;
        btn.setAttribute('onclick', `adminParamDel('${newKey}','${type}')`); input.closest('tr').dataset.key = newKey;
        updateSizeList(); if(sizeSel && selectedBefore === oldKey) { sizeSel.value = newKey; runQuery(); }
    }
    function adminParamSet(s,t,idx,val){ toolData[s][t][idx] = val; } 
    function adminParamAddSize(){
        const s = prompt("è«‹è¼¸å…¥å°ºå¯¸ Key (ä¾‹å¦‚ 0.055):"); if(!s) return; const t = document.getElementById('typeSelect').value;
        if(!toolData[s]) toolData[s] = {}; if(toolData[s][t]) { alert('å·²å­˜åœ¨'); return; }
        toolData[s][t] = ["0","0","0","0","0"]; updateSizeList();
    }
    function adminParamDel(s,t){ if(!confirm(`ç¢ºå®šåˆªé™¤ ${s} çš„ ${t} æ•¸æ“šå—ï¼Ÿ`)) return; delete toolData[s][t]; updateSizeList(); }
    
    function adminStackRefresh(){
        const tbody = document.getElementById('adminBody-stack'); tbody.innerHTML = '';
        Object.keys(stackingRules).forEach(key => {
            const rule = stackingRules[key]; const optStr = rule.options.map(o => `${o.r}:${o.v}`).join(', ');
            const tr = document.createElement('tr');
            // draggable is handled by .drag-handle only
tr.dataset.key = key;
            tr.innerHTML = `<td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="${key}" oninput="adminStackRename(this, '${key}')" style="font-weight:bold;"></td>
                <td><input class="admin-input" value="${rule.max}" oninput="adminStackSetMax('${key}',this.value)"></td>
                <td><input class="admin-input" value="${optStr}" oninput="adminStackSetOpt('${key}',this.value)"></td>
                <td><button class="btn btn-danger" onclick="adminStackDel('${key}')">åˆªé™¤</button></td>`;
            tbody.appendChild(tr);
        });
    }

    function adminStackRename(input, oldKey){
        const newKey = input.value.trim(); if(!newKey || newKey === oldKey) return; if(stackingRules[newKey]) return;
        const newRules = {}; Object.keys(stackingRules).forEach(k => { if(k === oldKey) newRules[newKey] = stackingRules[oldKey]; else newRules[k] = stackingRules[k]; });
        stackingRules = newRules; input.setAttribute('oninput', `adminStackRename(this, '${newKey}')`);
        const btn = input.closest('tr').querySelector('.btn-danger'); btn.setAttribute('onclick', `adminStackDel('${newKey}')`); input.closest('tr').dataset.key = newKey;
    }
    function adminStackSetMax(k,v){ stackingRules[k].max = v; } 
    function adminStackSetOpt(k,v){ 
        const newOptsArray = []; v.split(',').forEach(pair => { let [rng, val] = pair.split(':'); if(rng && val) { newOptsArray.push({ r: rng.trim(), v: isNaN(Number(val.trim())) ? val.trim() : Number(val.trim()) }); } });
        stackingRules[k].options = newOptsArray; updateStackThickList(); 
    }
    function adminStackAdd(){ const k = prompt("è«‹è¼¸å…¥è¦å‰‡åç¨±"); if(!k || stackingRules[k]) return; stackingRules[k] = { max: "0", options: [{r:"1~10", v:1}] }; adminStackRefresh(); document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join(''); }
    function adminStackDel(k){ if(!confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) return; delete stackingRules[k]; adminStackRefresh(); document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join(''); }

    function adminFineRefresh(){
        const tbody = document.getElementById('adminBody-fine'); tbody.innerHTML = '';
        fineCutData.forEach((d, idx) => {
            const tr = document.createElement('tr');
            // draggable is handled by .drag-handle only
tr.dataset.idx = idx;
            const cell = (field, sub, w) => `<input class="admin-input" style="width:${w||'60px'}" value="${escAttr(d[field][sub])}" oninput="adminFineSet(${idx},'${field}',${sub},this.value)">`;
            tr.innerHTML = `<td class="drag-handle" draggable="true">â˜°</td>
                <td><input class="admin-input" value="${escAttr(d.label)}" oninput="adminFineSetLabel(${idx},this.value)" style="width:120px;"></td>
                <td style="white-space:nowrap;"><input id="fineColorName-${idx}" class="admin-input" value="${escAttr(d.color)}" oninput="adminFineSetColor(${idx},this.value)" style="width:80px;"><input id="fineColorHex-${idx}" type="color" value="${getColorHex(d.color)}" onchange="adminFineSetColorHex(${idx},this.value)" style="width:44px; height:32px; border:none; vertical-align:middle; margin-left:6px;"></td>
                <td>${cell('s',0)} / ${cell('s',1)}</td><td>${cell('f',0)} / ${cell('f',1)}</td><td>${cell('t',0)} / ${cell('t',1)}</td><td>${cell('d',0)} / ${cell('d',1)}</td>
                <td><button class="btn btn-danger" onclick="adminFineDel(${idx})">åˆª</button></td>`;
            tbody.appendChild(tr);
        });
    }

    function adminFineSet(i,f,s,v){ fineCutData[i][f][s] = v; }
    function adminFineSetLabel(i,v){ fineCutData[i].label = v; updateFineSel(); }
    function adminFineSetColor(i,v){ fineCutData[i].color = v; try{ document.getElementById(`fineColorHex-${i}`).value = getColorHex(v); }catch(e){} try{ updateFineSel(); }catch(e){} }
    function adminFineSetColorHex(i,hex){ const name = fineCutData[i].color||''; setColorOverride(name, hex); }
    function updateFineSel(){ const sel = document.getElementById('fineSizeSel'); const currentVal = sel.value; sel.innerHTML = fineCutData.map((d, i) => `<option value="${i}">${d.label}</option>`).join(''); if(currentVal && fineCutData[currentVal]) sel.value = currentVal; syncPickerButtons(); }
    function adminFineAdd(){ fineCutData.push({ label: "æ–°è¦å‰‡", s:["0","0"], f:["0","0"], t:["0","0"], d:["0","0"], color:"ç™½è‰²" }); updateFineSel(); adminFineRefresh(); }
    function adminFineDel(i){ if(!confirm('åˆªé™¤ï¼Ÿ')) return; fineCutData.splice(i,1); updateFineSel(); adminFineRefresh(); }

    function adminFeedRefresh(){
        const tbody = document.getElementById('adminBody-feed'); tbody.innerHTML = '';
        feedData.forEach((d, idx) => {
            const cell = (field, sub) => `<input class="admin-input" style="width:50px" value="${escAttr(d[field][sub])}" oninput="adminFeedSet(${idx},'${field}',${sub},this.value)">`;
            const tr = document.createElement('tr');
            // draggable is handled by .drag-handle only
tr.dataset.idx = idx;
            tr.innerHTML = `<td class="drag-handle" draggable="true">â˜°</td><td><input class="admin-input" value="${escAttr(d.label)}" oninput="adminFeedSetLabel(${idx},this.value)" style="width:120px;"></td>
                <td>${cell('s',0)} / ${cell('s',1)}</td><td>${cell('pF',0)} / ${cell('pF',1)}</td><td>${cell('sF',0)} / ${cell('sF',1)}</td>
                <td><input class="admin-input" value="${escAttr(d.life)}" oninput="adminFeedSetLife(${idx},this.value)" style="width:50px;"></td>
                <td><button class="btn btn-danger" onclick="adminFeedDel(${idx})">åˆª</button></td>`;
            tbody.appendChild(tr);
        });
    }

    function adminFeedSet(i,f,s,v){ feedData[i][f][s] = v; }
    function adminFeedSetLabel(i,v){ feedData[i].label = v; updateFeedSel(); }
    function adminFeedSetLife(i,v){ feedData[i].life = v; }
    function updateFeedSel(){ const sel = document.getElementById('feedSizeSel'); const currentVal = sel.value; sel.innerHTML = feedData.map((d, i) => `<option value="${i}">${d.label}</option>`).join(''); if(currentVal && feedData[currentVal]) sel.value = currentVal; syncPickerButtons(); }
    function adminFeedAdd(){ feedData.push({ label: "æ–°ç¯„åœ", s:["0","0"], pF:["0","0"], sF:["0","0"], life: "1500" }); updateFeedSel(); adminFeedRefresh(); }
    function adminFeedDel(i){ if(!confirm('åˆªé™¤ï¼Ÿ')) return; feedData.splice(i,1); updateFeedSel(); adminFeedRefresh(); }

    function adminLifeRefreshPanel(){
        const tbody = document.getElementById('adminBody-life'); if(!tbody) return;
        const sizeKey = document.getElementById('lifeSizeSel').value;
        if(!sizeKey || !toolLifeRules[sizeKey]) { tbody.innerHTML = '<tr><td colspan="7">è«‹é¸æ“‡ç›´å¾‘</td></tr>'; return; }
        tbody.innerHTML = '';
        Object.keys(toolLifeRules[sizeKey]).forEach(typeKey => {
            const d = toolLifeRules[sizeKey][typeKey]; const tr = document.createElement('tr');
            // draggable is handled by .drag-handle only
tr.dataset.key = typeKey;
            const tdDrag = document.createElement('td'); tdDrag.className = 'drag-handle'; tdDrag.setAttribute('draggable','true'); tdDrag.textContent = 'â˜°';
            const tdType = document.createElement('td'); tdType.style.fontWeight = 'bold'; tdType.textContent = typeKey;
            function mkInput(val, side, idx){ const td = document.createElement('td'); const inp = document.createElement('input'); inp.className = 'admin-input'; inp.value = val ?? ''; inp.addEventListener('input', () => adminLifeSet(sizeKey, typeKey, side, idx, inp.value)); td.appendChild(inp); return td; }
            const tdDel = document.createElement('td'); const btn = document.createElement('button'); btn.className = 'btn btn-danger'; btn.textContent = 'åˆªé™¤'; btn.addEventListener('click', () => adminLifeDeleteType(sizeKey, typeKey)); tdDel.appendChild(btn);
            tr.appendChild(tdDrag); tr.appendChild(tdType); tr.appendChild(mkInput(d?.[0]?.[0], 0, 0)); tr.appendChild(mkInput(d?.[0]?.[1], 0, 1)); tr.appendChild(mkInput(d?.[1]?.[0], 1, 0)); tr.appendChild(mkInput(d?.[1]?.[1], 1, 1)); tr.appendChild(tdDel);
            tbody.appendChild(tr);
        });
    }

    function adminLifeSet(s,t,side,idx,v){ if(!toolLifeRules[s] || !toolLifeRules[s][t]) return; toolLifeRules[s][t][side][idx] = v; if(document.getElementById('lifeSizeSel')?.value === s){ runLifeQuery(); syncPickerButtons(); } }
    function adminLifeAddSize(){ const s = prompt('è¼¸å…¥æ–°ç›´å¾‘'); if(!s || toolLifeRules[s]) return; toolLifeRules[s] = {}; setSelectOptions(document.getElementById('lifeSizeSel'), Object.keys(toolLifeRules)); document.getElementById('lifeSizeSel').value = s; updateLifeTypeList(); }
    function adminLifeDeleteSize(){ const s = document.getElementById('lifeSizeSel').value; if(!confirm('åˆªé™¤ '+s+' ?')) return; delete toolLifeRules[s]; setSelectOptions(document.getElementById('lifeSizeSel'), Object.keys(toolLifeRules)); updateLifeTypeList(); }
    function adminLifeAddType(){ const s = document.getElementById('lifeSizeSel').value; const t = prompt('è¼¸å…¥å‹æ…‹'); if(!t) return; toolLifeRules[s][t] = [["0","0"],["0","0"]]; adminLifeRefreshPanel(); updateLifeTypeList(); }
    function adminLifeDeleteType(s,t){ if(!confirm('åˆªé™¤ '+t+' ?')) return; delete toolLifeRules[s][t]; adminLifeRefreshPanel(); updateLifeTypeList(); }
    function adminLifeRenameSize() { const sel = document.getElementById('lifeSizeSel'); const oldName = sel.value; if (!oldName) return; const newName = prompt("è«‹è¼¸å…¥æ–°çš„ç›´å¾‘åç¨±ï¼š", oldName); if (newName && newName !== oldName) { if (toolLifeRules[newName]) { alert("æ­¤ç›´å¾‘åç¨±å·²å­˜åœ¨ï¼"); return; } const newRules = {}; Object.keys(toolLifeRules).forEach(k => { if (k === oldName) newRules[newName] = toolLifeRules[oldName]; else newRules[k] = toolLifeRules[k]; }); toolLifeRules = newRules; setSelectOptions(sel, Object.keys(toolLifeRules)); sel.value = newName; updateLifeTypeList(); syncPickerButtons(); } }
    function adminLifeOpenReorder() { const tbody = document.getElementById('reorderTbody'); tbody.innerHTML = ''; Object.keys(toolLifeRules).forEach(k => { const tr = document.createElement('tr');
        // draggable is handled by .drag-handle only
tr.dataset.key = k; tr.innerHTML = `<td class="drag-handle" draggable="true">â˜°</td><td style="font-weight:bold; text-align:left;">${k}</td>`; tbody.appendChild(tr); }); document.getElementById('reorderModal').style.display = 'flex'; }
    function adminLifeSaveOrder() { const rows = document.querySelectorAll('#reorderTbody tr'); const newRules = {}; rows.forEach(r => { const k = r.dataset.key; if(toolLifeRules[k]) newRules[k] = toolLifeRules[k]; }); Object.keys(toolLifeRules).forEach(k => { if(!newRules[k]) newRules[k] = toolLifeRules[k]; }); toolLifeRules = newRules; const sel = document.getElementById('lifeSizeSel'); const currentVal = sel.value; setSelectOptions(sel, Object.keys(toolLifeRules)); if(newRules[currentVal]) sel.value = currentVal; else if(Object.keys(newRules).length > 0) sel.value = Object.keys(newRules)[0]; updateLifeTypeList(); document.getElementById('reorderModal').style.display = 'none'; alert('ç›´å¾‘é †åºå·²æ›´æ–°ï¼'); }


    // --- Admin: Tab 6 (Note) - ä¿®æ­£ç‰ˆ ---
    function adminNoteRefresh(){
        const tbody = document.getElementById('adminBody-note');
        tbody.innerHTML = '';
        notesData.forEach((note, idx) => {
            const tr = document.createElement('tr');
            // draggable is handled by .drag-handle only
tr.dataset.idx = idx;

            // ç”¢ç”Ÿæ¨™ç±¤ HTML
            let checkboxes = '';
            // çŸ­åç¨±æ˜ å°„ï¼Œè®“æ¨™ç±¤æ›´çŸ­æ›´æ•´é½Š
            const shortNames = {
                'tab-query': 'åƒæ•¸', 'tab-stack': 'ç–Šæ¿', 'tab-fine': 'ç´°åˆ‡', 
                'tab-feed': 'é‘½å­”', 'tab-life': 'å£½å‘½'
            };

            for (const [tid, tLabel] of Object.entries(_tabMap)) {
                const checked = (note.tabs && note.tabs.includes(tid)) ? 'checked' : '';
                const labelName = shortNames[tid] || tLabel; // ä½¿ç”¨çŸ­åç¨±
                checkboxes += `
                    <div style="position:relative;">
                        <input type="checkbox" id="nchk-${idx}-${tid}" class="tab-chk" value="${tid}" ${checked} onchange="adminNoteSetTab(${idx}, '${tid}', this.checked)">
                        <label for="nchk-${idx}-${tid}" class="tab-chk-label">${labelName}</label>
                    </div>
                `;
            }

            tr.innerHTML = `
                <td class="drag-handle" draggable="true" style="vertical-align:middle;">â˜°</td>
                <td style="vertical-align:middle; text-align:center; font-weight:bold; color:#64748b;">${idx+1}</td>
                <td>
                    <textarea class="admin-textarea" oninput="adminNoteSetText(${idx},this.value)" placeholder="è«‹è¼¸å…¥å‚™è¨»å…§å®¹..." style="width:100%; margin-bottom:0;">${note.text}</textarea>
                    <div style="display:flex; align-items:center; gap:8px; margin-top:6px;">
                        <span style="font-size:11px; color:#94a3b8; white-space:nowrap;">é¡¯ç¤ºæ–¼:</span>
                        <div class="tab-selector-group">
                            ${checkboxes}
                        </div>
                    </div>
                </td>
                <td style="vertical-align:middle;">
                    <button class="btn btn-danger" onclick="adminNoteDel(${idx})" style="padding:6px 10px;">åˆªé™¤</button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }
    
    function adminNoteSetText(i,v){ 
        if(!notesData[i]) return;
        notesData[i].text = v; 
    }
    
    function adminNoteSetTab(i, tabId, isChecked){
        if(!notesData[i]) return;
        if(!notesData[i].tabs) notesData[i].tabs = [];
        if(isChecked) {
            if(!notesData[i].tabs.includes(tabId)) notesData[i].tabs.push(tabId);
        } else {
            notesData[i].tabs = notesData[i].tabs.filter(t => t !== tabId);
        }
    }

    function adminNoteAdd(){ 
        notesData.push({text: "æ–°å‚™è¨»äº‹é …...", tabs: []}); 
        adminNoteRefresh(); 
        renderNotes(); 
    }
    function adminNoteDel(i){ 
        if(!confirm('ç¢ºå®šåˆªé™¤æ­¤å‚™è¨»ï¼Ÿ')) return;
        notesData.splice(i,1); 
        adminNoteRefresh(); 
        renderNotes(); 
        const activeId = document.querySelector('.content-section.active')?.id;
        if(activeId) renderContextNotes(activeId);
    }


    // --- Persistence & Utils ---
    const STORAGE_KEY = 'rt_param_bundle_v13_smart_notes_drag_final_fix3'; 
    const STORAGE_VERDATE_KEY = 'rt_param_version_date_v13';

    function _formatVerYMD(vd){ return (vd||'').toString().trim().replace(/-/g,''); }
    function syncVersionTag(vd){ const ymd = _formatVerYMD(vd); const tag = document.querySelector('.version-tag'); if(tag && ymd) tag.textContent = 'ç‰ˆæœ¬æ—¥æœŸ: ' + ymd; }

    function getBundle(){ return { toolData, stackingRules, fineCutData, feedData, toolLifeRules, notesData, typeDefs, colorOverrides }; }
    function setBundle(b){
        if(!b) return;
        if(b.toolData) toolData = b.toolData;
        if(b.stackingRules) stackingRules = b.stackingRules;
        if(b.fineCutData) fineCutData = b.fineCutData;
        if(b.feedData) feedData = b.feedData;
        if(b.toolLifeRules) toolLifeRules = b.toolLifeRules;
        if(b.typeDefs) typeDefs = b.typeDefs;
        if(b.colorOverrides) colorOverrides = b.colorOverrides;
        // Migration: ensure object array
        if(b.notesData) {
            if(b.notesData.length > 0 && typeof b.notesData[0] === 'string') {
                notesData = b.notesData.map(t => ({text: t, tabs: ['tab-query']})); 
            } else {
                notesData = b.notesData;
            }
        }
    }
    function loadFromStorage(){
        try{
            const raw = localStorage.getItem(STORAGE_KEY);
            if(raw) setBundle(JSON.parse(raw));
            const vd = localStorage.getItem(STORAGE_VERDATE_KEY);
            if(vd) document.getElementById('verDate').value = vd;
            if(vd) syncVersionTag(vd);
        }catch(e){ console.warn(e); }
    }
    function saveAllChanges(){
        const vd = document.getElementById('verDate').value;
        if(!vd) { alert('è«‹å¡«å¯«æ›´æ–°ç‰ˆæœ¬æ—¥æœŸ'); return; }
        localStorage.setItem(STORAGE_KEY, JSON.stringify(getBundle()));
        localStorage.setItem(STORAGE_VERDATE_KEY, vd);
        syncVersionTag(vd);
        alert('å·²æš«å­˜åˆ°æœ¬æ©Ÿï¼');
    }
    function openAdvancedEditor(){ document.getElementById('adminJson').value = JSON.stringify(getBundle(), null, 2); document.getElementById('adminModalBackdrop').style.display = 'flex'; }
    function closeAdminModal(){ document.getElementById('adminModalBackdrop').style.display = 'none'; }
    function applyJsonChanges(){
        try{
            setBundle(JSON.parse(document.getElementById('adminJson').value));
            renderTypeSelect(); document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join(''); updateStackThickList();
            updateFineSel(); runFineQuery(); updateFeedSel(); runFeedQuery(); setSelectOptions(document.getElementById('lifeSizeSel'), Object.keys(toolLifeRules)); updateLifeTypeList();
            renderNotes(); adminRefreshAll(); syncPickerButtons(); closeAdminModal(); alert('è®Šæ›´å·²å¥—ç”¨ (è«‹è¨˜å¾—ä¿å­˜)');
        }catch(e){ alert('JSON éŒ¯èª¤: '+e.message); }
    }

    function downloadUpdatedHtml() {
        const vd = document.getElementById('verDate')?.value || localStorage.getItem(STORAGE_VERDATE_KEY) || '';
        const ymd = _formatVerYMD(vd) || '20260121';
        const docEl = document.documentElement.cloneNode(true);
        const body = docEl.querySelector('body'); if (body) body.classList.remove('editing');
        docEl.querySelectorAll('.admin-panel').forEach(p => { p.classList.remove('active'); if (p.hasAttribute('style')) p.removeAttribute('style'); });
        const adminBar = docEl.querySelector('#adminBar'); if (adminBar && adminBar.hasAttribute('style')) adminBar.removeAttribute('style');
        const btnAdmin = docEl.querySelector('#btnAdmin'); if (btnAdmin) btnAdmin.style.display = 'block'; 
        const btnExit = docEl.querySelector('#btnExit'); if (btnExit) btnExit.style.display = 'none';
        const tag = docEl.querySelector('.version-tag'); if (tag) tag.textContent = 'ç‰ˆæœ¬æ—¥æœŸ: ' + ymd;
        let html = "<!DOCTYPE html>\n" + docEl.outerHTML;
        html = html.replace(/let toolData = \{[\s\S]*?\};/, `let toolData = ${JSON.stringify(toolData)};`);
        html = html.replace(/let typeDefs = \[[\s\S]*?\];/, `let typeDefs = ${JSON.stringify(typeDefs)};`);
        html = html.replace(/let stackingRules = \{[\s\S]*?\};/, `let stackingRules = ${JSON.stringify(stackingRules)};`);
        html = html.replace(/let fineCutData = \[[\s\S]*?\];/, `let fineCutData = ${JSON.stringify(fineCutData)};`);
        html = html.replace(/let feedData = \[[\s\S]*?\];/, `let feedData = ${JSON.stringify(feedData)};`);
        html = html.replace(/let toolLifeRules = \{[\s\S]*?\};/, `let toolLifeRules = (function(){ return ${JSON.stringify(toolLifeRules)}; })();`);
        html = html.replace(/let notesData = \[[\s\S]*?\];/, `let notesData = ${JSON.stringify(notesData)};`);
        html = html.replace(/let colorOverrides = \{[\s\S]*?\};/, `let colorOverrides = ${JSON.stringify(colorOverrides)};`);
        html = html.replace(/(<div class="version-tag">ç‰ˆæœ¬æ—¥æœŸ:\s*)\d{8}(\s*<\/div>)/, `$1${ymd}$2`);
        const blob = new Blob([html], { type: 'text/html' }); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `RT_Param_Table_v${vd ? vd : new Date().toISOString().split('T')[0]}.html`; a.click();
    }

    let _pickerSelectId = null;
    function syncPickerButtons() {
        const ids = ['typeSelect', 'sizeSelect', 'fineSizeSel', 'feedSizeSel', 'lifeSizeSel', 'lifeTypeSel', 'stkSizeSel', 'stkThickSel'];
        ids.forEach(id => {
            const sel = document.getElementById(id); if (!sel) return;
            let btn = document.getElementById(id + 'Btn');
            if (!btn && id === 'lifeSizeSel') btn = document.getElementById('lifeSizeBtn');
            if (!btn && id === 'lifeTypeSel') btn = document.getElementById('lifeTypeBtn');
            if (!btn) return;
            const text = sel.options && sel.selectedIndex >= 0 ? (sel.options[sel.selectedIndex]?.textContent || '') : '';
            btn.textContent = text || 'è«‹é¸æ“‡';
        });
    }
    
    function openPicker(sid, title) {
        if (!window.matchMedia('(max-width: 900px)').matches) return;
        const sel = document.getElementById(sid); _pickerSelectId = sid; document.getElementById('pickerTitle').textContent = title;
        const list = document.getElementById('pickerList'); list.innerHTML = '';
        [...sel.options].forEach(opt => {
            if (opt.tagName === 'OPTGROUP') return;
            const item = document.createElement('div'); item.className = 'picker-item' + (opt.value === sel.value ? ' active' : '');
            item.textContent = opt.textContent;
            item.onclick = () => { sel.value = opt.value; sel.dispatchEvent(new Event('change')); closePicker(); };
            list.appendChild(item);
        }); document.getElementById('pickerModal').classList.remove('hidden');
    }
    function closePicker() { document.getElementById('pickerModal').classList.add('hidden'); _pickerSelectId = null; syncPickerButtons(); }

    window.onload = () => {
        loadFromStorage();
        const _vdInput = document.getElementById('verDate'); if(_vdInput) _vdInput.addEventListener('input', e=>syncVersionTag(e.target.value));
        renderTypeSelect();
        document.getElementById('stkSizeSel').innerHTML = Object.keys(stackingRules).map(s => `<option value="${s}">${s}</option>`).join(''); updateStackThickList();
        updateFineSel(); runFineQuery();
        updateFeedSel(); runFeedQuery();
        setSelectOptions(document.getElementById('lifeSizeSel'), Object.keys(toolLifeRules)); updateLifeTypeList();
        
        // Initial Render Context Notes for the default active tab (tab-query)
        renderNotes();
        renderContextNotes('tab-query');

        syncPickerButtons();
    };

    document.addEventListener('click', (e) => {
        const sidebar = document.getElementById('sidebar');
        if (!window.matchMedia('(max-width: 900px)').matches) return;
        if (document.getElementById('pickerModal').classList.contains('hidden') === false) return;
        if (e.target.closest('select, input, button, .picker-btn')) return;
        if (!sidebar.contains(e.target) && !e.target.closest('.hamburger-btn')) sidebar.classList.add('collapsed');
    });

</script>


</body></html>